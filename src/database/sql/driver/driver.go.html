<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Source: driver.go in package database/sql/driver</title>
<link href="../../../../css/lightLiterate-v0.3.2-preview.css" rel="stylesheet">
<script src="../../../../jvs/golds-v0.3.2-preview.js"></script>
<body onload="onPageLoad()"><div>

<pre id="header"><code><span class="title">Source File</span>
	driver.go

<span class="title">Belonging Package</span>
	<a href="../../../../pkg/database/sql/driver.html">database/sql/driver</a>
</code></pre>
<style>input[type=radio] {display: none;}
input[id=r0]:checked ~pre label[for=r0],
input[id=r1]:checked ~pre label[for=r1],
input[id=r2]:checked ~pre label[for=r2],
input[id=r3]:checked ~pre label[for=r3],
input[id=r4]:checked ~pre label[for=r4]
{background: #226; color: #ff8;}
input[id=i0]:checked ~pre .i0,
input[id=i1]:checked ~pre .i1,
input[id=i2]:checked ~pre .i2
{background: brown; color: #eed;}
</style><input id="r0" type="radio" name="g"/>
<input id="r1" type="radio" name="g"/>
<input id="r2" type="radio" name="g"/>
<input id="r3" type="radio" name="g"/>
<input id="r4" type="radio" name="g"/>
<input id="i0" type="radio" name="i"/>
<input id="i1" type="radio" name="i"/>
<input id="i2" type="radio" name="i"/>
<div id="container"><div class="section">
<div class="doc">
<span class="comment"> Copyright 2011 The Go Authors. All rights reserved.</span><span class="comment"> Use of this source code is governed by a BSD-style</span><span class="comment"> license that can be found in the LICENSE file.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Package driver defines interfaces to be implemented by database</span><span class="comment"> drivers as used by package sql.</span><span class="comment"></span><span class="comment"> Most code should use package sql.</span><span class="comment"></span><span class="comment"> The driver interface has evolved over time. Drivers should implement</span><span class="comment"> Connector and DriverContext interfaces.</span><span class="comment"> The Connector.Connect and Driver.Open methods should never return ErrBadConn.</span><span class="comment"> ErrBadConn should only be returned from Validator, SessionResetter, or</span><span class="comment"> a query method if the connection is already in an invalid (e.g. closed) state.</span><span class="comment"></span><span class="comment"> All Conn implementations should implement the following interfaces:</span><span class="comment"> Pinger, SessionResetter, and Validator.</span><span class="comment"></span><span class="comment"> If named parameters or context are supported, the driver's Conn should implement:</span><span class="comment"> ExecerContext, QueryerContext, ConnPrepareContext, and ConnBeginTx.</span><span class="comment"></span><span class="comment"> To support custom data types, implement NamedValueChecker. NamedValueChecker</span><span class="comment"> also allows queries to accept per-query options as a parameter by returning</span><span class="comment"> ErrRemoveArgument from CheckNamedValue.</span><span class="comment"></span><span class="comment"> If multiple result sets are supported, Rows should implement RowsNextResultSet.</span><span class="comment"> If the driver knows how to describe the types present in the returned result</span><span class="comment"> it should implement the following interfaces: RowsColumnTypeScanType,</span><span class="comment"> RowsColumnTypeDatabaseTypeName, RowsColumnTypeLength, RowsColumnTypeNullable,</span><span class="comment"> and RowsColumnTypePrecisionScale. A given row value may also return a Rows</span><span class="comment"> type, which may represent a database cursor value.</span><span class="comment"></span><span class="comment"> Before a connection is returned to the connection pool after use, IsValid is</span><span class="comment"> called if implemented. Before a connection is reused for another query,</span><span class="comment"> ResetSession is called if implemented. If a connection is never returned to the</span><span class="comment"> connection pool but immediately reused, then ResetSession is called prior to</span><span class="comment"> reuse but IsValid is not called.</span></div>
<div class="code"><pre><code><span class="keyword">package</span> driver

<span class="keyword">import</span> (
	<label for="i0"><span class="lit-string i0">"context"</span></label>
	<label for="i1"><span class="lit-string i1">"errors"</span></label>
	<label for="i2"><span class="lit-string i2">"reflect"</span></label>
)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Value is a value that drivers must be able to handle.</span><span class="comment"> It is either nil, a type handled by a database driver's NamedValueChecker</span><span class="comment"> interface, or an instance of one of these types:</span><span class="comment"></span><span class="comment">   int64</span><span class="comment">   float64</span><span class="comment">   bool</span><span class="comment">   []byte</span><span class="comment">   string</span><span class="comment">   time.Time</span><span class="comment"></span><span class="comment"> If the driver supports cursors, a returned Value may also implement the Rows interface</span><span class="comment"> in this package. This is used, for example, when a user selects a cursor</span><span class="comment"> such as "select cursor(select * from my_table) from dual". If the Rows</span><span class="comment"> from the select is closed, the cursor Rows will also be closed.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../pkg/database/sql/driver.html#name-Value" class="ident">Value</a> <span class="keyword">interface</span>{}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> NamedValue holds both the value name and value.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> If the Name is not empty it should be used for the parameter identifier and</span><span class="comment">	 not the ordinal position.</span><span class="comment">	</span><span class="comment">	 Name will not have a symbol prefix.</span></div>
<div class="code"><pre><code>	<a href="../../../../use/database/sql/driver..NamedValue.Name.html" class="ident">Name</a> <a href="../../../../pkg/builtin.html#name-string" class="ident">string</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Ordinal position of the parameter starting from one and is always set.</span></div>
<div class="code"><pre><code>	<a href="../../../../use/database/sql/driver..NamedValue.Ordinal.html" class="ident">Ordinal</a> <a href="../../../../pkg/builtin.html#name-int" class="ident">int</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Value is the parameter value.</span></div>
<div class="code"><pre><code>	<a href="../../../../use/database/sql/driver..NamedValue.Value.html" class="ident">Value</a> <a href="#line-61" class="ident">Value</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Driver is the interface that must be implemented by a database</span><span class="comment"> driver.</span><span class="comment"></span><span class="comment"> Database drivers may implement DriverContext for access</span><span class="comment"> to contexts and to parse the name only once for a pool of connections,</span><span class="comment"> instead of once per connection.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Open returns a new connection to the database.</span><span class="comment">	 The name is a string in a driver-specific format.</span><span class="comment">	</span><span class="comment">	 Open may return a cached connection (one previously</span><span class="comment">	 closed), but doing so is unnecessary; the sql package</span><span class="comment">	 maintains a pool of idle connections for efficient re-use.</span><span class="comment">	</span><span class="comment">	 The returned connection is only used by one goroutine at a</span><span class="comment">	 time.</span></div>
<div class="code"><pre><code>	Open(name <a href="../../../../pkg/builtin.html#name-string" class="ident">string</a>) (<a href="#line-227" class="ident">Conn</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> If a Driver implements DriverContext, then sql.DB will call</span><span class="comment"> OpenConnector to obtain a Connector and then invoke</span><span class="comment"> that Connector's Connect method to obtain each needed connection,</span><span class="comment"> instead of invoking the Driver's Open method for each connection.</span><span class="comment"> The two-step sequence allows drivers to parse the name just once</span><span class="comment"> and also provides access to per-Conn contexts.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> OpenConnector must parse the name in the same format that Driver.Open</span><span class="comment">	 parses the name parameter.</span></div>
<div class="code"><pre><code>	OpenConnector(name <a href="../../../../pkg/builtin.html#name-string" class="ident">string</a>) (<a href="#line-118" class="ident">Connector</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> A Connector represents a driver in a fixed configuration</span><span class="comment"> and can create any number of equivalent Conns for use</span><span class="comment"> by multiple goroutines.</span><span class="comment"></span><span class="comment"> A Connector can be passed to sql.OpenDB, to allow drivers</span><span class="comment"> to implement their own sql.DB constructors, or returned by</span><span class="comment"> DriverContext's OpenConnector method, to allow drivers</span><span class="comment"> access to context and to avoid repeated parsing of driver</span><span class="comment"> configuration.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Connect returns a connection to the database.</span><span class="comment">	 Connect may return a cached connection (one previously</span><span class="comment">	 closed), but doing so is unnecessary; the sql package</span><span class="comment">	 maintains a pool of idle connections for efficient re-use.</span><span class="comment">	</span><span class="comment">	 The provided context.Context is for dialing purposes only</span><span class="comment">	 (see net.DialContext) and should not be stored or used for</span><span class="comment">	 other purposes. A default timeout should still be used</span><span class="comment">	 when dialing as a connection pool may call Connect</span><span class="comment">	 asynchronously to any query.</span><span class="comment">	</span><span class="comment">	 The returned connection is only used by one goroutine at a</span><span class="comment">	 time.</span></div>
<div class="code"><pre><code>	Connect(<a href="../../../../pkg/context.html" class="ident i0">context</a>.<a href="../../../context/context.go.html#line-62" class="ident">Context</a>) (<a href="#line-227" class="ident">Conn</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Driver returns the underlying Driver of the Connector,</span><span class="comment">	 mainly to maintain compatibility with the Driver method</span><span class="comment">	 on sql.DB.</span></div>
<div class="code"><pre><code>	Driver() <a href="#line-84" class="ident">Driver</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ErrSkip may be returned by some optional interfaces' methods to</span><span class="comment"> indicate at runtime that the fast path is unavailable and the sql</span><span class="comment"> package should continue as if the optional interface was not</span><span class="comment"> implemented. ErrSkip is only supported where explicitly</span><span class="comment"> documented.</span></div>
<div class="code"><pre><code><span class="keyword">var</span> <a href="../../../../pkg/database/sql/driver.html#name-ErrSkip" class="ident">ErrSkip</a> = <a href="../../../../pkg/errors.html" class="ident i1">errors</a>.<a href="../../../errors/errors.go.html#line-58" class="ident">New</a>(<span class="lit-string">"driver: skip fast-path; continue as if unimplemented"</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ErrBadConn should be returned by a driver to signal to the sql</span><span class="comment"> package that a driver.Conn is in a bad state (such as the server</span><span class="comment"> having earlier closed the connection) and the sql package should</span><span class="comment"> retry on a new connection.</span><span class="comment"></span><span class="comment"> To prevent duplicate operations, ErrBadConn should NOT be returned</span><span class="comment"> if there's a possibility that the database server might have</span><span class="comment"> performed the operation. Even if the server sends back an error,</span><span class="comment"> you shouldn't return ErrBadConn.</span></div>
<div class="code"><pre><code><span class="keyword">var</span> <a href="../../../../pkg/database/sql/driver.html#name-ErrBadConn" class="ident">ErrBadConn</a> = <a href="../../../../pkg/errors.html" class="ident i1">errors</a>.<a href="../../../errors/errors.go.html#line-58" class="ident">New</a>(<span class="lit-string">"driver: bad connection"</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Pinger is an optional interface that may be implemented by a Conn.</span><span class="comment"></span><span class="comment"> If a Conn does not implement Pinger, the sql package's DB.Ping and</span><span class="comment"> DB.PingContext will check if there is at least one Conn available.</span><span class="comment"></span><span class="comment"> If Conn.Ping returns ErrBadConn, DB.Ping and DB.PingContext will remove</span><span class="comment"> the Conn from pool.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../pkg/database/sql/driver.html#name-Pinger" class="ident">Pinger</a> <span class="keyword">interface</span> {
	Ping(ctx <a href="../../../../pkg/context.html" class="ident i0">context</a>.<a href="../../../context/context.go.html#line-62" class="ident">Context</a>) <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Execer is an optional interface that may be implemented by a Conn.</span><span class="comment"></span><span class="comment"> If a Conn implements neither ExecerContext nor Execer,</span><span class="comment"> the sql package's DB.Exec will first prepare a query, execute the statement,</span><span class="comment"> and then close the statement.</span><span class="comment"></span><span class="comment"> Exec may return ErrSkip.</span><span class="comment"></span><span class="comment"> Deprecated: Drivers should implement ExecerContext instead.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../pkg/database/sql/driver.html#name-Execer" class="ident">Execer</a> <span class="keyword">interface</span> {
	Exec(query <a href="../../../../pkg/builtin.html#name-string" class="ident">string</a>, args []<a href="#line-61" class="ident">Value</a>) (<a href="#line-310" class="ident">Result</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ExecerContext is an optional interface that may be implemented by a Conn.</span><span class="comment"></span><span class="comment"> If a Conn does not implement ExecerContext, the sql package's DB.Exec</span><span class="comment"> will fall back to Execer; if the Conn does not implement Execer either,</span><span class="comment"> DB.Exec will first prepare a query, execute the statement, and then</span><span class="comment"> close the statement.</span><span class="comment"></span><span class="comment"> ExecerContext may return ErrSkip.</span><span class="comment"></span><span class="comment"> ExecerContext must honor the context timeout and return when the context is canceled.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../pkg/database/sql/driver.html#name-ExecerContext" class="ident">ExecerContext</a> <span class="keyword">interface</span> {
	ExecContext(ctx <a href="../../../../pkg/context.html" class="ident i0">context</a>.<a href="../../../context/context.go.html#line-62" class="ident">Context</a>, query <a href="../../../../pkg/builtin.html#name-string" class="ident">string</a>, args []<a href="#line-64" class="ident">NamedValue</a>) (<a href="#line-310" class="ident">Result</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Queryer is an optional interface that may be implemented by a Conn.</span><span class="comment"></span><span class="comment"> If a Conn implements neither QueryerContext nor Queryer,</span><span class="comment"> the sql package's DB.Query will first prepare a query, execute the statement,</span><span class="comment"> and then close the statement.</span><span class="comment"></span><span class="comment"> Query may return ErrSkip.</span><span class="comment"></span><span class="comment"> Deprecated: Drivers should implement QueryerContext instead.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../pkg/database/sql/driver.html#name-Queryer" class="ident">Queryer</a> <span class="keyword">interface</span> {
	Query(query <a href="../../../../pkg/builtin.html#name-string" class="ident">string</a>, args []<a href="#line-61" class="ident">Value</a>) (<a href="#line-417" class="ident">Rows</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> QueryerContext is an optional interface that may be implemented by a Conn.</span><span class="comment"></span><span class="comment"> If a Conn does not implement QueryerContext, the sql package's DB.Query</span><span class="comment"> will fall back to Queryer; if the Conn does not implement Queryer either,</span><span class="comment"> DB.Query will first prepare a query, execute the statement, and then</span><span class="comment"> close the statement.</span><span class="comment"></span><span class="comment"> QueryerContext may return ErrSkip.</span><span class="comment"></span><span class="comment"> QueryerContext must honor the context timeout and return when the context is canceled.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../pkg/database/sql/driver.html#name-QueryerContext" class="ident">QueryerContext</a> <span class="keyword">interface</span> {
	QueryContext(ctx <a href="../../../../pkg/context.html" class="ident i0">context</a>.<a href="../../../context/context.go.html#line-62" class="ident">Context</a>, query <a href="../../../../pkg/builtin.html#name-string" class="ident">string</a>, args []<a href="#line-64" class="ident">NamedValue</a>) (<a href="#line-417" class="ident">Rows</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Conn is a connection to a database. It is not used concurrently</span><span class="comment"> by multiple goroutines.</span><span class="comment"></span><span class="comment"> Conn is assumed to be stateful.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Prepare returns a prepared statement, bound to this connection.</span></div>
<div class="code"><pre><code>	Prepare(query <a href="../../../../pkg/builtin.html#name-string" class="ident">string</a>) (<a href="#line-323" class="ident">Stmt</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Close invalidates and potentially stops any current</span><span class="comment">	 prepared statements and transactions, marking this</span><span class="comment">	 connection as no longer in use.</span><span class="comment">	</span><span class="comment">	 Because the sql package maintains a free pool of</span><span class="comment">	 connections and only calls Close when there's a surplus of</span><span class="comment">	 idle connections, it shouldn't be necessary for drivers to</span><span class="comment">	 do their own connection caching.</span><span class="comment">	</span><span class="comment">	 Drivers must ensure all network calls made by Close</span><span class="comment">	 do not block indefinitely (e.g. apply a timeout).</span></div>
<div class="code"><pre><code>	Close() <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Begin starts and returns a new transaction.</span><span class="comment">	</span><span class="comment">	 Deprecated: Drivers should implement ConnBeginTx instead (or additionally).</span></div>
<div class="code"><pre><code>	Begin() (<a href="#line-510" class="ident">Tx</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ConnPrepareContext enhances the Conn interface with context.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> PrepareContext returns a prepared statement, bound to this connection.</span><span class="comment">	 context is for the preparation of the statement,</span><span class="comment">	 it must not store the context within the statement itself.</span></div>
<div class="code"><pre><code>	PrepareContext(ctx <a href="../../../../pkg/context.html" class="ident i0">context</a>.<a href="../../../context/context.go.html#line-62" class="ident">Context</a>, query <a href="../../../../pkg/builtin.html#name-string" class="ident">string</a>) (<a href="#line-323" class="ident">Stmt</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> IsolationLevel is the transaction isolation level stored in TxOptions.</span><span class="comment"></span><span class="comment"> This type should be considered identical to sql.IsolationLevel along</span><span class="comment"> with any values defined on it.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../pkg/database/sql/driver.html#name-IsolationLevel" class="ident">IsolationLevel</a> <a href="../../../../pkg/builtin.html#name-int" class="ident">int</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> TxOptions holds the transaction options.</span><span class="comment"></span><span class="comment"> This type should be considered identical to sql.TxOptions.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../pkg/database/sql/driver.html#name-TxOptions" class="ident">TxOptions</a> <span class="keyword">struct</span> {
	<a href="../../../../use/database/sql/driver..TxOptions.Isolation.html" class="ident">Isolation</a> <a href="#line-262" class="ident">IsolationLevel</a>
	<a href="../../../../use/database/sql/driver..TxOptions.ReadOnly.html" class="ident">ReadOnly</a>  <a href="../../../../pkg/builtin.html#name-bool" class="ident">bool</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ConnBeginTx enhances the Conn interface with context and TxOptions.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> BeginTx starts and returns a new transaction.</span><span class="comment">	 If the context is canceled by the user the sql package will</span><span class="comment">	 call Tx.Rollback before discarding and closing the connection.</span><span class="comment">	</span><span class="comment">	 This must check opts.Isolation to determine if there is a set</span><span class="comment">	 isolation level. If the driver does not support a non-default</span><span class="comment">	 level and one is set or if there is a non-default isolation level</span><span class="comment">	 that is not supported, an error must be returned.</span><span class="comment">	</span><span class="comment">	 This must also check opts.ReadOnly to determine if the read-only</span><span class="comment">	 value is true to either set the read-only transaction property if supported</span><span class="comment">	 or return an error if it is not supported.</span></div>
<div class="code"><pre><code>	BeginTx(ctx <a href="../../../../pkg/context.html" class="ident i0">context</a>.<a href="../../../context/context.go.html#line-62" class="ident">Context</a>, opts <a href="#line-267" class="ident">TxOptions</a>) (<a href="#line-510" class="ident">Tx</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> SessionResetter may be implemented by Conn to allow drivers to reset the</span><span class="comment"> session state associated with the connection and to signal a bad connection.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ResetSession is called prior to executing a query on the connection</span><span class="comment">	 if the connection has been used before. If the driver returns ErrBadConn</span><span class="comment">	 the connection is discarded.</span></div>
<div class="code"><pre><code>	ResetSession(ctx <a href="../../../../pkg/context.html" class="ident i0">context</a>.<a href="../../../context/context.go.html#line-62" class="ident">Context</a>) <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Validator may be implemented by Conn to allow drivers to</span><span class="comment"> signal if a connection is valid or if it should be discarded.</span><span class="comment"></span><span class="comment"> If implemented, drivers may return the underlying error from queries,</span><span class="comment"> even if the connection should be discarded by the connection pool.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> IsValid is called prior to placing the connection into the</span><span class="comment">	 connection pool. The connection will be discarded if false is returned.</span></div>
<div class="code"><pre><code>	IsValid() <a href="../../../../pkg/builtin.html#name-bool" class="ident">bool</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Result is the result of a query execution.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> LastInsertId returns the database's auto-generated ID</span><span class="comment">	 after, for example, an INSERT into a table with primary</span><span class="comment">	 key.</span></div>
<div class="code"><pre><code>	LastInsertId() (<a href="../../../../pkg/builtin.html#name-int64" class="ident">int64</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> RowsAffected returns the number of rows affected by the</span><span class="comment">	 query.</span></div>
<div class="code"><pre><code>	RowsAffected() (<a href="../../../../pkg/builtin.html#name-int64" class="ident">int64</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Stmt is a prepared statement. It is bound to a Conn and not</span><span class="comment"> used by multiple goroutines concurrently.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Close closes the statement.</span><span class="comment">	</span><span class="comment">	 As of Go 1.1, a Stmt will not be closed if it's in use</span><span class="comment">	 by any queries.</span><span class="comment">	</span><span class="comment">	 Drivers must ensure all network calls made by Close</span><span class="comment">	 do not block indefinitely (e.g. apply a timeout).</span></div>
<div class="code"><pre><code>	Close() <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> NumInput returns the number of placeholder parameters.</span><span class="comment">	</span><span class="comment">	 If NumInput returns &gt;= 0, the sql package will sanity check</span><span class="comment">	 argument counts from callers and return errors to the caller</span><span class="comment">	 before the statement's Exec or Query methods are called.</span><span class="comment">	</span><span class="comment">	 NumInput may also return -1, if the driver doesn't know</span><span class="comment">	 its number of placeholders. In that case, the sql package</span><span class="comment">	 will not sanity check Exec or Query argument counts.</span></div>
<div class="code"><pre><code>	NumInput() <a href="../../../../pkg/builtin.html#name-int" class="ident">int</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Exec executes a query that doesn't return rows, such</span><span class="comment">	 as an INSERT or UPDATE.</span><span class="comment">	</span><span class="comment">	 Deprecated: Drivers should implement StmtExecContext instead (or additionally).</span></div>
<div class="code"><pre><code>	Exec(args []<a href="#line-61" class="ident">Value</a>) (<a href="#line-310" class="ident">Result</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Query executes a query that may return rows, such as a</span><span class="comment">	 SELECT.</span><span class="comment">	</span><span class="comment">	 Deprecated: Drivers should implement StmtQueryContext instead (or additionally).</span></div>
<div class="code"><pre><code>	Query(args []<a href="#line-61" class="ident">Value</a>) (<a href="#line-417" class="ident">Rows</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> StmtExecContext enhances the Stmt interface by providing Exec with context.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ExecContext executes a query that doesn't return rows, such</span><span class="comment">	 as an INSERT or UPDATE.</span><span class="comment">	</span><span class="comment">	 ExecContext must honor the context timeout and return when it is canceled.</span></div>
<div class="code"><pre><code>	ExecContext(ctx <a href="../../../../pkg/context.html" class="ident i0">context</a>.<a href="../../../context/context.go.html#line-62" class="ident">Context</a>, args []<a href="#line-64" class="ident">NamedValue</a>) (<a href="#line-310" class="ident">Result</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> StmtQueryContext enhances the Stmt interface by providing Query with context.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> QueryContext executes a query that may return rows, such as a</span><span class="comment">	 SELECT.</span><span class="comment">	</span><span class="comment">	 QueryContext must honor the context timeout and return when it is canceled.</span></div>
<div class="code"><pre><code>	QueryContext(ctx <a href="../../../../pkg/context.html" class="ident i0">context</a>.<a href="../../../context/context.go.html#line-62" class="ident">Context</a>, args []<a href="#line-64" class="ident">NamedValue</a>) (<a href="#line-417" class="ident">Rows</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ErrRemoveArgument may be returned from NamedValueChecker to instruct the</span><span class="comment"> sql package to not pass the argument to the driver query interface.</span><span class="comment"> Return when accepting query specific options or structures that aren't</span><span class="comment"> SQL query arguments.</span></div>
<div class="code"><pre><code><span class="keyword">var</span> <a href="../../../../pkg/database/sql/driver.html#name-ErrRemoveArgument" class="ident">ErrRemoveArgument</a> = <a href="../../../../pkg/errors.html" class="ident i1">errors</a>.<a href="../../../errors/errors.go.html#line-58" class="ident">New</a>(<span class="lit-string">"driver: remove argument from query"</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> NamedValueChecker may be optionally implemented by Conn or Stmt. It provides</span><span class="comment"> the driver more control to handle Go and database types beyond the default</span><span class="comment"> Values types allowed.</span><span class="comment"></span><span class="comment"> The sql package checks for value checkers in the following order,</span><span class="comment"> stopping at the first found match: Stmt.NamedValueChecker, Conn.NamedValueChecker,</span><span class="comment"> Stmt.ColumnConverter, DefaultParameterConverter.</span><span class="comment"></span><span class="comment"> If CheckNamedValue returns ErrRemoveArgument, the NamedValue will not be included in</span><span class="comment"> the final query arguments. This may be used to pass special options to</span><span class="comment"> the query itself.</span><span class="comment"></span><span class="comment"> If ErrSkip is returned the column converter error checking</span><span class="comment"> path is used for the argument. Drivers may wish to return ErrSkip after</span><span class="comment"> they have exhausted their own special cases.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> CheckNamedValue is called before passing arguments to the driver</span><span class="comment">	 and is called in place of any ColumnConverter. CheckNamedValue must do type</span><span class="comment">	 validation and conversion as appropriate for the driver.</span></div>
<div class="code"><pre><code>	CheckNamedValue(*<a href="#line-64" class="ident">NamedValue</a>) <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ColumnConverter may be optionally implemented by Stmt if the</span><span class="comment"> statement is aware of its own columns' types and can convert from</span><span class="comment"> any type to a driver Value.</span><span class="comment"></span><span class="comment"> Deprecated: Drivers should implement NamedValueChecker.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ColumnConverter returns a ValueConverter for the provided</span><span class="comment">	 column index. If the type of a specific column isn't known</span><span class="comment">	 or shouldn't be handled specially, DefaultValueConverter</span><span class="comment">	 can be returned.</span></div>
<div class="code"><pre><code>	ColumnConverter(idx <a href="../../../../pkg/builtin.html#name-int" class="ident">int</a>) <a href="types.go.html#line-30" class="ident">ValueConverter</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Rows is an iterator over an executed query's results.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Columns returns the names of the columns. The number of</span><span class="comment">	 columns of the result is inferred from the length of the</span><span class="comment">	 slice. If a particular column name isn't known, an empty</span><span class="comment">	 string should be returned for that entry.</span></div>
<div class="code"><pre><code>	Columns() []<a href="../../../../pkg/builtin.html#name-string" class="ident">string</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Close closes the rows iterator.</span></div>
<div class="code"><pre><code>	Close() <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Next is called to populate the next row of data into</span><span class="comment">	 the provided slice. The provided slice will be the same</span><span class="comment">	 size as the Columns() are wide.</span><span class="comment">	</span><span class="comment">	 Next should return io.EOF when there are no more rows.</span><span class="comment">	</span><span class="comment">	 The dest should not be written to outside of Next. Care</span><span class="comment">	 should be taken when closing Rows not to modify</span><span class="comment">	 a buffer held in dest.</span></div>
<div class="code"><pre><code>	Next(dest []<a href="#line-61" class="ident">Value</a>) <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> RowsNextResultSet extends the Rows interface by providing a way to signal</span><span class="comment"> the driver to advance to the next result set.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../pkg/database/sql/driver.html#name-RowsNextResultSet" class="ident">RowsNextResultSet</a> <span class="keyword">interface</span> {
	<a href="#line-417" class="ident">Rows</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> HasNextResultSet is called at the end of the current result set and</span><span class="comment">	 reports whether there is another result set after the current one.</span></div>
<div class="code"><pre><code>	HasNextResultSet() <a href="../../../../pkg/builtin.html#name-bool" class="ident">bool</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> NextResultSet advances the driver to the next result set even</span><span class="comment">	 if there are remaining rows in the current result set.</span><span class="comment">	</span><span class="comment">	 NextResultSet should return io.EOF when there are no more result sets.</span></div>
<div class="code"><pre><code>	NextResultSet() <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> RowsColumnTypeScanType may be implemented by Rows. It should return</span><span class="comment"> the value type that can be used to scan types into. For example, the database</span><span class="comment"> column type "bigint" this should return "reflect.TypeOf(int64(0))".</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../pkg/database/sql/driver.html#name-RowsColumnTypeScanType" class="ident">RowsColumnTypeScanType</a> <span class="keyword">interface</span> {
	<a href="#line-417" class="ident">Rows</a>
	ColumnTypeScanType(index <a href="../../../../pkg/builtin.html#name-int" class="ident">int</a>) <a href="../../../../pkg/reflect.html" class="ident i2">reflect</a>.<a href="../../../reflect/type.go.html#line-38" class="ident">Type</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> RowsColumnTypeDatabaseTypeName may be implemented by Rows. It should return the</span><span class="comment"> database system type name without the length. Type names should be uppercase.</span><span class="comment"> Examples of returned types: "VARCHAR", "NVARCHAR", "VARCHAR2", "CHAR", "TEXT",</span><span class="comment"> "DECIMAL", "SMALLINT", "INT", "BIGINT", "BOOL", "[]BIGINT", "JSONB", "XML",</span><span class="comment"> "TIMESTAMP".</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../pkg/database/sql/driver.html#name-RowsColumnTypeDatabaseTypeName" class="ident">RowsColumnTypeDatabaseTypeName</a> <span class="keyword">interface</span> {
	<a href="#line-417" class="ident">Rows</a>
	ColumnTypeDatabaseTypeName(index <a href="../../../../pkg/builtin.html#name-int" class="ident">int</a>) <a href="../../../../pkg/builtin.html#name-string" class="ident">string</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> RowsColumnTypeLength may be implemented by Rows. It should return the length</span><span class="comment"> of the column type if the column is a variable length type. If the column is</span><span class="comment"> not a variable length type ok should return false.</span><span class="comment"> If length is not limited other than system limits, it should return math.MaxInt64.</span><span class="comment"> The following are examples of returned values for various types:</span><span class="comment">   TEXT          (math.MaxInt64, true)</span><span class="comment">   varchar(10)   (10, true)</span><span class="comment">   nvarchar(10)  (10, true)</span><span class="comment">   decimal       (0, false)</span><span class="comment">   int           (0, false)</span><span class="comment">   bytea(30)     (30, true)</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../pkg/database/sql/driver.html#name-RowsColumnTypeLength" class="ident">RowsColumnTypeLength</a> <span class="keyword">interface</span> {
	<a href="#line-417" class="ident">Rows</a>
	ColumnTypeLength(index <a href="../../../../pkg/builtin.html#name-int" class="ident">int</a>) (length <a href="../../../../pkg/builtin.html#name-int64" class="ident">int64</a>, ok <a href="../../../../pkg/builtin.html#name-bool" class="ident">bool</a>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> RowsColumnTypeNullable may be implemented by Rows. The nullable value should</span><span class="comment"> be true if it is known the column may be null, or false if the column is known</span><span class="comment"> to be not nullable.</span><span class="comment"> If the column nullability is unknown, ok should be false.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../pkg/database/sql/driver.html#name-RowsColumnTypeNullable" class="ident">RowsColumnTypeNullable</a> <span class="keyword">interface</span> {
	<a href="#line-417" class="ident">Rows</a>
	ColumnTypeNullable(index <a href="../../../../pkg/builtin.html#name-int" class="ident">int</a>) (nullable, ok <a href="../../../../pkg/builtin.html#name-bool" class="ident">bool</a>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> RowsColumnTypePrecisionScale may be implemented by Rows. It should return</span><span class="comment"> the precision and scale for decimal types. If not applicable, ok should be false.</span><span class="comment"> The following are examples of returned values for various types:</span><span class="comment">   decimal(38, 4)    (38, 4, true)</span><span class="comment">   int               (0, 0, false)</span><span class="comment">   decimal           (math.MaxInt64, math.MaxInt64, true)</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../pkg/database/sql/driver.html#name-RowsColumnTypePrecisionScale" class="ident">RowsColumnTypePrecisionScale</a> <span class="keyword">interface</span> {
	<a href="#line-417" class="ident">Rows</a>
	ColumnTypePrecisionScale(index <a href="../../../../pkg/builtin.html#name-int" class="ident">int</a>) (precision, scale <a href="../../../../pkg/builtin.html#name-int64" class="ident">int64</a>, ok <a href="../../../../pkg/builtin.html#name-bool" class="ident">bool</a>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Tx is a transaction.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../pkg/database/sql/driver.html#name-Tx" class="ident">Tx</a> <span class="keyword">interface</span> {
	Commit() <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>
	Rollback() <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> RowsAffected implements Result for an INSERT or UPDATE operation</span><span class="comment"> which mutates a number of rows.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../pkg/database/sql/driver.html#name-RowsAffected" class="ident">RowsAffected</a> <a href="../../../../pkg/builtin.html#name-int64" class="ident">int64</a>

<span class="keyword">var</span> _ <a href="#line-310" class="ident">Result</a> = <a href="#line-517" class="ident">RowsAffected</a>(<span class="lit-number">0</span>)

<span class="keyword">func</span> (<a href="#line-517" class="ident">RowsAffected</a>) <label for="r0" class="ident"><a href="../../../../use/database/sql/driver..RowsAffected.LastInsertId.html" class="ident">LastInsertId</a></label>() (<a href="../../../../pkg/builtin.html#name-int64" class="ident">int64</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>) {
	<span class="keyword">return</span> <span class="lit-number">0</span>, <a href="../../../../pkg/errors.html" class="ident i1">errors</a>.<a href="../../../errors/errors.go.html#line-58" class="ident">New</a>(<span class="lit-string">"LastInsertId is not supported by this driver"</span>)
}

<span class="keyword">func</span> (<label for="r1" class="ident">v</label> <a href="#line-517" class="ident">RowsAffected</a>) <label for="r2" class="ident"><a href="../../../../use/database/sql/driver..RowsAffected.RowsAffected.html" class="ident">RowsAffected</a></label>() (<a href="../../../../pkg/builtin.html#name-int64" class="ident">int64</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>) {
	<span class="keyword">return</span> <a href="../../../../pkg/builtin.html#name-int64" class="ident">int64</a>(<label for="r1" class="ident">v</label>), <a href="../../../../pkg/builtin.html#name-nil" class="ident">nil</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ResultNoRows is a pre-defined Result for drivers to return when a DDL</span><span class="comment"> command (such as a CREATE TABLE) succeeds. It returns an error for both</span><span class="comment"> LastInsertId and RowsAffected.</span></div>
<div class="code"><pre><code><span class="keyword">var</span> <a href="../../../../pkg/database/sql/driver.html#name-ResultNoRows" class="ident">ResultNoRows</a> <a href="#line-534" class="ident">noRows</a>

<span class="keyword">type</span> <a href="../../../../pkg/database/sql/driver.html#name-noRows" class="ident">noRows</a> <span class="keyword">struct</span>{}

<span class="keyword">var</span> _ <a href="#line-310" class="ident">Result</a> = <a href="#line-534" class="ident">noRows</a>{}

<span class="keyword">func</span> (<a href="#line-534" class="ident">noRows</a>) <label for="r3" class="ident"><a href="../../../../use/database/sql/driver..noRows*3d19b.LastInsertId.html" class="ident">LastInsertId</a></label>() (<a href="../../../../pkg/builtin.html#name-int64" class="ident">int64</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>) {
	<span class="keyword">return</span> <span class="lit-number">0</span>, <a href="../../../../pkg/errors.html" class="ident i1">errors</a>.<a href="../../../errors/errors.go.html#line-58" class="ident">New</a>(<span class="lit-string">"no LastInsertId available after DDL statement"</span>)
}

<span class="keyword">func</span> (<a href="#line-534" class="ident">noRows</a>) <label for="r4" class="ident"><a href="../../../../use/database/sql/driver..noRows*3d19b.RowsAffected.html" class="ident">RowsAffected</a></label>() (<a href="../../../../pkg/builtin.html#name-int64" class="ident">int64</a>, <a href="../../../../pkg/builtin.html#name-error" class="ident">error</a>) {
	<span class="keyword">return</span> <span class="lit-number">0</span>, <a href="../../../../pkg/errors.html" class="ident i1">errors</a>.<a href="../../../errors/errors.go.html#line-58" class="ident">New</a>(<span class="lit-string">"no RowsAffected available after DDL statement"</span>)
</code></pre></div></div>

</div><pre id="footer">
<table><tr><td><img src="../../../../png/go101-twitter.png"></td>
<td>The pages are generated with <a href="https://go101.org/article/tool-golds.html"><b>Golds</b></a> <i>v0.3.2-preview</i>. (GOOS=darwin GOARCH=amd64)
<b>Golds</b> is a <a href="https://go101.org">Go 101</a> project developed by <a href="https://tapirgames.com">Tapir Liu</a>.
PR and bug reports are welcome and can be submitted to <a href="https://github.com/go101/golds">the issue list</a>.
Please follow <a href="https://twitter.com/go100and1">@Go100and1</a> (reachable from the left QR code) to get the latest news of <b>Golds</b>.</td></tr></table></pre>