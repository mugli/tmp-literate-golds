<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Source: trieval.go in package golang.org/x/text/cases</title>
<link href="../../../../../css/lightLiterate-v0.3.2-preview.css" rel="stylesheet">
<script src="../../../../../jvs/golds-v0.3.2-preview.js"></script>
<body onload="onPageLoad()"><div>

<pre id="header"><code><span class="title">Source File</span>
	trieval.go

<span class="title">Belonging Package</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html">golang.org/x/text/cases</a>
</code></pre>
<style>input[type=radio] {display: none;}
input[id=r0]:checked ~pre label[for=r0],
input[id=r1]:checked ~pre label[for=r1],
input[id=r2]:checked ~pre label[for=r2],
input[id=r3]:checked ~pre label[for=r3],
input[id=r4]:checked ~pre label[for=r4],
input[id=r5]:checked ~pre label[for=r5],
input[id=r6]:checked ~pre label[for=r6],
input[id=r7]:checked ~pre label[for=r7],
input[id=r8]:checked ~pre label[for=r8],
input[id=r9]:checked ~pre label[for=r9],
input[id=r10]:checked ~pre label[for=r10],
input[id=r11]:checked ~pre label[for=r11],
input[id=r12]:checked ~pre label[for=r12],
input[id=r13]:checked ~pre label[for=r13],
input[id=r14]:checked ~pre label[for=r14],
input[id=r15]:checked ~pre label[for=r15],
input[id=r16]:checked ~pre label[for=r16],
input[id=r17]:checked ~pre label[for=r17]
{background: #226; color: #ff8;}
{background: brown; color: #eed;}
</style><input id="r0" type="radio" name="g"/>
<input id="r1" type="radio" name="g"/>
<input id="r2" type="radio" name="g"/>
<input id="r3" type="radio" name="g"/>
<input id="r4" type="radio" name="g"/>
<input id="r5" type="radio" name="g"/>
<input id="r6" type="radio" name="g"/>
<input id="r7" type="radio" name="g"/>
<input id="r8" type="radio" name="g"/>
<input id="r9" type="radio" name="g"/>
<input id="r10" type="radio" name="g"/>
<input id="r11" type="radio" name="g"/>
<input id="r12" type="radio" name="g"/>
<input id="r13" type="radio" name="g"/>
<input id="r14" type="radio" name="g"/>
<input id="r15" type="radio" name="g"/>
<input id="r16" type="radio" name="g"/>
<input id="r17" type="radio" name="g"/>
<div id="container"><div class="section">
<div class="doc">
<span class="comment"> Code generated by running "go generate" in golang.org/x/text. DO NOT EDIT.</span></div>
<div class="code"><pre><code>
<span class="keyword">package</span> cases
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> This file contains definitions for interpreting the trie value of the case</span><span class="comment"> trie generated by "go run gen*.go". It is shared by both the generator</span><span class="comment"> program and the resultant package. Sharing is achieved by the generator</span><span class="comment"> copying gen_trieval.go to trieval.go and changing what's above this comment.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> info holds case information for a single rune. It is the value returned</span><span class="comment"> by a trie lookup. Most mapping information can be stored in a single 16-bit</span><span class="comment"> value. If not, for example when a rune is mapped to multiple runes, the value</span><span class="comment"> stores some basic case data and an index into an array with additional data.</span><span class="comment"></span><span class="comment"> The per-rune values have the following format:</span><span class="comment"></span><span class="comment">   if (exception) {</span><span class="comment">     15..4  unsigned exception index</span><span class="comment">   } else {</span><span class="comment">     15..8  XOR pattern or index to XOR pattern for case mapping</span><span class="comment">            Only 13..8 are used for XOR patterns.</span><span class="comment">         7  inverseFold (fold to upper, not to lower)</span><span class="comment">         6  index: interpret the XOR pattern as an index</span><span class="comment">            or isMid if case mode is cIgnorableUncased.</span><span class="comment">      5..4  CCC: zero (normal or break), above or other</span><span class="comment">   }</span><span class="comment">      3  exception: interpret this value as an exception index</span><span class="comment">         (TODO: is this bit necessary? Probably implied from case mode.)</span><span class="comment">   2..0  case mode</span><span class="comment"></span><span class="comment"> For the non-exceptional cases, a rune must be either uncased, lowercase or</span><span class="comment"> uppercase. If the rune is cased, the XOR pattern maps either a lowercase</span><span class="comment"> rune to uppercase or an uppercase rune to lowercase (applied to the 10</span><span class="comment"> least-significant bits of the rune).</span><span class="comment"></span><span class="comment"> See the definitions below for a more detailed description of the various</span><span class="comment"> bits.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../../pkg/golang.org/x/text/cases.html#name-info" class="ident">info</a> <a href="../../../../../pkg/builtin.html#name-uint16" class="ident">uint16</a>

<span class="keyword">const</span> (
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-casedMask" class="ident">casedMask</a>      = <span class="lit-number">0x0003</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-fullCasedMask" class="ident">fullCasedMask</a>  = <span class="lit-number">0x0007</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-ignorableMask" class="ident">ignorableMask</a>  = <span class="lit-number">0x0006</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-ignorableValue" class="ident">ignorableValue</a> = <span class="lit-number">0x0004</span>

	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-inverseFoldBit" class="ident">inverseFoldBit</a> = <span class="lit-number">1</span> &lt;&lt; <span class="lit-number">7</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-isMidBit" class="ident">isMidBit</a>       = <span class="lit-number">1</span> &lt;&lt; <span class="lit-number">6</span>

	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-exceptionBit" class="ident">exceptionBit</a>     = <span class="lit-number">1</span> &lt;&lt; <span class="lit-number">3</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-exceptionShift" class="ident">exceptionShift</a>   = <span class="lit-number">4</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-numExceptionBits" class="ident">numExceptionBits</a> = <span class="lit-number">12</span>

	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-xorIndexBit" class="ident">xorIndexBit</a> = <span class="lit-number">1</span> &lt;&lt; <span class="lit-number">6</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-xorShift" class="ident">xorShift</a>    = <span class="lit-number">8</span>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> There is no mapping if all xor bits and the exception bit are zero.</span></div>
<div class="code"><pre><code>	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-hasMappingMask" class="ident">hasMappingMask</a> = <span class="lit-number">0xff80</span> | <a href="#line-49" class="ident">exceptionBit</a>
)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> The case mode bits encodes the case type of a rune. This includes uncased,</span><span class="comment"> title, upper and lower case and case ignorable. (For a definition of these</span><span class="comment"> terms see Chapter 3 of The Unicode Standard Core Specification.) In some rare</span><span class="comment"> cases, a rune can be both cased and case-ignorable. This is encoded by</span><span class="comment"> cIgnorableCased. A rune of this type is always lower case. Some runes are</span><span class="comment"> cased while not having a mapping.</span><span class="comment"></span><span class="comment"> A common pattern for scripts in the Unicode standard is for upper and lower</span><span class="comment"> case runes to alternate for increasing rune values (e.g. the accented Latin</span><span class="comment"> ranges starting from U+0100 and U+1E00 among others and some Cyrillic</span><span class="comment"> characters). We use this property by defining a cXORCase mode, where the case</span><span class="comment"> mode (always upper or lower case) is derived from the rune value. As the XOR</span><span class="comment"> pattern for case mappings is often identical for successive runes, using</span><span class="comment"> cXORCase can result in large series of identical trie values. This, in turn,</span><span class="comment"> allows us to better compress the trie blocks.</span></div>
<div class="code"><pre><code><span class="keyword">const</span> (
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-cUncased" class="ident">cUncased</a>          <a href="#line-38" class="ident">info</a> = <a href="../../../../../pkg/builtin.html#name-iota" class="ident">iota</a> <span class="comment">// 000</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-cTitle" class="ident">cTitle</a>                        <span class="comment">// 001</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-cLower" class="ident">cLower</a>                        <span class="comment">// 010</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-cUpper" class="ident">cUpper</a>                        <span class="comment">// 011</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-cIgnorableUncased" class="ident">cIgnorableUncased</a>             <span class="comment">// 100</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-cIgnorableCased" class="ident">cIgnorableCased</a>               <span class="comment">// 101 // lower case if mappings exist</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-cXORCase" class="ident">cXORCase</a>                      <span class="comment">// 11x // case is cLower | ((rune&amp;1) ^ x)</span>

	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-maxCaseMode" class="ident">maxCaseMode</a> = <a href="#line-79" class="ident">cUpper</a>
)

<span class="keyword">func</span> (<label for="r0" class="ident">c</label> <a href="#line-38" class="ident">info</a>) <label for="r1" class="ident"><a href="../../../../../use/golang.org/x/text/cases..info*06271.isCased*5f7be.html" class="ident">isCased</a></label>() <a href="../../../../../pkg/builtin.html#name-bool" class="ident">bool</a> {
	<span class="keyword">return</span> <label for="r0" class="ident">c</label>&amp;<a href="#line-41" class="ident">casedMask</a> != <span class="lit-number">0</span>
}

<span class="keyword">func</span> (<label for="r2" class="ident">c</label> <a href="#line-38" class="ident">info</a>) <label for="r3" class="ident"><a href="../../../../../use/golang.org/x/text/cases..info*06271.isCaseIgnorable*75318.html" class="ident">isCaseIgnorable</a></label>() <a href="../../../../../pkg/builtin.html#name-bool" class="ident">bool</a> {
	<span class="keyword">return</span> <label for="r2" class="ident">c</label>&amp;<a href="#line-43" class="ident">ignorableMask</a> == <a href="#line-44" class="ident">ignorableValue</a>
}

<span class="keyword">func</span> (<label for="r4" class="ident">c</label> <a href="#line-38" class="ident">info</a>) <label for="r5" class="ident"><a href="../../../../../use/golang.org/x/text/cases..info*06271.isNotCasedAndNotCaseIgnorable*6b9b9.html" class="ident">isNotCasedAndNotCaseIgnorable</a></label>() <a href="../../../../../pkg/builtin.html#name-bool" class="ident">bool</a> {
	<span class="keyword">return</span> <label for="r4" class="ident">c</label>&amp;<a href="#line-42" class="ident">fullCasedMask</a> == <span class="lit-number">0</span>
}

<span class="keyword">func</span> (<label for="r6" class="ident">c</label> <a href="#line-38" class="ident">info</a>) <label for="r7" class="ident"><a href="../../../../../use/golang.org/x/text/cases..info*06271.isCaseIgnorableAndNotCased*7c76b.html" class="ident">isCaseIgnorableAndNotCased</a></label>() <a href="../../../../../pkg/builtin.html#name-bool" class="ident">bool</a> {
	<span class="keyword">return</span> <label for="r6" class="ident">c</label>&amp;<a href="#line-42" class="ident">fullCasedMask</a> == <a href="#line-80" class="ident">cIgnorableUncased</a>
}

<span class="keyword">func</span> (<label for="r8" class="ident">c</label> <a href="#line-38" class="ident">info</a>) <label for="r9" class="ident"><a href="../../../../../use/golang.org/x/text/cases..info*06271.isMid*f668c.html" class="ident">isMid</a></label>() <a href="../../../../../pkg/builtin.html#name-bool" class="ident">bool</a> {
	<span class="keyword">return</span> <label for="r8" class="ident">c</label>&amp;(<a href="#line-42" class="ident">fullCasedMask</a>|<a href="#line-47" class="ident">isMidBit</a>) == <a href="#line-47" class="ident">isMidBit</a>|<a href="#line-80" class="ident">cIgnorableUncased</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> The case mapping implementation will need to know about various Canonical</span><span class="comment"> Combining Class (CCC) values. We encode two of these in the trie value:</span><span class="comment"> cccZero (0) and cccAbove (230). If the value is cccOther, it means that</span><span class="comment"> CCC(r) &gt; 0, but not 230. A value of cccBreak means that CCC(r) == 0 and that</span><span class="comment"> the rune also has the break category Break (see below).</span></div>
<div class="code"><pre><code><span class="keyword">const</span> (
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-cccBreak" class="ident">cccBreak</a> <a href="#line-38" class="ident">info</a> = <a href="../../../../../pkg/builtin.html#name-iota" class="ident">iota</a> &lt;&lt; <span class="lit-number">4</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-cccZero" class="ident">cccZero</a>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-cccAbove" class="ident">cccAbove</a>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-cccOther" class="ident">cccOther</a>

	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-cccMask" class="ident">cccMask</a> = <a href="#line-113" class="ident">cccBreak</a> | <a href="#line-114" class="ident">cccZero</a> | <a href="#line-115" class="ident">cccAbove</a> | <a href="#line-116" class="ident">cccOther</a>
)

<span class="keyword">const</span> (
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-starter" class="ident">starter</a>       = <span class="lit-number">0</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-above" class="ident">above</a>         = <span class="lit-number">230</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-iotaSubscript" class="ident">iotaSubscript</a> = <span class="lit-number">240</span>
)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> The exceptions slice holds data that does not fit in a normal info entry.</span><span class="comment"> The entry is pointed to by the exception index in an entry. It has the</span><span class="comment"> following format:</span><span class="comment"></span><span class="comment"> Header</span><span class="comment"> byte 0:</span><span class="comment">  7..6  unused</span><span class="comment">  5..4  CCC type (same bits as entry)</span><span class="comment">     3  unused</span><span class="comment">  2..0  length of fold</span><span class="comment"></span><span class="comment"> byte 1:</span><span class="comment">   7..6  unused</span><span class="comment">   5..3  length of 1st mapping of case type</span><span class="comment">   2..0  length of 2nd mapping of case type</span><span class="comment"></span><span class="comment">   case     1st    2nd</span><span class="comment">   lower -&gt; upper, title</span><span class="comment">   upper -&gt; lower, title</span><span class="comment">   title -&gt; lower, upper</span><span class="comment"></span><span class="comment"> Lengths with the value 0x7 indicate no value and implies no change.</span><span class="comment"> A length of 0 indicates a mapping to zero-length string.</span><span class="comment"></span><span class="comment"> Body bytes:</span><span class="comment">   case folding bytes</span><span class="comment">   lowercase mapping bytes</span><span class="comment">   uppercase mapping bytes</span><span class="comment">   titlecase mapping bytes</span><span class="comment">   closure mapping bytes (for NFKC_Casefold). (TODO)</span><span class="comment"></span><span class="comment"> Fallbacks:</span><span class="comment">   missing fold  -&gt; lower</span><span class="comment">   missing title -&gt; upper</span><span class="comment">   all missing   -&gt; original rune</span><span class="comment"></span><span class="comment"> exceptions starts with a dummy byte to enforce that there is no zero index</span><span class="comment"> value.</span></div>
<div class="code"><pre><code><span class="keyword">const</span> (
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-lengthMask" class="ident">lengthMask</a> = <span class="lit-number">0x07</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-lengthBits" class="ident">lengthBits</a> = <span class="lit-number">3</span>
	<a href="../../../../../pkg/golang.org/x/text/cases.html#name-noChange" class="ident">noChange</a>   = <span class="lit-number">0</span>
)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> References to generated trie.</span></div>
<div class="code"><pre><code>
<span class="keyword">var</span> <a href="../../../../../pkg/golang.org/x/text/cases.html#name-trie" class="ident">trie</a> = <a href="tables13.0.0.go.html#line-234" class="ident">newCaseTrie</a>(<span class="lit-number">0</span>)

<span class="keyword">var</span> <a href="../../../../../pkg/golang.org/x/text/cases.html#name-sparse" class="ident">sparse</a> = <a href="#line-188" class="ident">sparseBlocks</a>{
	<a href="#line-189" class="ident">values</a>:  <a href="tables13.0.0.go.html#line-618" class="ident">sparseValues</a>[:],
	<a href="#line-190" class="ident">offsets</a>: <a href="tables13.0.0.go.html#line-615" class="ident">sparseOffsets</a>[:],
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Sparse block lookup code.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> valueRange is an entry in a sparse block.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../../../pkg/golang.org/x/text/cases.html#name-valueRange" class="ident">valueRange</a> <span class="keyword">struct</span> {
	<a href="../../../../../use/golang.org/x/text/cases..valueRange*d2489.value*cd424.html" class="ident">value</a>  <a href="../../../../../pkg/builtin.html#name-uint16" class="ident">uint16</a>
	<a href="../../../../../use/golang.org/x/text/cases..valueRange*d2489.lo*9294a.html" class="ident">lo</a>, <a href="../../../../../use/golang.org/x/text/cases..valueRange*d2489.hi*8f434.html" class="ident">hi</a> <a href="../../../../../pkg/builtin.html#name-byte" class="ident">byte</a>
}

<span class="keyword">type</span> <a href="../../../../../pkg/golang.org/x/text/cases.html#name-sparseBlocks" class="ident">sparseBlocks</a> <span class="keyword">struct</span> {
	<a href="../../../../../use/golang.org/x/text/cases..sparseBlocks*5ec6f.values*89445.html" class="ident">values</a>  []<a href="#line-183" class="ident">valueRange</a>
	<a href="../../../../../use/golang.org/x/text/cases..sparseBlocks*5ec6f.offsets*bb956.html" class="ident">offsets</a> []<a href="../../../../../pkg/builtin.html#name-uint16" class="ident">uint16</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> lookup returns the value from values block n for byte b using binary search.</span></div>
<div class="code"><pre><code><span class="keyword">func</span> (<label for="r10" class="ident">s</label> *<a href="#line-188" class="ident">sparseBlocks</a>) <label for="r11" class="ident"><a href="../../../../../use/golang.org/x/text/cases..sparseBlocks*5ec6f.lookup*29a1a.html" class="ident">lookup</a></label>(<label for="r12" class="ident">n</label> <a href="../../../../../pkg/builtin.html#name-uint32" class="ident">uint32</a>, <label for="r13" class="ident">b</label> <a href="../../../../../pkg/builtin.html#name-byte" class="ident">byte</a>) <a href="../../../../../pkg/builtin.html#name-uint16" class="ident">uint16</a> {
	<label for="r14" class="ident">lo</label> := <label for="r10" class="ident">s</label>.<a href="#line-190" class="ident">offsets</a>[<label for="r12" class="ident">n</label>]
	<label for="r15" class="ident">hi</label> := <label for="r10" class="ident">s</label>.<a href="#line-190" class="ident">offsets</a>[<label for="r12" class="ident">n</label>+<span class="lit-number">1</span>]
	<span class="keyword">for</span> <label for="r14" class="ident">lo</label> &lt; <label for="r15" class="ident">hi</label> {
		<label for="r16" class="ident">m</label> := <label for="r14" class="ident">lo</label> + (<label for="r15" class="ident">hi</label>-<label for="r14" class="ident">lo</label>)/<span class="lit-number">2</span>
		<label for="r17" class="ident">r</label> := <label for="r10" class="ident">s</label>.<a href="#line-189" class="ident">values</a>[<label for="r16" class="ident">m</label>]
		<span class="keyword">if</span> <label for="r17" class="ident">r</label>.<a href="#line-185" class="ident">lo</a> &lt;= <label for="r13" class="ident">b</label> &amp;&amp; <label for="r13" class="ident">b</label> &lt;= <label for="r17" class="ident">r</label>.<a href="#line-185" class="ident">hi</a> {
			<span class="keyword">return</span> <label for="r17" class="ident">r</label>.<a href="#line-184" class="ident">value</a>
		}
		<span class="keyword">if</span> <label for="r13" class="ident">b</label> &lt; <label for="r17" class="ident">r</label>.<a href="#line-185" class="ident">lo</a> {
			<label for="r15" class="ident">hi</label> = <label for="r16" class="ident">m</label>
		} <span class="keyword">else</span> {
			<label for="r14" class="ident">lo</label> = <label for="r16" class="ident">m</label> + <span class="lit-number">1</span>
		}
	}
	<span class="keyword">return</span> <span class="lit-number">0</span>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> lastRuneForTesting is the last rune used for testing. Everything after this</span><span class="comment"> is boring.</span></div>
<div class="code"><pre><code></code></pre></div></div>

</div><pre id="footer">
<table><tr><td><img src="../../../../../png/go101-twitter.png"></td>
<td>The pages are generated with <a href="https://go101.org/article/tool-golds.html"><b>Golds</b></a> <i>v0.3.2-preview</i>. (GOOS=darwin GOARCH=amd64)
<b>Golds</b> is a <a href="https://go101.org">Go 101</a> project developed by <a href="https://tapirgames.com">Tapir Liu</a>.
PR and bug reports are welcome and can be submitted to <a href="https://github.com/go101/golds">the issue list</a>.
Please follow <a href="https://twitter.com/go100and1">@Go100and1</a> (reachable from the left QR code) to get the latest news of <b>Golds</b>.</td></tr></table></pre>