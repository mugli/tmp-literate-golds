<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Source: error.go in package html/template</title>
<link href="../../../css/lightLiterate-v0.3.2-preview.css" rel="stylesheet">
<script src="../../../jvs/golds-v0.3.2-preview.js"></script>
<body onload="onPageLoad()"><div>

<pre id="header"><code><span class="title">Source File</span>
	error.go

<span class="title">Belonging Package</span>
	<a href="../../../pkg/html/template.html">html/template</a>
</code></pre>
<style>input[type=radio] {display: none;}
input[id=r0]:checked ~pre label[for=r0],
input[id=r1]:checked ~pre label[for=r1],
input[id=r2]:checked ~pre label[for=r2],
input[id=r3]:checked ~pre label[for=r3],
input[id=r4]:checked ~pre label[for=r4],
input[id=r5]:checked ~pre label[for=r5],
input[id=r6]:checked ~pre label[for=r6],
input[id=r7]:checked ~pre label[for=r7],
input[id=r8]:checked ~pre label[for=r8],
input[id=r9]:checked ~pre label[for=r9]
{background: #226; color: #ff8;}
input[id=i0]:checked ~pre .i0,
input[id=i1]:checked ~pre .i1
{background: brown; color: #eed;}
</style><input id="r0" type="radio" name="g"/>
<input id="r1" type="radio" name="g"/>
<input id="r2" type="radio" name="g"/>
<input id="r3" type="radio" name="g"/>
<input id="r4" type="radio" name="g"/>
<input id="r5" type="radio" name="g"/>
<input id="r6" type="radio" name="g"/>
<input id="r7" type="radio" name="g"/>
<input id="r8" type="radio" name="g"/>
<input id="r9" type="radio" name="g"/>
<input id="i0" type="radio" name="i"/>
<input id="i1" type="radio" name="i"/>
<div id="container"><div class="section">
<div class="doc">
<span class="comment"> Copyright 2011 The Go Authors. All rights reserved.</span><span class="comment"> Use of this source code is governed by a BSD-style</span><span class="comment"> license that can be found in the LICENSE file.</span></div>
<div class="code"><pre><code>
<span class="keyword">package</span> template

<span class="keyword">import</span> (
	<label for="i0"><span class="lit-string i0">"fmt"</span></label>
	<label for="i1"><span class="lit-string i1">"text/template/parse"</span></label>
)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Error describes a problem encountered during template Escaping.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ErrorCode describes the kind of error.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Node is the node that caused the problem, if known.</span><span class="comment">	 If not nil, it overrides Name and Line.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Name is the name of the template in which the error was encountered.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Line is the line number of the error in the template source or 0.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Description is a human-readable description of the problem.</span></div>
<div class="code"><pre><code>	<a href="../../../use/html/template..Error.Description.html" class="ident">Description</a> <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ErrorCode is a code for a kind of error.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../pkg/html/template.html#name-ErrorCode" class="ident">ErrorCode</a> <a href="../../../pkg/builtin.html#name-int" class="ident">int</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> We define codes for each error that manifests while escaping templates, but</span><span class="comment"> escaped templates may also fail at runtime.</span><span class="comment"></span><span class="comment"> Output: "ZgotmplZ"</span><span class="comment"> Example:</span><span class="comment">   &lt;img src="{{.X}}"&gt;</span><span class="comment">   where {{.X}} evaluates to `javascript:...`</span><span class="comment"> Discussion:</span><span class="comment">   "ZgotmplZ" is a special value that indicates that unsafe content reached a</span><span class="comment">   CSS or URL context at runtime. The output of the example will be</span><span class="comment">     &lt;img src="#ZgotmplZ"&gt;</span><span class="comment">   If the data comes from a trusted source, use content types to exempt it</span><span class="comment">   from filtering: URL(`javascript:...`).</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> OK indicates the lack of an error.</span></div>
<div class="code"><pre><code>	<a href="../../../pkg/html/template.html#name-OK" class="ident">OK</a> <a href="#line-28" class="ident">ErrorCode</a> = <a href="../../../pkg/builtin.html#name-iota" class="ident">iota</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ErrAmbigContext: "... appears in an ambiguous context within a URL"</span><span class="comment">	 Example:</span><span class="comment">	   &lt;a href="</span><span class="comment">	      {{if .C}}</span><span class="comment">	        /path/</span><span class="comment">	      {{else}}</span><span class="comment">	        /search?q=</span><span class="comment">	      {{end}}</span><span class="comment">	      {{.X}}</span><span class="comment">	   "&gt;</span><span class="comment">	 Discussion:</span><span class="comment">	   {{.X}} is in an ambiguous URL context since, depending on {{.C}},</span><span class="comment">	  it may be either a URL suffix or a query parameter.</span><span class="comment">	   Moving {{.X}} into the condition removes the ambiguity:</span><span class="comment">	   &lt;a href="{{if .C}}/path/{{.X}}{{else}}/search?q={{.X}}"&gt;</span></div>
<div class="code"><pre><code>	<a href="../../../pkg/html/template.html#name-ErrAmbigContext" class="ident">ErrAmbigContext</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ErrBadHTML: "expected space, attr name, or end of tag, but got ...",</span><span class="comment">	   "... in unquoted attr", "... in attribute name"</span><span class="comment">	 Example:</span><span class="comment">	   &lt;a href = /search?q=foo&gt;</span><span class="comment">	   &lt;href=foo&gt;</span><span class="comment">	   &lt;form na&lt;e=...&gt;</span><span class="comment">	   &lt;option selected&lt;</span><span class="comment">	 Discussion:</span><span class="comment">	   This is often due to a typo in an HTML element, but some runes</span><span class="comment">	   are banned in tag names, attribute names, and unquoted attribute</span><span class="comment">	   values because they can tickle parser ambiguities.</span><span class="comment">	   Quoting all attributes is the best policy.</span></div>
<div class="code"><pre><code>	<a href="../../../pkg/html/template.html#name-ErrBadHTML" class="ident">ErrBadHTML</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ErrBranchEnd: "{{if}} branches end in different contexts"</span><span class="comment">	 Example:</span><span class="comment">	   {{if .C}}&lt;a href="{{end}}{{.X}}</span><span class="comment">	 Discussion:</span><span class="comment">	   Package html/template statically examines each path through an</span><span class="comment">	   {{if}}, {{range}}, or {{with}} to escape any following pipelines.</span><span class="comment">	   The example is ambiguous since {{.X}} might be an HTML text node,</span><span class="comment">	   or a URL prefix in an HTML attribute. The context of {{.X}} is</span><span class="comment">	   used to figure out how to escape it, but that context depends on</span><span class="comment">	   the run-time value of {{.C}} which is not statically known.</span><span class="comment">	</span><span class="comment">	   The problem is usually something like missing quotes or angle</span><span class="comment">	   brackets, or can be avoided by refactoring to put the two contexts</span><span class="comment">	   into different branches of an if, range or with. If the problem</span><span class="comment">	   is in a {{range}} over a collection that should never be empty,</span><span class="comment">	   adding a dummy {{else}} can help.</span></div>
<div class="code"><pre><code>	<a href="../../../pkg/html/template.html#name-ErrBranchEnd" class="ident">ErrBranchEnd</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ErrEndContext: "... ends in a non-text context: ..."</span><span class="comment">	 Examples:</span><span class="comment">	   &lt;div</span><span class="comment">	   &lt;div title="no close quote&gt;</span><span class="comment">	   &lt;script&gt;f()</span><span class="comment">	 Discussion:</span><span class="comment">	   Executed templates should produce a DocumentFragment of HTML.</span><span class="comment">	   Templates that end without closing tags will trigger this error.</span><span class="comment">	   Templates that should not be used in an HTML context or that</span><span class="comment">	   produce incomplete Fragments should not be executed directly.</span><span class="comment">	</span><span class="comment">	   {{define "main"}} &lt;script&gt;{{template "helper"}}&lt;/script&gt; {{end}}</span><span class="comment">	   {{define "helper"}} document.write(' &lt;div title=" ') {{end}}</span><span class="comment">	</span><span class="comment">	   "helper" does not produce a valid document fragment, so should</span><span class="comment">	   not be Executed directly.</span></div>
<div class="code"><pre><code>	<a href="../../../pkg/html/template.html#name-ErrEndContext" class="ident">ErrEndContext</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ErrNoSuchTemplate: "no such template ..."</span><span class="comment">	 Examples:</span><span class="comment">	   {{define "main"}}&lt;div {{template "attrs"}}&gt;{{end}}</span><span class="comment">	   {{define "attrs"}}href="{{.URL}}"{{end}}</span><span class="comment">	 Discussion:</span><span class="comment">	   Package html/template looks through template calls to compute the</span><span class="comment">	   context.</span><span class="comment">	   Here the {{.URL}} in "attrs" must be treated as a URL when called</span><span class="comment">	   from "main", but you will get this error if "attrs" is not defined</span><span class="comment">	   when "main" is parsed.</span></div>
<div class="code"><pre><code>	<a href="../../../pkg/html/template.html#name-ErrNoSuchTemplate" class="ident">ErrNoSuchTemplate</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ErrOutputContext: "cannot compute output context for template ..."</span><span class="comment">	 Examples:</span><span class="comment">	   {{define "t"}}{{if .T}}{{template "t" .T}}{{end}}{{.H}}",{{end}}</span><span class="comment">	 Discussion:</span><span class="comment">	   A recursive template does not end in the same context in which it</span><span class="comment">	   starts, and a reliable output context cannot be computed.</span><span class="comment">	   Look for typos in the named template.</span><span class="comment">	   If the template should not be called in the named start context,</span><span class="comment">	   look for calls to that template in unexpected contexts.</span><span class="comment">	   Maybe refactor recursive templates to not be recursive.</span></div>
<div class="code"><pre><code>	<a href="../../../pkg/html/template.html#name-ErrOutputContext" class="ident">ErrOutputContext</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ErrPartialCharset: "unfinished JS regexp charset in ..."</span><span class="comment">	 Example:</span><span class="comment">	     &lt;script&gt;var pattern = /foo[{{.Chars}}]/&lt;/script&gt;</span><span class="comment">	 Discussion:</span><span class="comment">	   Package html/template does not support interpolation into regular</span><span class="comment">	   expression literal character sets.</span></div>
<div class="code"><pre><code>	<a href="../../../pkg/html/template.html#name-ErrPartialCharset" class="ident">ErrPartialCharset</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ErrPartialEscape: "unfinished escape sequence in ..."</span><span class="comment">	 Example:</span><span class="comment">	   &lt;script&gt;alert("\{{.X}}")&lt;/script&gt;</span><span class="comment">	 Discussion:</span><span class="comment">	   Package html/template does not support actions following a</span><span class="comment">	   backslash.</span><span class="comment">	   This is usually an error and there are better solutions; for</span><span class="comment">	   example</span><span class="comment">	     &lt;script&gt;alert("{{.X}}")&lt;/script&gt;</span><span class="comment">	   should work, and if {{.X}} is a partial escape sequence such as</span><span class="comment">	   "xA0", mark the whole sequence as safe content: JSStr(`\xA0`)</span></div>
<div class="code"><pre><code>	<a href="../../../pkg/html/template.html#name-ErrPartialEscape" class="ident">ErrPartialEscape</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ErrRangeLoopReentry: "on range loop re-entry: ..."</span><span class="comment">	 Example:</span><span class="comment">	   &lt;script&gt;var x = [{{range .}}'{{.}},{{end}}]&lt;/script&gt;</span><span class="comment">	 Discussion:</span><span class="comment">	   If an iteration through a range would cause it to end in a</span><span class="comment">	   different context than an earlier pass, there is no single context.</span><span class="comment">	   In the example, there is missing a quote, so it is not clear</span><span class="comment">	   whether {{.}} is meant to be inside a JS string or in a JS value</span><span class="comment">	   context. The second iteration would produce something like</span><span class="comment">	</span><span class="comment">	     &lt;script&gt;var x = ['firstValue,'secondValue]&lt;/script&gt;</span></div>
<div class="code"><pre><code>	<a href="../../../pkg/html/template.html#name-ErrRangeLoopReentry" class="ident">ErrRangeLoopReentry</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ErrSlashAmbig: '/' could start a division or regexp.</span><span class="comment">	 Example:</span><span class="comment">	   &lt;script&gt;</span><span class="comment">	     {{if .C}}var x = 1{{end}}</span><span class="comment">	     /-{{.N}}/i.test(x) ? doThis : doThat();</span><span class="comment">	   &lt;/script&gt;</span><span class="comment">	 Discussion:</span><span class="comment">	   The example above could produce `var x = 1/-2/i.test(s)...`</span><span class="comment">	   in which the first '/' is a mathematical division operator or it</span><span class="comment">	   could produce `/-2/i.test(s)` in which the first '/' starts a</span><span class="comment">	   regexp literal.</span><span class="comment">	   Look for missing semicolons inside branches, and maybe add</span><span class="comment">	   parentheses to make it clear which interpretation you intend.</span></div>
<div class="code"><pre><code>	<a href="../../../pkg/html/template.html#name-ErrSlashAmbig" class="ident">ErrSlashAmbig</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ErrPredefinedEscaper: "predefined escaper ... disallowed in template"</span><span class="comment">	 Example:</span><span class="comment">	   &lt;div class={{. | html}}&gt;Hello&lt;div&gt;</span><span class="comment">	 Discussion:</span><span class="comment">	   Package html/template already contextually escapes all pipelines to</span><span class="comment">	   produce HTML output safe against code injection. Manually escaping</span><span class="comment">	   pipeline output using the predefined escapers "html" or "urlquery" is</span><span class="comment">	   unnecessary, and may affect the correctness or safety of the escaped</span><span class="comment">	   pipeline output in Go 1.8 and earlier.</span><span class="comment">	</span><span class="comment">	   In most cases, such as the given example, this error can be resolved by</span><span class="comment">	   simply removing the predefined escaper from the pipeline and letting the</span><span class="comment">	   contextual autoescaper handle the escaping of the pipeline. In other</span><span class="comment">	   instances, where the predefined escaper occurs in the middle of a</span><span class="comment">	   pipeline where subsequent commands expect escaped input, e.g.</span><span class="comment">	     {{.X | html | makeALink}}</span><span class="comment">	   where makeALink does</span><span class="comment">	     return `&lt;a href="`+input+`"&gt;link&lt;/a&gt;`</span><span class="comment">	   consider refactoring the surrounding template to make use of the</span><span class="comment">	   contextual autoescaper, i.e.</span><span class="comment">	     &lt;a href="{{.X}}"&gt;link&lt;/a&gt;</span><span class="comment">	</span><span class="comment">	   To ease migration to Go 1.9 and beyond, "html" and "urlquery" will</span><span class="comment">	   continue to be allowed as the last command in a pipeline. However, if the</span><span class="comment">	   pipeline occurs in an unquoted attribute value context, "html" is</span><span class="comment">	   disallowed. Avoid using "html" and "urlquery" entirely in new templates.</span></div>
<div class="code"><pre><code>	<a href="../../../pkg/html/template.html#name-ErrPredefinedEscaper" class="ident">ErrPredefinedEscaper</a>
)

<span class="keyword">func</span> (<label for="r0" class="ident">e</label> *<a href="#line-13" class="ident">Error</a>) <label for="r1" class="ident"><a href="../../../use/html/template..Error.Error.html" class="ident">Error</a></label>() <a href="../../../pkg/builtin.html#name-string" class="ident">string</a> {
	<span class="keyword">switch</span> {
	<span class="keyword">case</span> <label for="r0" class="ident">e</label>.<a href="#line-18" class="ident">Node</a> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>:
		<label for="r2" class="ident">loc</label>, <label for="r3" class="ident">_</label> := (*<a href="../../../pkg/text/template/parse.html" class="ident i1">parse</a>.<a href="../../text/template/parse/parse.go.html#line-20" class="ident">Tree</a>)(<a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>).<a href="../../text/template/parse/parse.go.html#line-140" class="ident">ErrorContext</a>(<label for="r0" class="ident">e</label>.<a href="#line-18" class="ident">Node</a>)
		<span class="keyword">return</span> <a href="../../../pkg/fmt.html" class="ident i0">fmt</a>.<a href="../../fmt/print.go.html#line-217" class="ident">Sprintf</a>(<span class="lit-string">"html/template:%s: %s"</span>, <label for="r2" class="ident">loc</label>, <label for="r0" class="ident">e</label>.<a href="#line-24" class="ident">Description</a>)
	<span class="keyword">case</span> <label for="r0" class="ident">e</label>.<a href="#line-22" class="ident">Line</a> != <span class="lit-number">0</span>:
		<span class="keyword">return</span> <a href="../../../pkg/fmt.html" class="ident i0">fmt</a>.<a href="../../fmt/print.go.html#line-217" class="ident">Sprintf</a>(<span class="lit-string">"html/template:%s:%d: %s"</span>, <label for="r0" class="ident">e</label>.<a href="#line-20" class="ident">Name</a>, <label for="r0" class="ident">e</label>.<a href="#line-22" class="ident">Line</a>, <label for="r0" class="ident">e</label>.<a href="#line-24" class="ident">Description</a>)
	<span class="keyword">case</span> <label for="r0" class="ident">e</label>.<a href="#line-20" class="ident">Name</a> != <span class="lit-string">""</span>:
		<span class="keyword">return</span> <a href="../../../pkg/fmt.html" class="ident i0">fmt</a>.<a href="../../fmt/print.go.html#line-217" class="ident">Sprintf</a>(<span class="lit-string">"html/template:%s: %s"</span>, <label for="r0" class="ident">e</label>.<a href="#line-20" class="ident">Name</a>, <label for="r0" class="ident">e</label>.<a href="#line-24" class="ident">Description</a>)
	}
	<span class="keyword">return</span> <span class="lit-string">"html/template: "</span> + <label for="r0" class="ident">e</label>.<a href="#line-24" class="ident">Description</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> errorf creates an error given a format string f and args.</span><span class="comment"> The template Name still needs to be supplied.</span></div>
<div class="code"><pre><code><span class="keyword">func</span> <label for="r4" class="ident"><a href="../../../pkg/html/template.html#name-errorf" class="ident">errorf</a></label>(<label for="r5" class="ident">k</label> <a href="#line-28" class="ident">ErrorCode</a>, <label for="r6" class="ident">node</label> <a href="../../../pkg/text/template/parse.html" class="ident i1">parse</a>.<a href="../../text/template/parse/node.go.html#line-20" class="ident">Node</a>, <label for="r7" class="ident">line</label> <a href="../../../pkg/builtin.html#name-int" class="ident">int</a>, <label for="r8" class="ident">f</label> <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>, <label for="r9" class="ident">args</label> ...<span class="keyword">interface</span>{}) *<a href="#line-13" class="ident">Error</a> {
	<span class="keyword">return</span> &amp;<a href="#line-13" class="ident">Error</a>{<label for="r5" class="ident">k</label>, <label for="r6" class="ident">node</label>, <span class="lit-string">""</span>, <label for="r7" class="ident">line</label>, <a href="../../../pkg/fmt.html" class="ident i0">fmt</a>.<a href="../../fmt/print.go.html#line-217" class="ident">Sprintf</a>(<label for="r8" class="ident">f</label>, <label for="r9" class="ident">args</label>...)}
</code></pre></div></div>

</div><pre id="footer">
<table><tr><td><img src="../../../png/go101-twitter.png"></td>
<td>The pages are generated with <a href="https://go101.org/article/tool-golds.html"><b>Golds</b></a> <i>v0.3.2-preview</i>. (GOOS=darwin GOARCH=amd64)
<b>Golds</b> is a <a href="https://go101.org">Go 101</a> project developed by <a href="https://tapirgames.com">Tapir Liu</a>.
PR and bug reports are welcome and can be submitted to <a href="https://github.com/go101/golds">the issue list</a>.
Please follow <a href="https://twitter.com/go100and1">@Go100and1</a> (reachable from the left QR code) to get the latest news of <b>Golds</b>.</td></tr></table></pre>