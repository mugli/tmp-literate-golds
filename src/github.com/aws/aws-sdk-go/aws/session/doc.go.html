<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Source: doc.go in package github.com/aws/aws-sdk-go/aws/session</title>
<link href="../../../../../../css/lightLiterate-v0.3.2-preview.css" rel="stylesheet">
<script src="../../../../../../jvs/golds-v0.3.2-preview.js"></script>
<body onload="onPageLoad()"><div>

<pre id="header"><code><span class="title">Source File</span>
	doc.go

<span class="title">Belonging Package</span>
	<a href="../../../../../../pkg/github.com/aws/aws-sdk-go/aws/session.html">github.com/aws/aws-sdk-go/aws/session</a>
</code></pre>
<div id="container"><div class="section">
<div class="doc">
<span class="comment"></span><span class="comment">Package session provides configuration for the SDK's service clients. Sessions</span><span class="comment">can be shared across service clients that share the same base configuration.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Sessions are safe to use concurrently as long as the Session is not being</span><span class="comment">modified. Sessions should be cached when possible, because creating a new</span><span class="comment">Session will load all configuration values from the environment, and config</span><span class="comment">files each time the Session is created. Sharing the Session value across all of</span><span class="comment">your service clients will ensure the configuration is loaded the fewest number</span><span class="comment">of times possible.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Sessions options from Shared Config</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">By default NewSession will only load credentials from the shared credentials</span><span class="comment">file (~/.aws/credentials). If the AWS_SDK_LOAD_CONFIG environment variable is</span><span class="comment">set to a truthy value the Session will be created from the configuration</span><span class="comment">values from the shared config (~/.aws/config) and shared credentials</span><span class="comment">(~/.aws/credentials) files. Using the NewSessionWithOptions with</span><span class="comment">SharedConfigState set to SharedConfigEnable will create the session as if the</span><span class="comment">AWS_SDK_LOAD_CONFIG environment variable was set.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Credential and config loading order</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">The Session will attempt to load configuration and credentials from the</span><span class="comment">environment, configuration files, and other credential sources. The order</span><span class="comment">configuration is loaded in is:</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">  * Environment Variables</span><span class="comment">  * Shared Credentials file</span><span class="comment">  * Shared Configuration file (if SharedConfig is enabled)</span><span class="comment">  * EC2 Instance Metadata (credentials only)</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">The Environment variables for credentials will have precedence over shared</span><span class="comment">config even if SharedConfig is enabled. To override this behavior, and use</span><span class="comment">shared config credentials instead specify the session.Options.Profile, (e.g.</span><span class="comment">when using credential_source=Environment to assume a role).</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">  sess, err := session.NewSessionWithOptions(session.Options{</span><span class="comment">	  Profile: "myProfile",</span><span class="comment">  })</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Creating Sessions</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Creating a Session without additional options will load credentials region, and</span><span class="comment">profile loaded from the environment and shared config automatically. See,</span><span class="comment">"Environment Variables" section for information on environment variables used</span><span class="comment">by Session.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	 Create Session</span><span class="comment">	sess, err := session.NewSession()</span></div>
<div class="code"><pre><code>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">When creating Sessions optional aws.Config values can be passed in that will</span><span class="comment">override the default, or loaded, config values the Session is being created</span><span class="comment">with. This allows you to provide additional, or case based, configuration</span><span class="comment">as needed.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	 Create a Session with a custom region</span><span class="comment">	sess, err := session.NewSession(&amp;aws.Config{</span><span class="comment">		Region: aws.String("us-west-2"),</span><span class="comment">	})</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Use NewSessionWithOptions to provide additional configuration driving how the</span><span class="comment">Session's configuration will be loaded. Such as, specifying shared config</span><span class="comment">profile, or override the shared config state,  (AWS_SDK_LOAD_CONFIG).</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	 Equivalent to session.NewSession()</span><span class="comment">	sess, err := session.NewSessionWithOptions(session.Options{</span><span class="comment">		 Options</span><span class="comment">	})</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	sess, err := session.NewSessionWithOptions(session.Options{</span><span class="comment">		 Specify profile to load for the session's config</span><span class="comment">		Profile: "profile_name",</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">		 Provide SDK Config options, such as Region.</span><span class="comment">		Config: aws.Config{</span><span class="comment">			Region: aws.String("us-west-2"),</span><span class="comment">		},</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">		 Force enable Shared Config support</span><span class="comment">		SharedConfigState: session.SharedConfigEnable,</span><span class="comment">	})</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Adding Handlers</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">You can add handlers to a session to decorate API operation, (e.g. adding HTTP</span><span class="comment">headers). All clients that use the Session receive a copy of the Session's</span><span class="comment">handlers. For example, the following request handler added to the Session logs</span><span class="comment">every requests made.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	 Create a session, and add additional handlers for all service</span><span class="comment">	 clients created with the Session to inherit. Adds logging handler.</span><span class="comment">	sess := session.Must(session.NewSession())</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	sess.Handlers.Send.PushFront(func(r *request.Request) {</span><span class="comment">		 Log every request made and its payload</span><span class="comment">		logger.Printf("Request: %s/%s, Params: %s",</span><span class="comment">			r.ClientInfo.ServiceName, r.Operation, r.Params)</span><span class="comment">	})</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Shared Config Fields</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">By default the SDK will only load the shared credentials file's</span><span class="comment">(~/.aws/credentials) credentials values, and all other config is provided by</span><span class="comment">the environment variables, SDK defaults, and user provided aws.Config values.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">If the AWS_SDK_LOAD_CONFIG environment variable is set, or SharedConfigEnable</span><span class="comment">option is used to create the Session the full shared config values will be</span><span class="comment">loaded. This includes credentials, region, and support for assume role. In</span><span class="comment">addition the Session will load its configuration from both the shared config</span><span class="comment">file (~/.aws/config) and shared credentials file (~/.aws/credentials). Both</span><span class="comment">files have the same format.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">If both config files are present the configuration from both files will be</span><span class="comment">read. The Session will be created from configuration values from the shared</span><span class="comment">credentials file (~/.aws/credentials) over those in the shared config file</span><span class="comment">(~/.aws/config).</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Credentials are the values the SDK uses to authenticating requests with AWS</span><span class="comment">Services. When specified in a file, both aws_access_key_id and</span><span class="comment">aws_secret_access_key must be provided together in the same file to be</span><span class="comment">considered valid. They will be ignored if both are not present.</span><span class="comment">aws_session_token is an optional field that can be provided in addition to the</span><span class="comment">other two fields.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	aws_access_key_id = AKID</span><span class="comment">	aws_secret_access_key = SECRET</span><span class="comment">	aws_session_token = TOKEN</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	; region only supported if SharedConfigEnabled.</span><span class="comment">	region = us-east-1</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Assume Role configuration</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">The role_arn field allows you to configure the SDK to assume an IAM role using</span><span class="comment">a set of credentials from another source. Such as when paired with static</span><span class="comment">credentials, "profile_source", "credential_process", or "credential_source"</span><span class="comment">fields. If "role_arn" is provided, a source of credentials must also be</span><span class="comment">specified, such as "source_profile", "credential_source", or</span><span class="comment">"credential_process".</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	role_arn = arn:aws:iam::&lt;account_number&gt;:role/&lt;role_name&gt;</span><span class="comment">	source_profile = profile_with_creds</span><span class="comment">	external_id = 1234</span><span class="comment">	mfa_serial = &lt;serial or mfa arn&gt;</span><span class="comment">	role_session_name = session_name</span></div>
<div class="code"><pre><code>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">The SDK supports assuming a role with MFA token. If "mfa_serial" is set, you</span><span class="comment">must also set the Session Option.AssumeRoleTokenProvider. The Session will fail</span><span class="comment">to load if the AssumeRoleTokenProvider is not specified.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">    sess := session.Must(session.NewSessionWithOptions(session.Options{</span><span class="comment">        AssumeRoleTokenProvider: stscreds.StdinTokenProvider,</span><span class="comment">    }))</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">To setup Assume Role outside of a session see the stscreds.AssumeRoleProvider</span><span class="comment">documentation.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Environment Variables</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">When a Session is created several environment variables can be set to adjust</span><span class="comment">how the SDK functions, and what configuration data it loads when creating</span><span class="comment">Sessions. All environment values are optional, but some values like credentials</span><span class="comment">require multiple of the values to set or the partial values will be ignored.</span><span class="comment">All environment variable values are strings unless otherwise noted.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Environment configuration values. If set both Access Key ID and Secret Access</span><span class="comment">Key must be provided. Session Token and optionally also be provided, but is</span><span class="comment">not required.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	# Access Key ID</span><span class="comment">	AWS_ACCESS_KEY_ID=AKID</span><span class="comment">	AWS_ACCESS_KEY=AKID # only read if AWS_ACCESS_KEY_ID is not set.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	# Secret Access Key</span><span class="comment">	AWS_SECRET_ACCESS_KEY=SECRET</span><span class="comment">	AWS_SECRET_KEY=SECRET=SECRET # only read if AWS_SECRET_ACCESS_KEY is not set.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	# Session Token</span><span class="comment">	AWS_SESSION_TOKEN=TOKEN</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Region value will instruct the SDK where to make service API requests to. If is</span><span class="comment">not provided in the environment the region must be provided before a service</span><span class="comment">client request is made.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	AWS_REGION=us-east-1</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	# AWS_DEFAULT_REGION is only read if AWS_SDK_LOAD_CONFIG is also set,</span><span class="comment">	# and AWS_REGION is not also set.</span><span class="comment">	AWS_DEFAULT_REGION=us-east-1</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Profile name the SDK should load use when loading shared config from the</span><span class="comment">configuration files. If not provided "default" will be used as the profile name.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	AWS_PROFILE=my_profile</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	# AWS_DEFAULT_PROFILE is only read if AWS_SDK_LOAD_CONFIG is also set,</span><span class="comment">	# and AWS_PROFILE is not also set.</span><span class="comment">	AWS_DEFAULT_PROFILE=my_profile</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">SDK load config instructs the SDK to load the shared config in addition to</span><span class="comment">shared credentials. This also expands the configuration loaded so the shared</span><span class="comment">credentials will have parity with the shared config file. This also enables</span><span class="comment">Region and Profile support for the AWS_DEFAULT_REGION and AWS_DEFAULT_PROFILE</span><span class="comment">env values as well.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	AWS_SDK_LOAD_CONFIG=1</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Shared credentials file path can be set to instruct the SDK to use an alternative</span><span class="comment">file for the shared credentials. If not set the file will be loaded from</span><span class="comment">$HOME/.aws/credentials on Linux/Unix based systems, and</span><span class="comment">%USERPROFILE%\.aws\credentials on Windows.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	AWS_SHARED_CREDENTIALS_FILE=$HOME/my_shared_credentials</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Shared config file path can be set to instruct the SDK to use an alternative</span><span class="comment">file for the shared config. If not set the file will be loaded from</span><span class="comment">$HOME/.aws/config on Linux/Unix based systems, and</span><span class="comment">%USERPROFILE%\.aws\config on Windows.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	AWS_CONFIG_FILE=$HOME/my_shared_config</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Path to a custom Credentials Authority (CA) bundle PEM file that the SDK</span><span class="comment">will use instead of the default system's root CA bundle. Use this only</span><span class="comment">if you want to replace the CA bundle the SDK uses for TLS requests.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">	AWS_CA_BUNDLE=$HOME/my_custom_ca_bundle</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Enabling this option will attempt to merge the Transport into the SDK's HTTP</span><span class="comment">client. If the client's Transport is not a http.Transport an error will be</span><span class="comment">returned. If the Transport's TLS config is set this option will cause the SDK</span><span class="comment">to overwrite the Transport's TLS config's  RootCAs value. If the CA bundle file</span><span class="comment">contains multiple certificates all of them will be loaded.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">The Session option CustomCABundle is also available when creating sessions</span><span class="comment">to also enable this feature. CustomCABundle session option field has priority</span><span class="comment">over the AWS_CA_BUNDLE environment variable, and will be used if both are set.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Setting a custom HTTPClient in the aws.Config options will override this setting.</span><span class="comment">To use this option and custom HTTP client, the HTTP client needs to be provided</span><span class="comment">when creating the session. Not the service client.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">The endpoint of the EC2 IMDS client can be configured via the environment</span><span class="comment">variable, AWS_EC2_METADATA_SERVICE_ENDPOINT when creating the client with a</span><span class="comment">Session. See Options.EC2IMDSEndpoint for more details.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">  AWS_EC2_METADATA_SERVICE_ENDPOINT=http:169.254.169.254</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">If using an URL with an IPv6 address literal, the IPv6 address</span><span class="comment">component must be enclosed in square brackets.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">  AWS_EC2_METADATA_SERVICE_ENDPOINT=http:[::1]</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">The custom EC2 IMDS endpoint can also be specified via the Session options.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">  sess, err := session.NewSessionWithOptions(session.Options{</span><span class="comment">      EC2IMDSEndpoint: "http:[::1]",</span><span class="comment">  })</span><span class="comment"></span></div>
<div class="code"><pre><code></code></pre></div></div>

</div><pre id="footer">
<table><tr><td><img src="../../../../../../png/go101-twitter.png"></td>
<td>The pages are generated with <a href="https://go101.org/article/tool-golds.html"><b>Golds</b></a> <i>v0.3.2-preview</i>. (GOOS=darwin GOARCH=amd64)
<b>Golds</b> is a <a href="https://go101.org">Go 101</a> project developed by <a href="https://tapirgames.com">Tapir Liu</a>.
PR and bug reports are welcome and can be submitted to <a href="https://github.com/go101/golds">the issue list</a>.
Please follow <a href="https://twitter.com/go100and1">@Go100and1</a> (reachable from the left QR code) to get the latest news of <b>Golds</b>.</td></tr></table></pre>