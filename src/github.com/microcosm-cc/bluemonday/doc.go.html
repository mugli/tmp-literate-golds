<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Source: doc.go in package github.com/microcosm-cc/bluemonday</title>
<link href="../../../../css/lightLiterate-v0.3.2-preview.css" rel="stylesheet">
<script src="../../../../jvs/golds-v0.3.2-preview.js"></script>
<body onload="onPageLoad()"><div>

<pre id="header"><code><span class="title">Source File</span>
	doc.go

<span class="title">Belonging Package</span>
	<a href="../../../../pkg/github.com/microcosm-cc/bluemonday.html">github.com/microcosm-cc/bluemonday</a>
</code></pre>
<div id="container"><div class="section">
<div class="doc">
<span class="comment"> Copyright (c) 2014, David Kitchen &lt;david@buro9.com&gt;</span><span class="comment"></span><span class="comment"> All rights reserved.</span><span class="comment"></span><span class="comment"> Redistribution and use in source and binary forms, with or without</span><span class="comment"> modification, are permitted provided that the following conditions are met:</span><span class="comment"></span><span class="comment"> * Redistributions of source code must retain the above copyright notice, this</span><span class="comment">   list of conditions and the following disclaimer.</span><span class="comment"></span><span class="comment"> * Redistributions in binary form must reproduce the above copyright notice,</span><span class="comment">   this list of conditions and the following disclaimer in the documentation</span><span class="comment">   and/or other materials provided with the distribution.</span><span class="comment"></span><span class="comment"> * Neither the name of the organisation (Microcosm) nor the names of its</span><span class="comment">   contributors may be used to endorse or promote products derived from</span><span class="comment">   this software without specific prior written permission.</span><span class="comment"></span><span class="comment"> THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"</span><span class="comment"> AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span><span class="comment"> IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span><span class="comment"> DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span><span class="comment"> FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span><span class="comment"> DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span><span class="comment"> SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span><span class="comment"> CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span><span class="comment"> OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span><span class="comment"> OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"></span><span class="comment">Package bluemonday provides a way of describing a whitelist of HTML elements</span><span class="comment">and attributes as a policy, and for that policy to be applied to untrusted</span><span class="comment">strings from users that may contain markup. All elements and attributes not on</span><span class="comment">the whitelist will be stripped.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">The default bluemonday.UGCPolicy().Sanitize() turns this:</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">    Hello &lt;STYLE&gt;.XSS{background-image:url("javascript:alert('XSS')");}&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/A&gt;World</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Into the more harmless:</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">    Hello World</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">And it turns this:</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">    &lt;a href="javascript:alert('XSS1')" onmouseover="alert('XSS2')"&gt;XSS&lt;a&gt;</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Into this:</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">    XSS</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Whilst still allowing this:</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">    &lt;a href="http:www.google.com/"&gt;</span><span class="comment">      &lt;img src="https:ssl.gstatic.com/accounts/ui/logo_2x.png"/&gt;</span><span class="comment">    &lt;/a&gt;</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">To pass through mostly unaltered (it gained a rel="nofollow"):</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">    &lt;a href="http:www.google.com/" rel="nofollow"&gt;</span><span class="comment">      &lt;img src="https:ssl.gstatic.com/accounts/ui/logo_2x.png"/&gt;</span><span class="comment">    &lt;/a&gt;</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">The primary purpose of bluemonday is to take potentially unsafe user generated</span><span class="comment">content (from things like Markdown, HTML WYSIWYG tools, etc) and make it safe</span><span class="comment">for you to put on your website.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">It protects sites against XSS (http:en.wikipedia.org/wiki/Cross-site_scripting)</span><span class="comment">and other malicious content that a user interface may deliver. There are many</span><span class="comment">vectors for an XSS attack (https:www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet)</span><span class="comment">and the safest thing to do is to sanitize user input against a known safe list</span><span class="comment">of HTML elements and attributes.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">Note: You should always run bluemonday after any other processing.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">If you use blackfriday (https:github.com/russross/blackfriday) or</span><span class="comment">Pandoc (http:johnmacfarlane.net/pandoc/) then bluemonday should be run after</span><span class="comment">these steps. This ensures that no insecure HTML is introduced later in your</span><span class="comment">process.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">bluemonday is heavily inspired by both the OWASP Java HTML Sanitizer</span><span class="comment">(https:code.google.com/p/owasp-java-html-sanitizer/) and the HTML Purifier</span><span class="comment">(http:htmlpurifier.org/).</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">We ship two default policies, one is bluemonday.StrictPolicy() and can be</span><span class="comment">thought of as equivalent to stripping all HTML elements and their attributes as</span><span class="comment">it has nothing on its whitelist.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">The other is bluemonday.UGCPolicy() and allows a broad selection of HTML</span><span class="comment">elements and attributes that are safe for user generated content. Note that</span><span class="comment">this policy does not whitelist iframes, object, embed, styles, script, etc.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">The essence of building a policy is to determine which HTML elements and</span><span class="comment">attributes are considered safe for your scenario. OWASP provide an XSS</span><span class="comment">prevention cheat sheet ( https:www.google.com/search?q=xss+prevention+cheat+sheet )</span><span class="comment">to help explain the risks, but essentially:</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment">    1. Avoid whitelisting anything other than plain HTML elements</span><span class="comment">    2. Avoid whitelisting `script`, `style`, `iframe`, `object`, `embed`, `base`</span><span class="comment">       elements</span><span class="comment">    3. Avoid whitelisting anything other than plain HTML elements with simple</span><span class="comment">       values that you can match to a regexp</span><span class="comment"></span></div>
<div class="code"><pre><code></code></pre></div></div>

</div><pre id="footer">
<table><tr><td><img src="../../../../png/go101-twitter.png"></td>
<td>The pages are generated with <a href="https://go101.org/article/tool-golds.html"><b>Golds</b></a> <i>v0.3.2-preview</i>. (GOOS=darwin GOARCH=amd64)
<b>Golds</b> is a <a href="https://go101.org">Go 101</a> project developed by <a href="https://tapirgames.com">Tapir Liu</a>.
PR and bug reports are welcome and can be submitted to <a href="https://github.com/go101/golds">the issue list</a>.
Please follow <a href="https://twitter.com/go100and1">@Go100and1</a> (reachable from the left QR code) to get the latest news of <b>Golds</b>.</td></tr></table></pre>