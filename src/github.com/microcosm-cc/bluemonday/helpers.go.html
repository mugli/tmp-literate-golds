<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Source: helpers.go in package github.com/microcosm-cc/bluemonday</title>
<link href="../../../../css/lightLiterate-v0.3.2-preview.css" rel="stylesheet">
<script src="../../../../jvs/golds-v0.3.2-preview.js"></script>
<body onload="onPageLoad()"><div>

<pre id="header"><code><span class="title">Source File</span>
	helpers.go

<span class="title">Belonging Package</span>
	<a href="../../../../pkg/github.com/microcosm-cc/bluemonday.html">github.com/microcosm-cc/bluemonday</a>
</code></pre>
<style>input[type=radio] {display: none;}
input[id=r0]:checked ~pre label[for=r0],
input[id=r1]:checked ~pre label[for=r1],
input[id=r2]:checked ~pre label[for=r2],
input[id=r3]:checked ~pre label[for=r3],
input[id=r4]:checked ~pre label[for=r4],
input[id=r5]:checked ~pre label[for=r5],
input[id=r6]:checked ~pre label[for=r6],
input[id=r7]:checked ~pre label[for=r7],
input[id=r8]:checked ~pre label[for=r8],
input[id=r9]:checked ~pre label[for=r9],
input[id=r10]:checked ~pre label[for=r10],
input[id=r11]:checked ~pre label[for=r11],
input[id=r12]:checked ~pre label[for=r12],
input[id=r13]:checked ~pre label[for=r13],
input[id=r14]:checked ~pre label[for=r14],
input[id=r15]:checked ~pre label[for=r15],
input[id=r16]:checked ~pre label[for=r16],
input[id=r17]:checked ~pre label[for=r17],
input[id=r18]:checked ~pre label[for=r18]
{background: #226; color: #ff8;}
input[id=i0]:checked ~pre .i0,
input[id=i1]:checked ~pre .i1,
input[id=i2]:checked ~pre .i2
{background: brown; color: #eed;}
</style><input id="r0" type="radio" name="g"/>
<input id="r1" type="radio" name="g"/>
<input id="r2" type="radio" name="g"/>
<input id="r3" type="radio" name="g"/>
<input id="r4" type="radio" name="g"/>
<input id="r5" type="radio" name="g"/>
<input id="r6" type="radio" name="g"/>
<input id="r7" type="radio" name="g"/>
<input id="r8" type="radio" name="g"/>
<input id="r9" type="radio" name="g"/>
<input id="r10" type="radio" name="g"/>
<input id="r11" type="radio" name="g"/>
<input id="r12" type="radio" name="g"/>
<input id="r13" type="radio" name="g"/>
<input id="r14" type="radio" name="g"/>
<input id="r15" type="radio" name="g"/>
<input id="r16" type="radio" name="g"/>
<input id="r17" type="radio" name="g"/>
<input id="r18" type="radio" name="g"/>
<input id="i0" type="radio" name="i"/>
<input id="i1" type="radio" name="i"/>
<input id="i2" type="radio" name="i"/>
<div id="container"><div class="section">
<div class="doc">
<span class="comment"> Copyright (c) 2014, David Kitchen &lt;david@buro9.com&gt;</span><span class="comment"></span><span class="comment"> All rights reserved.</span><span class="comment"></span><span class="comment"> Redistribution and use in source and binary forms, with or without</span><span class="comment"> modification, are permitted provided that the following conditions are met:</span><span class="comment"></span><span class="comment"> * Redistributions of source code must retain the above copyright notice, this</span><span class="comment">   list of conditions and the following disclaimer.</span><span class="comment"></span><span class="comment"> * Redistributions in binary form must reproduce the above copyright notice,</span><span class="comment">   this list of conditions and the following disclaimer in the documentation</span><span class="comment">   and/or other materials provided with the distribution.</span><span class="comment"></span><span class="comment"> * Neither the name of the organisation (Microcosm) nor the names of its</span><span class="comment">   contributors may be used to endorse or promote products derived from</span><span class="comment">   this software without specific prior written permission.</span><span class="comment"></span><span class="comment"> THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"</span><span class="comment"> AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span><span class="comment"> IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span><span class="comment"> DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span><span class="comment"> FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span><span class="comment"> DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span><span class="comment"> SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span><span class="comment"> CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span><span class="comment"> OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span><span class="comment"> OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="code"><pre><code>
<span class="keyword">package</span> bluemonday

<span class="keyword">import</span> (
	<label for="i0"><span class="lit-string i0">"encoding/base64"</span></label>
	<label for="i1"><span class="lit-string i1">"net/url"</span></label>
	<label for="i2"><span class="lit-string i2">"regexp"</span></label>
)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> A selection of regular expressions that can be used as .Matching() rules on</span><span class="comment"> HTML attributes.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> CellAlign handles the `align` attribute</span><span class="comment">	 https://developer.mozilla.org/en-US/docs/Web/HTML/Element/td#attr-align</span></div>
<div class="code"><pre><code>	<a href="../../../../pkg/github.com/microcosm-cc/bluemonday.html#name-CellAlign" class="ident">CellAlign</a> = <a href="../../../../pkg/regexp.html" class="ident i2">regexp</a>.<a href="../../../regexp/regexp.go.html#line-308" class="ident">MustCompile</a>(<span class="lit-string">`(?i)^(center|justify|left|right|char)$`</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> CellVerticalAlign handles the `valign` attribute</span><span class="comment">	 https://developer.mozilla.org/en-US/docs/Web/HTML/Element/td#attr-valign</span></div>
<div class="code"><pre><code>	<a href="../../../../pkg/github.com/microcosm-cc/bluemonday.html#name-CellVerticalAlign" class="ident">CellVerticalAlign</a> = <a href="../../../../pkg/regexp.html" class="ident i2">regexp</a>.<a href="../../../regexp/regexp.go.html#line-308" class="ident">MustCompile</a>(<span class="lit-string">`(?i)^(baseline|bottom|middle|top)$`</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Direction handles the `dir` attribute</span><span class="comment">	 https://developer.mozilla.org/en-US/docs/Web/HTML/Element/bdo#attr-dir</span></div>
<div class="code"><pre><code>	<a href="../../../../pkg/github.com/microcosm-cc/bluemonday.html#name-Direction" class="ident">Direction</a> = <a href="../../../../pkg/regexp.html" class="ident i2">regexp</a>.<a href="../../../regexp/regexp.go.html#line-308" class="ident">MustCompile</a>(<span class="lit-string">`(?i)^(rtl|ltr)$`</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ImageAlign handles the `align` attribute on the `image` tag</span><span class="comment">	 http://www.w3.org/MarkUp/Test/Img/imgtest.html</span></div>
<div class="code"><pre><code>	<a href="../../../../pkg/github.com/microcosm-cc/bluemonday.html#name-ImageAlign" class="ident">ImageAlign</a> = <a href="../../../../pkg/regexp.html" class="ident i2">regexp</a>.<a href="../../../regexp/regexp.go.html#line-308" class="ident">MustCompile</a>(
		<span class="lit-string">`(?i)^(left|right|top|texttop|middle|absmiddle|baseline|bottom|absbottom)$`</span>,
	)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Integer describes whole positive integers (including 0) used in places</span><span class="comment">	 like td.colspan</span><span class="comment">	 https://developer.mozilla.org/en-US/docs/Web/HTML/Element/td#attr-colspan</span></div>
<div class="code"><pre><code>	<a href="../../../../pkg/github.com/microcosm-cc/bluemonday.html#name-Integer" class="ident">Integer</a> = <a href="../../../../pkg/regexp.html" class="ident i2">regexp</a>.<a href="../../../regexp/regexp.go.html#line-308" class="ident">MustCompile</a>(<span class="lit-string">`^[0-9]+$`</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ISO8601 according to the W3 group is only a subset of the ISO8601</span><span class="comment">	 standard: http://www.w3.org/TR/NOTE-datetime</span><span class="comment">	</span><span class="comment">	 Used in places like time.datetime</span><span class="comment">	 https://developer.mozilla.org/en-US/docs/Web/HTML/Element/time#attr-datetime</span><span class="comment">	</span><span class="comment">	 Matches patterns:</span><span class="comment">	  Year:</span><span class="comment">	     YYYY (eg 1997)</span><span class="comment">	  Year and month:</span><span class="comment">	     YYYY-MM (eg 1997-07)</span><span class="comment">	  Complete date:</span><span class="comment">	     YYYY-MM-DD (eg 1997-07-16)</span><span class="comment">	  Complete date plus hours and minutes:</span><span class="comment">	     YYYY-MM-DDThh:mmTZD (eg 1997-07-16T19:20+01:00)</span><span class="comment">	  Complete date plus hours, minutes and seconds:</span><span class="comment">	     YYYY-MM-DDThh:mm:ssTZD (eg 1997-07-16T19:20:30+01:00)</span><span class="comment">	  Complete date plus hours, minutes, seconds and a decimal fraction of a</span><span class="comment">	  second</span><span class="comment">	      YYYY-MM-DDThh:mm:ss.sTZD (eg 1997-07-16T19:20:30.45+01:00)</span></div>
<div class="code"><pre><code>	<a href="../../../../pkg/github.com/microcosm-cc/bluemonday.html#name-ISO8601" class="ident">ISO8601</a> = <a href="../../../../pkg/regexp.html" class="ident i2">regexp</a>.<a href="../../../regexp/regexp.go.html#line-308" class="ident">MustCompile</a>(
		<span class="lit-string">`^[0-9]{4}(-[0-9]{2}(-[0-9]{2}([ T][0-9]{2}(:[0-9]{2}){1,2}(.[0-9]{1,6})`</span> +
			<span class="lit-string">`?Z?([\+-][0-9]{2}:[0-9]{2})?)?)?)?$`</span>,
	)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ListType encapsulates the common value as well as the latest spec</span><span class="comment">	 values for lists</span><span class="comment">	 https://developer.mozilla.org/en-US/docs/Web/HTML/Element/ol#attr-type</span></div>
<div class="code"><pre><code>	<a href="../../../../pkg/github.com/microcosm-cc/bluemonday.html#name-ListType" class="ident">ListType</a> = <a href="../../../../pkg/regexp.html" class="ident i2">regexp</a>.<a href="../../../regexp/regexp.go.html#line-308" class="ident">MustCompile</a>(<span class="lit-string">`(?i)^(circle|disc|square|a|A|i|I|1)$`</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> SpaceSeparatedTokens is used in places like `a.rel` and the common attribute</span><span class="comment">	 `class` which both contain space delimited lists of data tokens</span><span class="comment">	 http://www.w3.org/TR/html-markup/datatypes.html#common.data.tokens-def</span><span class="comment">	 Regexp: \p{L} matches unicode letters, \p{N} matches unicode numbers</span></div>
<div class="code"><pre><code>	<a href="../../../../pkg/github.com/microcosm-cc/bluemonday.html#name-SpaceSeparatedTokens" class="ident">SpaceSeparatedTokens</a> = <a href="../../../../pkg/regexp.html" class="ident i2">regexp</a>.<a href="../../../regexp/regexp.go.html#line-308" class="ident">MustCompile</a>(<span class="lit-string">`^([\s\p{L}\p{N}_-]+)$`</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Number is a double value used on HTML5 meter and progress elements</span><span class="comment">	 http://www.whatwg.org/specs/web-apps/current-work/multipage/the-button-element.html#the-meter-element</span></div>
<div class="code"><pre><code>	<a href="../../../../pkg/github.com/microcosm-cc/bluemonday.html#name-Number" class="ident">Number</a> = <a href="../../../../pkg/regexp.html" class="ident i2">regexp</a>.<a href="../../../regexp/regexp.go.html#line-308" class="ident">MustCompile</a>(<span class="lit-string">`^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?$`</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> NumberOrPercent is used predominantly as units of measurement in width</span><span class="comment">	 and height attributes</span><span class="comment">	 https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-height</span></div>
<div class="code"><pre><code>	<a href="../../../../pkg/github.com/microcosm-cc/bluemonday.html#name-NumberOrPercent" class="ident">NumberOrPercent</a> = <a href="../../../../pkg/regexp.html" class="ident i2">regexp</a>.<a href="../../../regexp/regexp.go.html#line-308" class="ident">MustCompile</a>(<span class="lit-string">`^[0-9]+[%]?$`</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Paragraph of text in an attribute such as *.'title', img.alt, etc</span><span class="comment">	 https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes#attr-title</span><span class="comment">	 Note that we are not allowing chars that could close tags like '&gt;'</span></div>
<div class="code"><pre><code>	<a href="../../../../pkg/github.com/microcosm-cc/bluemonday.html#name-Paragraph" class="ident">Paragraph</a> = <a href="../../../../pkg/regexp.html" class="ident i2">regexp</a>.<a href="../../../regexp/regexp.go.html#line-308" class="ident">MustCompile</a>(<span class="lit-string">`^[\p{L}\p{N}\s\-_',\[\]!\./\\\(\)]*$`</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> dataURIImagePrefix is used by AllowDataURIImages to define the acceptable</span><span class="comment">	 prefix of data URIs that contain common web image formats.</span><span class="comment">	</span><span class="comment">	 This is not exported as it's not useful by itself, and only has value</span><span class="comment">	 within the AllowDataURIImages func</span></div>
<div class="code"><pre><code>	<a href="../../../../pkg/github.com/microcosm-cc/bluemonday.html#name-dataURIImagePrefix" class="ident">dataURIImagePrefix</a> = <a href="../../../../pkg/regexp.html" class="ident i2">regexp</a>.<a href="../../../regexp/regexp.go.html#line-308" class="ident">MustCompile</a>(
		<span class="lit-string">`^image/(gif|jpeg|png|webp);base64,`</span>,
	)
)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> AllowStandardURLs is a convenience function that will enable rel="nofollow"</span><span class="comment"> on "a", "area" and "link" (if you have allowed those elements) and will</span><span class="comment"> ensure that the URL values are parseable and either relative or belong to the</span><span class="comment"> "mailto", "http", or "https" schemes</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> URLs must be parseable by net/url.Parse()</span></div>
<div class="code"><pre><code>	<label for="r0" class="ident">p</label>.<a href="policy.go.html#line-332" class="ident">RequireParseableURLs</a>(<a href="../../../../pkg/builtin.html#name-true" class="ident">true</a>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> !url.IsAbs() is permitted</span></div>
<div class="code"><pre><code>	<label for="r0" class="ident">p</label>.<a href="policy.go.html#line-342" class="ident">AllowRelativeURLs</a>(<a href="../../../../pkg/builtin.html#name-true" class="ident">true</a>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Most common URL schemes only</span></div>
<div class="code"><pre><code>	<label for="r0" class="ident">p</label>.<a href="policy.go.html#line-352" class="ident">AllowURLSchemes</a>(<span class="lit-string">"mailto"</span>, <span class="lit-string">"http"</span>, <span class="lit-string">"https"</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> For all anchors we will add rel="nofollow" if it does not already exist</span><span class="comment">	 This applies to "a" "area" "link"</span></div>
<div class="code"><pre><code>	<label for="r0" class="ident">p</label>.<a href="policy.go.html#line-289" class="ident">RequireNoFollowOnLinks</a>(<a href="../../../../pkg/builtin.html#name-true" class="ident">true</a>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> AllowStandardAttributes will enable "id", "title" and the language specific</span><span class="comment"> attributes "dir" and "lang" on all elements that are whitelisted</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> "dir" "lang" are permitted as both language attributes affect charsets</span><span class="comment">	 and direction of text.</span></div>
<div class="code"><pre><code>	<label for="r2" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"dir"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-51" class="ident">Direction</a>).<a href="policy.go.html#line-250" class="ident">Globally</a>()
	<label for="r2" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(
		<span class="lit-string">"lang"</span>,
	).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="../../../../pkg/regexp.html" class="ident i2">regexp</a>.<a href="../../../regexp/regexp.go.html#line-308" class="ident">MustCompile</a>(<span class="lit-string">`[a-zA-Z]{2,20}`</span>)).<a href="policy.go.html#line-250" class="ident">Globally</a>()
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> "id" is permitted. This is pretty much as some HTML elements require this</span><span class="comment">	 to work well ("dfn" is an example of a "id" being value)</span><span class="comment">	 This does create a risk that JavaScript and CSS within your web page</span><span class="comment">	 might identify the wrong elements. Ensure that you select things</span><span class="comment">	 accurately</span></div>
<div class="code"><pre><code>	<label for="r2" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"id"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(
		<a href="../../../../pkg/regexp.html" class="ident i2">regexp</a>.<a href="../../../regexp/regexp.go.html#line-308" class="ident">MustCompile</a>(<span class="lit-string">`[a-zA-Z0-9\:\-_\.]+`</span>),
	).<a href="policy.go.html#line-250" class="ident">Globally</a>()
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> "title" is permitted as it improves accessibility.</span></div>
<div class="code"><pre><code>	<label for="r2" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"title"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-112" class="ident">Paragraph</a>).<a href="policy.go.html#line-250" class="ident">Globally</a>()
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> AllowStyling presently enables the class attribute globally.</span><span class="comment"></span><span class="comment"> Note: When bluemonday ships a CSS parser and we can safely sanitise that,</span><span class="comment"> this will also allow sanitized styling of elements via the style attribute.</span></div>
<div class="code"><pre><code><span class="keyword">func</span> (<label for="r4" class="ident">p</label> *<a href="policy.go.html#line-43" class="ident">Policy</a>) <label for="r5" class="ident"><a href="../../../../use/github.com/microcosm-cc/bluemonday..Policy.AllowStyling.html" class="ident">AllowStyling</a></label>() {
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> "class" is permitted globally</span></div>
<div class="code"><pre><code>	<label for="r4" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"class"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-98" class="ident">SpaceSeparatedTokens</a>).<a href="policy.go.html#line-250" class="ident">Globally</a>()
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> AllowImages enables the img element and some popular attributes. It will also</span><span class="comment"> ensure that URL values are parseable. This helper does not enable data URI</span><span class="comment"> images, for that you should also use the AllowDataURIImages() helper.</span></div>
<div class="code"><pre><code><span class="keyword">func</span> (<label for="r6" class="ident">p</label> *<a href="policy.go.html#line-43" class="ident">Policy</a>) <label for="r7" class="ident"><a href="../../../../use/github.com/microcosm-cc/bluemonday..Policy.AllowImages.html" class="ident">AllowImages</a></label>() {
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> "img" is permitted</span></div>
<div class="code"><pre><code>	<label for="r6" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"align"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-55" class="ident">ImageAlign</a>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"img"</span>)
	<label for="r6" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"alt"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-112" class="ident">Paragraph</a>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"img"</span>)
	<label for="r6" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"height"</span>, <span class="lit-string">"width"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-107" class="ident">NumberOrPercent</a>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"img"</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Standard URLs enabled</span></div>
<div class="code"><pre><code>	<label for="r6" class="ident">p</label>.<a href="#line-128" class="ident">AllowStandardURLs</a>()
	<label for="r6" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"src"</span>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"img"</span>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> AllowDataURIImages permits the use of inline images defined in RFC2397</span><span class="comment"> http://tools.ietf.org/html/rfc2397</span><span class="comment"> http://en.wikipedia.org/wiki/Data_URI_scheme</span><span class="comment"></span><span class="comment"> Images must have a mimetype matching:</span><span class="comment">   image/gif</span><span class="comment">   image/jpeg</span><span class="comment">   image/png</span><span class="comment">   image/webp</span><span class="comment"></span><span class="comment"> NOTE: There is a potential security risk to allowing data URIs and you should</span><span class="comment"> only permit them on content you already trust.</span><span class="comment"> http://palizine.plynt.com/issues/2010Oct/bypass-xss-filters/</span><span class="comment"> https://capec.mitre.org/data/definitions/244.html</span></div>
<div class="code"><pre><code><span class="keyword">func</span> (<label for="r8" class="ident">p</label> *<a href="policy.go.html#line-43" class="ident">Policy</a>) <label for="r9" class="ident"><a href="../../../../use/github.com/microcosm-cc/bluemonday..Policy.AllowDataURIImages.html" class="ident">AllowDataURIImages</a></label>() {
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> URLs must be parseable by net/url.Parse()</span></div>
<div class="code"><pre><code>	<label for="r8" class="ident">p</label>.<a href="policy.go.html#line-332" class="ident">RequireParseableURLs</a>(<a href="../../../../pkg/builtin.html#name-true" class="ident">true</a>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Supply a function to validate images contained within data URI</span></div>
<div class="code"><pre><code>	<label for="r8" class="ident">p</label>.<a href="policy.go.html#line-371" class="ident">AllowURLSchemeWithCustomPolicy</a>(
		<span class="lit-string">"data"</span>,
		<span class="keyword">func</span>(<label for="r10" class="ident">url</label> *<a href="../../../../pkg/net/url.html" class="ident i1">url</a>.<a href="../../../net/url/url.go.html#line-358" class="ident">URL</a>) (<label for="r11" class="ident">allowUrl</label> <a href="../../../../pkg/builtin.html#name-bool" class="ident">bool</a>) {
			<span class="keyword">if</span> <label for="r10" class="ident">url</label>.<a href="../../../net/url/url.go.html#line-366" class="ident">RawQuery</a> != <span class="lit-string">""</span> || <label for="r10" class="ident">url</label>.<a href="../../../net/url/url.go.html#line-367" class="ident">Fragment</a> != <span class="lit-string">""</span> {
				<span class="keyword">return</span> <a href="../../../../pkg/builtin.html#name-false" class="ident">false</a>
			}

			<label for="r12" class="ident">matched</label> := <a href="#line-119" class="ident">dataURIImagePrefix</a>.<a href="../../../regexp/regexp.go.html#line-841" class="ident">FindString</a>(<label for="r10" class="ident">url</label>.<a href="../../../net/url/url.go.html#line-360" class="ident">Opaque</a>)
			<span class="keyword">if</span> <label for="r12" class="ident">matched</label> == <span class="lit-string">""</span> {
				<span class="keyword">return</span> <a href="../../../../pkg/builtin.html#name-false" class="ident">false</a>
			}

			<label for="r13" class="ident">_</label>, <label for="r14" class="ident">err</label> := <a href="../../../../pkg/encoding/base64.html" class="ident i0">base64</a>.<a href="../../../encoding/base64/base64.go.html#line-99" class="ident">StdEncoding</a>.<a href="../../../encoding/base64/base64.go.html#line-383" class="ident">DecodeString</a>(<label for="r10" class="ident">url</label>.<a href="../../../net/url/url.go.html#line-360" class="ident">Opaque</a>[<a href="../../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r12" class="ident">matched</label>):])
			<span class="keyword">if</span> <label for="r14" class="ident">err</label> != <a href="../../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
				<span class="keyword">return</span> <a href="../../../../pkg/builtin.html#name-false" class="ident">false</a>
			}

			<span class="keyword">return</span> <a href="../../../../pkg/builtin.html#name-true" class="ident">true</a>
		},
	)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> AllowLists will enabled ordered and unordered lists, as well as definition</span><span class="comment"> lists</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> "ol" "ul" are permitted</span></div>
<div class="code"><pre><code>	<label for="r15" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"type"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-92" class="ident">ListType</a>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"ol"</span>, <span class="lit-string">"ul"</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> "li" is permitted</span></div>
<div class="code"><pre><code>	<label for="r15" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"type"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-92" class="ident">ListType</a>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"li"</span>)
	<label for="r15" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"value"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-62" class="ident">Integer</a>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"li"</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> "dl" "dt" "dd" are permitted</span></div>
<div class="code"><pre><code>	<label for="r15" class="ident">p</label>.<a href="policy.go.html#line-271" class="ident">AllowElements</a>(<span class="lit-string">"dl"</span>, <span class="lit-string">"dt"</span>, <span class="lit-string">"dd"</span>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> AllowTables will enable a rich set of elements and attributes to describe</span><span class="comment"> HTML tables</span></div>
<div class="code"><pre><code><span class="keyword">func</span> (<label for="r17" class="ident">p</label> *<a href="policy.go.html#line-43" class="ident">Policy</a>) <label for="r18" class="ident"><a href="../../../../use/github.com/microcosm-cc/bluemonday..Policy.AllowTables.html" class="ident">AllowTables</a></label>() {
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> "table" is permitted</span></div>
<div class="code"><pre><code>	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"height"</span>, <span class="lit-string">"width"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-107" class="ident">NumberOrPercent</a>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"table"</span>)
	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"summary"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-112" class="ident">Paragraph</a>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"table"</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> "caption" is permitted</span></div>
<div class="code"><pre><code>	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-271" class="ident">AllowElements</a>(<span class="lit-string">"caption"</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> "col" "colgroup" are permitted</span></div>
<div class="code"><pre><code>	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"align"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-43" class="ident">CellAlign</a>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"col"</span>, <span class="lit-string">"colgroup"</span>)
	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"height"</span>, <span class="lit-string">"width"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(
		<a href="#line-107" class="ident">NumberOrPercent</a>,
	).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"col"</span>, <span class="lit-string">"colgroup"</span>)
	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"span"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-62" class="ident">Integer</a>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"colgroup"</span>, <span class="lit-string">"col"</span>)
	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"valign"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(
		<a href="#line-47" class="ident">CellVerticalAlign</a>,
	).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"col"</span>, <span class="lit-string">"colgroup"</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> "thead" "tr" are permitted</span></div>
<div class="code"><pre><code>	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"align"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-43" class="ident">CellAlign</a>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"thead"</span>, <span class="lit-string">"tr"</span>)
	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"valign"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-47" class="ident">CellVerticalAlign</a>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"thead"</span>, <span class="lit-string">"tr"</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> "td" "th" are permitted</span></div>
<div class="code"><pre><code>	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"abbr"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-112" class="ident">Paragraph</a>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"td"</span>, <span class="lit-string">"th"</span>)
	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"align"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-43" class="ident">CellAlign</a>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"td"</span>, <span class="lit-string">"th"</span>)
	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"colspan"</span>, <span class="lit-string">"rowspan"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-62" class="ident">Integer</a>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"td"</span>, <span class="lit-string">"th"</span>)
	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"headers"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(
		<a href="#line-98" class="ident">SpaceSeparatedTokens</a>,
	).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"td"</span>, <span class="lit-string">"th"</span>)
	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"height"</span>, <span class="lit-string">"width"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(
		<a href="#line-107" class="ident">NumberOrPercent</a>,
	).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"td"</span>, <span class="lit-string">"th"</span>)
	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(
		<span class="lit-string">"scope"</span>,
	).<a href="policy.go.html#line-208" class="ident">Matching</a>(
		<a href="../../../../pkg/regexp.html" class="ident i2">regexp</a>.<a href="../../../regexp/regexp.go.html#line-308" class="ident">MustCompile</a>(<span class="lit-string">`(?i)(?:row|col)(?:group)?`</span>),
	).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"td"</span>, <span class="lit-string">"th"</span>)
	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"valign"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-47" class="ident">CellVerticalAlign</a>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"td"</span>, <span class="lit-string">"th"</span>)
	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"nowrap"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(
		<a href="../../../../pkg/regexp.html" class="ident i2">regexp</a>.<a href="../../../regexp/regexp.go.html#line-308" class="ident">MustCompile</a>(<span class="lit-string">`(?i)|nowrap`</span>),
	).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"td"</span>, <span class="lit-string">"th"</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> "tbody" "tfoot"</span></div>
<div class="code"><pre><code>	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"align"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(<a href="#line-43" class="ident">CellAlign</a>).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"tbody"</span>, <span class="lit-string">"tfoot"</span>)
	<label for="r17" class="ident">p</label>.<a href="policy.go.html#line-148" class="ident">AllowAttrs</a>(<span class="lit-string">"valign"</span>).<a href="policy.go.html#line-208" class="ident">Matching</a>(
		<a href="#line-47" class="ident">CellVerticalAlign</a>,
	).<a href="policy.go.html#line-217" class="ident">OnElements</a>(<span class="lit-string">"tbody"</span>, <span class="lit-string">"tfoot"</span>)
</code></pre></div></div>

</div><pre id="footer">
<table><tr><td><img src="../../../../png/go101-twitter.png"></td>
<td>The pages are generated with <a href="https://go101.org/article/tool-golds.html"><b>Golds</b></a> <i>v0.3.2-preview</i>. (GOOS=darwin GOARCH=amd64)
<b>Golds</b> is a <a href="https://go101.org">Go 101</a> project developed by <a href="https://tapirgames.com">Tapir Liu</a>.
PR and bug reports are welcome and can be submitted to <a href="https://github.com/go101/golds">the issue list</a>.
Please follow <a href="https://twitter.com/go100and1">@Go100and1</a> (reachable from the left QR code) to get the latest news of <b>Golds</b>.</td></tr></table></pre>