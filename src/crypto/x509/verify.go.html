<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Source: verify.go in package crypto/x509</title>
<link href="../../../css/lightLiterate-v0.3.2-preview.css" rel="stylesheet">
<script src="../../../jvs/golds-v0.3.2-preview.js"></script>
<body onload="onPageLoad()"><div>

<pre id="header"><code><span class="title">Source File</span>
	verify.go

<span class="title">Belonging Package</span>
	<a href="../../../pkg/crypto/x509.html">crypto/x509</a>
</code></pre>
<style>input[type=radio] {display: none;}
input[id=r0]:checked ~pre label[for=r0],
input[id=r1]:checked ~pre label[for=r1],
input[id=r2]:checked ~pre label[for=r2],
input[id=r3]:checked ~pre label[for=r3],
input[id=r4]:checked ~pre label[for=r4],
input[id=r5]:checked ~pre label[for=r5],
input[id=r6]:checked ~pre label[for=r6],
input[id=r7]:checked ~pre label[for=r7],
input[id=r8]:checked ~pre label[for=r8],
input[id=r9]:checked ~pre label[for=r9],
input[id=r10]:checked ~pre label[for=r10],
input[id=r11]:checked ~pre label[for=r11],
input[id=r12]:checked ~pre label[for=r12],
input[id=r13]:checked ~pre label[for=r13],
input[id=r14]:checked ~pre label[for=r14],
input[id=r15]:checked ~pre label[for=r15],
input[id=r16]:checked ~pre label[for=r16],
input[id=r17]:checked ~pre label[for=r17],
input[id=r18]:checked ~pre label[for=r18],
input[id=r19]:checked ~pre label[for=r19],
input[id=r20]:checked ~pre label[for=r20],
input[id=r21]:checked ~pre label[for=r21],
input[id=r22]:checked ~pre label[for=r22],
input[id=r23]:checked ~pre label[for=r23],
input[id=r24]:checked ~pre label[for=r24],
input[id=r25]:checked ~pre label[for=r25],
input[id=r26]:checked ~pre label[for=r26],
input[id=r27]:checked ~pre label[for=r27],
input[id=r28]:checked ~pre label[for=r28],
input[id=r29]:checked ~pre label[for=r29],
input[id=r30]:checked ~pre label[for=r30],
input[id=r31]:checked ~pre label[for=r31],
input[id=r32]:checked ~pre label[for=r32],
input[id=r33]:checked ~pre label[for=r33],
input[id=r34]:checked ~pre label[for=r34],
input[id=r35]:checked ~pre label[for=r35],
input[id=r36]:checked ~pre label[for=r36],
input[id=r37]:checked ~pre label[for=r37],
input[id=r38]:checked ~pre label[for=r38],
input[id=r39]:checked ~pre label[for=r39],
input[id=r40]:checked ~pre label[for=r40],
input[id=r41]:checked ~pre label[for=r41],
input[id=r42]:checked ~pre label[for=r42],
input[id=r43]:checked ~pre label[for=r43],
input[id=r44]:checked ~pre label[for=r44],
input[id=r45]:checked ~pre label[for=r45],
input[id=r46]:checked ~pre label[for=r46],
input[id=r47]:checked ~pre label[for=r47],
input[id=r48]:checked ~pre label[for=r48],
input[id=r49]:checked ~pre label[for=r49],
input[id=r50]:checked ~pre label[for=r50],
input[id=r51]:checked ~pre label[for=r51],
input[id=r52]:checked ~pre label[for=r52],
input[id=r53]:checked ~pre label[for=r53],
input[id=r54]:checked ~pre label[for=r54],
input[id=r55]:checked ~pre label[for=r55],
input[id=r56]:checked ~pre label[for=r56],
input[id=r57]:checked ~pre label[for=r57],
input[id=r58]:checked ~pre label[for=r58],
input[id=r59]:checked ~pre label[for=r59],
input[id=r60]:checked ~pre label[for=r60],
input[id=r61]:checked ~pre label[for=r61],
input[id=r62]:checked ~pre label[for=r62],
input[id=r63]:checked ~pre label[for=r63],
input[id=r64]:checked ~pre label[for=r64],
input[id=r65]:checked ~pre label[for=r65],
input[id=r66]:checked ~pre label[for=r66],
input[id=r67]:checked ~pre label[for=r67],
input[id=r68]:checked ~pre label[for=r68],
input[id=r69]:checked ~pre label[for=r69],
input[id=r70]:checked ~pre label[for=r70],
input[id=r71]:checked ~pre label[for=r71],
input[id=r72]:checked ~pre label[for=r72],
input[id=r73]:checked ~pre label[for=r73],
input[id=r74]:checked ~pre label[for=r74],
input[id=r75]:checked ~pre label[for=r75],
input[id=r76]:checked ~pre label[for=r76],
input[id=r77]:checked ~pre label[for=r77],
input[id=r78]:checked ~pre label[for=r78],
input[id=r79]:checked ~pre label[for=r79],
input[id=r80]:checked ~pre label[for=r80],
input[id=r81]:checked ~pre label[for=r81],
input[id=r82]:checked ~pre label[for=r82],
input[id=r83]:checked ~pre label[for=r83],
input[id=r84]:checked ~pre label[for=r84],
input[id=r85]:checked ~pre label[for=r85],
input[id=r86]:checked ~pre label[for=r86],
input[id=r87]:checked ~pre label[for=r87],
input[id=r88]:checked ~pre label[for=r88],
input[id=r89]:checked ~pre label[for=r89],
input[id=r90]:checked ~pre label[for=r90],
input[id=r91]:checked ~pre label[for=r91],
input[id=r92]:checked ~pre label[for=r92],
input[id=r93]:checked ~pre label[for=r93],
input[id=r94]:checked ~pre label[for=r94],
input[id=r95]:checked ~pre label[for=r95],
input[id=r96]:checked ~pre label[for=r96],
input[id=r97]:checked ~pre label[for=r97],
input[id=r98]:checked ~pre label[for=r98],
input[id=r99]:checked ~pre label[for=r99],
input[id=r100]:checked ~pre label[for=r100],
input[id=r101]:checked ~pre label[for=r101],
input[id=r102]:checked ~pre label[for=r102],
input[id=r103]:checked ~pre label[for=r103],
input[id=r104]:checked ~pre label[for=r104],
input[id=r105]:checked ~pre label[for=r105],
input[id=r106]:checked ~pre label[for=r106],
input[id=r107]:checked ~pre label[for=r107],
input[id=r108]:checked ~pre label[for=r108],
input[id=r109]:checked ~pre label[for=r109],
input[id=r110]:checked ~pre label[for=r110],
input[id=r111]:checked ~pre label[for=r111],
input[id=r112]:checked ~pre label[for=r112],
input[id=r113]:checked ~pre label[for=r113],
input[id=r114]:checked ~pre label[for=r114],
input[id=r115]:checked ~pre label[for=r115],
input[id=r116]:checked ~pre label[for=r116],
input[id=r117]:checked ~pre label[for=r117],
input[id=r118]:checked ~pre label[for=r118],
input[id=r119]:checked ~pre label[for=r119],
input[id=r120]:checked ~pre label[for=r120],
input[id=r121]:checked ~pre label[for=r121],
input[id=r122]:checked ~pre label[for=r122],
input[id=r123]:checked ~pre label[for=r123],
input[id=r124]:checked ~pre label[for=r124],
input[id=r125]:checked ~pre label[for=r125],
input[id=r126]:checked ~pre label[for=r126],
input[id=r127]:checked ~pre label[for=r127],
input[id=r128]:checked ~pre label[for=r128],
input[id=r129]:checked ~pre label[for=r129],
input[id=r130]:checked ~pre label[for=r130],
input[id=r131]:checked ~pre label[for=r131],
input[id=r132]:checked ~pre label[for=r132],
input[id=r133]:checked ~pre label[for=r133],
input[id=r134]:checked ~pre label[for=r134],
input[id=r135]:checked ~pre label[for=r135],
input[id=r136]:checked ~pre label[for=r136],
input[id=r137]:checked ~pre label[for=r137],
input[id=r138]:checked ~pre label[for=r138],
input[id=r139]:checked ~pre label[for=r139],
input[id=r140]:checked ~pre label[for=r140],
input[id=r141]:checked ~pre label[for=r141],
input[id=r142]:checked ~pre label[for=r142],
input[id=r143]:checked ~pre label[for=r143],
input[id=r144]:checked ~pre label[for=r144],
input[id=r145]:checked ~pre label[for=r145],
input[id=r146]:checked ~pre label[for=r146],
input[id=r147]:checked ~pre label[for=r147],
input[id=r148]:checked ~pre label[for=r148],
input[id=r149]:checked ~pre label[for=r149],
input[id=r150]:checked ~pre label[for=r150],
input[id=r151]:checked ~pre label[for=r151],
input[id=r152]:checked ~pre label[for=r152],
input[id=r153]:checked ~pre label[for=r153],
input[id=r154]:checked ~pre label[for=r154],
input[id=r155]:checked ~pre label[for=r155],
input[id=r156]:checked ~pre label[for=r156],
input[id=r157]:checked ~pre label[for=r157],
input[id=r158]:checked ~pre label[for=r158],
input[id=r159]:checked ~pre label[for=r159],
input[id=r160]:checked ~pre label[for=r160],
input[id=r161]:checked ~pre label[for=r161],
input[id=r162]:checked ~pre label[for=r162],
input[id=r163]:checked ~pre label[for=r163],
input[id=r164]:checked ~pre label[for=r164],
input[id=r165]:checked ~pre label[for=r165],
input[id=r166]:checked ~pre label[for=r166],
input[id=r167]:checked ~pre label[for=r167],
input[id=r168]:checked ~pre label[for=r168],
input[id=r169]:checked ~pre label[for=r169],
input[id=r170]:checked ~pre label[for=r170],
input[id=r171]:checked ~pre label[for=r171],
input[id=r172]:checked ~pre label[for=r172],
input[id=r173]:checked ~pre label[for=r173],
input[id=r174]:checked ~pre label[for=r174],
input[id=r175]:checked ~pre label[for=r175],
input[id=r176]:checked ~pre label[for=r176],
input[id=r177]:checked ~pre label[for=r177],
input[id=r178]:checked ~pre label[for=r178],
input[id=r179]:checked ~pre label[for=r179],
input[id=r180]:checked ~pre label[for=r180],
input[id=r181]:checked ~pre label[for=r181],
input[id=r182]:checked ~pre label[for=r182],
input[id=r183]:checked ~pre label[for=r183],
input[id=r184]:checked ~pre label[for=r184],
input[id=r185]:checked ~pre label[for=r185],
input[id=r186]:checked ~pre label[for=r186],
input[id=r187]:checked ~pre label[for=r187],
input[id=r188]:checked ~pre label[for=r188],
input[id=r189]:checked ~pre label[for=r189],
input[id=r190]:checked ~pre label[for=r190],
input[id=r191]:checked ~pre label[for=r191],
input[id=r192]:checked ~pre label[for=r192],
input[id=r193]:checked ~pre label[for=r193],
input[id=r194]:checked ~pre label[for=r194],
input[id=r195]:checked ~pre label[for=r195],
input[id=r196]:checked ~pre label[for=r196],
input[id=r197]:checked ~pre label[for=r197],
input[id=r198]:checked ~pre label[for=r198],
input[id=r199]:checked ~pre label[for=r199],
input[id=r200]:checked ~pre label[for=r200],
input[id=r201]:checked ~pre label[for=r201],
input[id=r202]:checked ~pre label[for=r202],
input[id=r203]:checked ~pre label[for=r203],
input[id=r204]:checked ~pre label[for=r204],
input[id=r205]:checked ~pre label[for=r205],
input[id=r206]:checked ~pre label[for=r206],
input[id=r207]:checked ~pre label[for=r207],
input[id=r208]:checked ~pre label[for=r208],
input[id=r209]:checked ~pre label[for=r209],
input[id=r210]:checked ~pre label[for=r210],
input[id=r211]:checked ~pre label[for=r211],
input[id=r212]:checked ~pre label[for=r212],
input[id=r213]:checked ~pre label[for=r213],
input[id=r214]:checked ~pre label[for=r214],
input[id=r215]:checked ~pre label[for=r215],
input[id=r216]:checked ~pre label[for=r216],
input[id=r217]:checked ~pre label[for=r217],
input[id=r218]:checked ~pre label[for=r218],
input[id=r219]:checked ~pre label[for=r219],
input[id=r220]:checked ~pre label[for=r220],
input[id=r221]:checked ~pre label[for=r221],
input[id=r222]:checked ~pre label[for=r222],
input[id=r223]:checked ~pre label[for=r223]
{background: #226; color: #ff8;}
input[id=i0]:checked ~pre .i0,
input[id=i1]:checked ~pre .i1,
input[id=i2]:checked ~pre .i2,
input[id=i3]:checked ~pre .i3,
input[id=i4]:checked ~pre .i4,
input[id=i5]:checked ~pre .i5,
input[id=i6]:checked ~pre .i6,
input[id=i7]:checked ~pre .i7,
input[id=i8]:checked ~pre .i8,
input[id=i9]:checked ~pre .i9,
input[id=i10]:checked ~pre .i10
{background: brown; color: #eed;}
</style><input id="r0" type="radio" name="g"/>
<input id="r1" type="radio" name="g"/>
<input id="r2" type="radio" name="g"/>
<input id="r3" type="radio" name="g"/>
<input id="r4" type="radio" name="g"/>
<input id="r5" type="radio" name="g"/>
<input id="r6" type="radio" name="g"/>
<input id="r7" type="radio" name="g"/>
<input id="r8" type="radio" name="g"/>
<input id="r9" type="radio" name="g"/>
<input id="r10" type="radio" name="g"/>
<input id="r11" type="radio" name="g"/>
<input id="r12" type="radio" name="g"/>
<input id="r13" type="radio" name="g"/>
<input id="r14" type="radio" name="g"/>
<input id="r15" type="radio" name="g"/>
<input id="r16" type="radio" name="g"/>
<input id="r17" type="radio" name="g"/>
<input id="r18" type="radio" name="g"/>
<input id="r19" type="radio" name="g"/>
<input id="r20" type="radio" name="g"/>
<input id="r21" type="radio" name="g"/>
<input id="r22" type="radio" name="g"/>
<input id="r23" type="radio" name="g"/>
<input id="r24" type="radio" name="g"/>
<input id="r25" type="radio" name="g"/>
<input id="r26" type="radio" name="g"/>
<input id="r27" type="radio" name="g"/>
<input id="r28" type="radio" name="g"/>
<input id="r29" type="radio" name="g"/>
<input id="r30" type="radio" name="g"/>
<input id="r31" type="radio" name="g"/>
<input id="r32" type="radio" name="g"/>
<input id="r33" type="radio" name="g"/>
<input id="r34" type="radio" name="g"/>
<input id="r35" type="radio" name="g"/>
<input id="r36" type="radio" name="g"/>
<input id="r37" type="radio" name="g"/>
<input id="r38" type="radio" name="g"/>
<input id="r39" type="radio" name="g"/>
<input id="r40" type="radio" name="g"/>
<input id="r41" type="radio" name="g"/>
<input id="r42" type="radio" name="g"/>
<input id="r43" type="radio" name="g"/>
<input id="r44" type="radio" name="g"/>
<input id="r45" type="radio" name="g"/>
<input id="r46" type="radio" name="g"/>
<input id="r47" type="radio" name="g"/>
<input id="r48" type="radio" name="g"/>
<input id="r49" type="radio" name="g"/>
<input id="r50" type="radio" name="g"/>
<input id="r51" type="radio" name="g"/>
<input id="r52" type="radio" name="g"/>
<input id="r53" type="radio" name="g"/>
<input id="r54" type="radio" name="g"/>
<input id="r55" type="radio" name="g"/>
<input id="r56" type="radio" name="g"/>
<input id="r57" type="radio" name="g"/>
<input id="r58" type="radio" name="g"/>
<input id="r59" type="radio" name="g"/>
<input id="r60" type="radio" name="g"/>
<input id="r61" type="radio" name="g"/>
<input id="r62" type="radio" name="g"/>
<input id="r63" type="radio" name="g"/>
<input id="r64" type="radio" name="g"/>
<input id="r65" type="radio" name="g"/>
<input id="r66" type="radio" name="g"/>
<input id="r67" type="radio" name="g"/>
<input id="r68" type="radio" name="g"/>
<input id="r69" type="radio" name="g"/>
<input id="r70" type="radio" name="g"/>
<input id="r71" type="radio" name="g"/>
<input id="r72" type="radio" name="g"/>
<input id="r73" type="radio" name="g"/>
<input id="r74" type="radio" name="g"/>
<input id="r75" type="radio" name="g"/>
<input id="r76" type="radio" name="g"/>
<input id="r77" type="radio" name="g"/>
<input id="r78" type="radio" name="g"/>
<input id="r79" type="radio" name="g"/>
<input id="r80" type="radio" name="g"/>
<input id="r81" type="radio" name="g"/>
<input id="r82" type="radio" name="g"/>
<input id="r83" type="radio" name="g"/>
<input id="r84" type="radio" name="g"/>
<input id="r85" type="radio" name="g"/>
<input id="r86" type="radio" name="g"/>
<input id="r87" type="radio" name="g"/>
<input id="r88" type="radio" name="g"/>
<input id="r89" type="radio" name="g"/>
<input id="r90" type="radio" name="g"/>
<input id="r91" type="radio" name="g"/>
<input id="r92" type="radio" name="g"/>
<input id="r93" type="radio" name="g"/>
<input id="r94" type="radio" name="g"/>
<input id="r95" type="radio" name="g"/>
<input id="r96" type="radio" name="g"/>
<input id="r97" type="radio" name="g"/>
<input id="r98" type="radio" name="g"/>
<input id="r99" type="radio" name="g"/>
<input id="r100" type="radio" name="g"/>
<input id="r101" type="radio" name="g"/>
<input id="r102" type="radio" name="g"/>
<input id="r103" type="radio" name="g"/>
<input id="r104" type="radio" name="g"/>
<input id="r105" type="radio" name="g"/>
<input id="r106" type="radio" name="g"/>
<input id="r107" type="radio" name="g"/>
<input id="r108" type="radio" name="g"/>
<input id="r109" type="radio" name="g"/>
<input id="r110" type="radio" name="g"/>
<input id="r111" type="radio" name="g"/>
<input id="r112" type="radio" name="g"/>
<input id="r113" type="radio" name="g"/>
<input id="r114" type="radio" name="g"/>
<input id="r115" type="radio" name="g"/>
<input id="r116" type="radio" name="g"/>
<input id="r117" type="radio" name="g"/>
<input id="r118" type="radio" name="g"/>
<input id="r119" type="radio" name="g"/>
<input id="r120" type="radio" name="g"/>
<input id="r121" type="radio" name="g"/>
<input id="r122" type="radio" name="g"/>
<input id="r123" type="radio" name="g"/>
<input id="r124" type="radio" name="g"/>
<input id="r125" type="radio" name="g"/>
<input id="r126" type="radio" name="g"/>
<input id="r127" type="radio" name="g"/>
<input id="r128" type="radio" name="g"/>
<input id="r129" type="radio" name="g"/>
<input id="r130" type="radio" name="g"/>
<input id="r131" type="radio" name="g"/>
<input id="r132" type="radio" name="g"/>
<input id="r133" type="radio" name="g"/>
<input id="r134" type="radio" name="g"/>
<input id="r135" type="radio" name="g"/>
<input id="r136" type="radio" name="g"/>
<input id="r137" type="radio" name="g"/>
<input id="r138" type="radio" name="g"/>
<input id="r139" type="radio" name="g"/>
<input id="r140" type="radio" name="g"/>
<input id="r141" type="radio" name="g"/>
<input id="r142" type="radio" name="g"/>
<input id="r143" type="radio" name="g"/>
<input id="r144" type="radio" name="g"/>
<input id="r145" type="radio" name="g"/>
<input id="r146" type="radio" name="g"/>
<input id="r147" type="radio" name="g"/>
<input id="r148" type="radio" name="g"/>
<input id="r149" type="radio" name="g"/>
<input id="r150" type="radio" name="g"/>
<input id="r151" type="radio" name="g"/>
<input id="r152" type="radio" name="g"/>
<input id="r153" type="radio" name="g"/>
<input id="r154" type="radio" name="g"/>
<input id="r155" type="radio" name="g"/>
<input id="r156" type="radio" name="g"/>
<input id="r157" type="radio" name="g"/>
<input id="r158" type="radio" name="g"/>
<input id="r159" type="radio" name="g"/>
<input id="r160" type="radio" name="g"/>
<input id="r161" type="radio" name="g"/>
<input id="r162" type="radio" name="g"/>
<input id="r163" type="radio" name="g"/>
<input id="r164" type="radio" name="g"/>
<input id="r165" type="radio" name="g"/>
<input id="r166" type="radio" name="g"/>
<input id="r167" type="radio" name="g"/>
<input id="r168" type="radio" name="g"/>
<input id="r169" type="radio" name="g"/>
<input id="r170" type="radio" name="g"/>
<input id="r171" type="radio" name="g"/>
<input id="r172" type="radio" name="g"/>
<input id="r173" type="radio" name="g"/>
<input id="r174" type="radio" name="g"/>
<input id="r175" type="radio" name="g"/>
<input id="r176" type="radio" name="g"/>
<input id="r177" type="radio" name="g"/>
<input id="r178" type="radio" name="g"/>
<input id="r179" type="radio" name="g"/>
<input id="r180" type="radio" name="g"/>
<input id="r181" type="radio" name="g"/>
<input id="r182" type="radio" name="g"/>
<input id="r183" type="radio" name="g"/>
<input id="r184" type="radio" name="g"/>
<input id="r185" type="radio" name="g"/>
<input id="r186" type="radio" name="g"/>
<input id="r187" type="radio" name="g"/>
<input id="r188" type="radio" name="g"/>
<input id="r189" type="radio" name="g"/>
<input id="r190" type="radio" name="g"/>
<input id="r191" type="radio" name="g"/>
<input id="r192" type="radio" name="g"/>
<input id="r193" type="radio" name="g"/>
<input id="r194" type="radio" name="g"/>
<input id="r195" type="radio" name="g"/>
<input id="r196" type="radio" name="g"/>
<input id="r197" type="radio" name="g"/>
<input id="r198" type="radio" name="g"/>
<input id="r199" type="radio" name="g"/>
<input id="r200" type="radio" name="g"/>
<input id="r201" type="radio" name="g"/>
<input id="r202" type="radio" name="g"/>
<input id="r203" type="radio" name="g"/>
<input id="r204" type="radio" name="g"/>
<input id="r205" type="radio" name="g"/>
<input id="r206" type="radio" name="g"/>
<input id="r207" type="radio" name="g"/>
<input id="r208" type="radio" name="g"/>
<input id="r209" type="radio" name="g"/>
<input id="r210" type="radio" name="g"/>
<input id="r211" type="radio" name="g"/>
<input id="r212" type="radio" name="g"/>
<input id="r213" type="radio" name="g"/>
<input id="r214" type="radio" name="g"/>
<input id="r215" type="radio" name="g"/>
<input id="r216" type="radio" name="g"/>
<input id="r217" type="radio" name="g"/>
<input id="r218" type="radio" name="g"/>
<input id="r219" type="radio" name="g"/>
<input id="r220" type="radio" name="g"/>
<input id="r221" type="radio" name="g"/>
<input id="r222" type="radio" name="g"/>
<input id="r223" type="radio" name="g"/>
<input id="i0" type="radio" name="i"/>
<input id="i1" type="radio" name="i"/>
<input id="i2" type="radio" name="i"/>
<input id="i3" type="radio" name="i"/>
<input id="i4" type="radio" name="i"/>
<input id="i5" type="radio" name="i"/>
<input id="i6" type="radio" name="i"/>
<input id="i7" type="radio" name="i"/>
<input id="i8" type="radio" name="i"/>
<input id="i9" type="radio" name="i"/>
<input id="i10" type="radio" name="i"/>
<div id="container"><div class="section">
<div class="doc">
<span class="comment"> Copyright 2011 The Go Authors. All rights reserved.</span><span class="comment"> Use of this source code is governed by a BSD-style</span><span class="comment"> license that can be found in the LICENSE file.</span></div>
<div class="code"><pre><code>
<span class="keyword">package</span> x509

<span class="keyword">import</span> (
	<label for="i0"><span class="lit-string i0">"bytes"</span></label>
	<label for="i1"><span class="lit-string i1">"errors"</span></label>
	<label for="i2"><span class="lit-string i2">"fmt"</span></label>
	<label for="i3"><span class="lit-string i3">"net"</span></label>
	<label for="i4"><span class="lit-string i4">"net/url"</span></label>
	<label for="i5"><span class="lit-string i5">"os"</span></label>
	<label for="i6"><span class="lit-string i6">"reflect"</span></label>
	<label for="i7"><span class="lit-string i7">"runtime"</span></label>
	<label for="i8"><span class="lit-string i8">"strings"</span></label>
	<label for="i9"><span class="lit-string i9">"time"</span></label>
	<label for="i10"><span class="lit-string i10">"unicode/utf8"</span></label>
)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> ignoreCN disables interpreting Common Name as a hostname. See issue 24151.</span></div>
<div class="code"><pre><code><span class="keyword">var</span> <a href="../../../pkg/crypto/x509.html#name-ignoreCN" class="ident">ignoreCN</a> = !<a href="../../../pkg/strings.html" class="ident i8">strings</a>.<a href="../../strings/strings.go.html#line-61" class="ident">Contains</a>(<a href="../../../pkg/os.html" class="ident i5">os</a>.<a href="../../os/env.go.html#line-101" class="ident">Getenv</a>(<span class="lit-string">"GODEBUG"</span>), <span class="lit-string">"x509ignoreCN=0"</span>)

<span class="keyword">type</span> <a href="../../../pkg/crypto/x509.html#name-InvalidReason" class="ident">InvalidReason</a> <a href="../../../pkg/builtin.html#name-int" class="ident">int</a>

</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> NotAuthorizedToSign results when a certificate is signed by another</span><span class="comment">	 which isn't marked as a CA certificate.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Expired results when a certificate has expired, based on the time</span><span class="comment">	 given in the VerifyOptions.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> CANotAuthorizedForThisName results when an intermediate or root</span><span class="comment">	 certificate has a name constraint which doesn't permit a DNS or</span><span class="comment">	 other name (including IP address) in the leaf certificate.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> TooManyIntermediates results when a path length constraint is</span><span class="comment">	 violated.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> IncompatibleUsage results when the certificate's key usage indicates</span><span class="comment">	 that it may only be used for a different purpose.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> NameMismatch results when the subject name of a parent certificate</span><span class="comment">	 does not match the issuer name in the child.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> NameConstraintsWithoutSANs results when a leaf certificate doesn't</span><span class="comment">	 contain a Subject Alternative Name extension, but a CA certificate</span><span class="comment">	 contains name constraints, and the Common Name can be interpreted as</span><span class="comment">	 a hostname.</span><span class="comment">	</span><span class="comment">	 This error is only returned when legacy Common Name matching is enabled</span><span class="comment">	 by setting the GODEBUG environment variable to "x509ignoreCN=1". This</span><span class="comment">	 setting might be removed in the future.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> UnconstrainedName results when a CA certificate contains permitted</span><span class="comment">	 name constraints, but leaf certificate contains a name of an</span><span class="comment">	 unsupported or unconstrained type.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> TooManyConstraints results when the number of comparison operations</span><span class="comment">	 needed to check a certificate exceeds the limit set by</span><span class="comment">	 VerifyOptions.MaxConstraintComparisions. This limit exists to</span><span class="comment">	 prevent pathological certificates can consuming excessive amounts of</span><span class="comment">	 CPU time to verify.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> CANotAuthorizedForExtKeyUsage results when an intermediate or root</span><span class="comment">	 certificate does not permit a requested extended key usage.</span></div>
<div class="code"><pre><code>	<a href="../../../pkg/crypto/x509.html#name-CANotAuthorizedForExtKeyUsage" class="ident">CANotAuthorizedForExtKeyUsage</a>
)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> CertificateInvalidError results when an odd error occurs. Users of this</span><span class="comment"> library probably want to handle all these errors uniformly.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../pkg/crypto/x509.html#name-CertificateInvalidError" class="ident">CertificateInvalidError</a> <span class="keyword">struct</span> {
	<a href="../../../use/crypto/x509..CertificateInvalidError.Cert.html" class="ident">Cert</a>   *<a href="x509.go.html#line-629" class="ident">Certificate</a>
	<a href="../../../use/crypto/x509..CertificateInvalidError.Reason.html" class="ident">Reason</a> <a href="#line-24" class="ident">InvalidReason</a>
	<a href="../../../use/crypto/x509..CertificateInvalidError.Detail.html" class="ident">Detail</a> <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>
}

<span class="keyword">func</span> (<label for="r0" class="ident">e</label> <a href="#line-72" class="ident">CertificateInvalidError</a>) <label for="r1" class="ident"><a href="../../../use/crypto/x509..CertificateInvalidError.Error.html" class="ident">Error</a></label>() <a href="../../../pkg/builtin.html#name-string" class="ident">string</a> {
	<span class="keyword">switch</span> <label for="r0" class="ident">e</label>.<a href="#line-74" class="ident">Reason</a> {
	<span class="keyword">case</span> <a href="#line-29" class="ident">NotAuthorizedToSign</a>:
		<span class="keyword">return</span> <span class="lit-string">"x509: certificate is not authorized to sign other certificates"</span>
	<span class="keyword">case</span> <a href="#line-32" class="ident">Expired</a>:
		<span class="keyword">return</span> <span class="lit-string">"x509: certificate has expired or is not yet valid: "</span> + <label for="r0" class="ident">e</label>.<a href="#line-75" class="ident">Detail</a>
	<span class="keyword">case</span> <a href="#line-36" class="ident">CANotAuthorizedForThisName</a>:
		<span class="keyword">return</span> <span class="lit-string">"x509: a root or intermediate certificate is not authorized to sign for this name: "</span> + <label for="r0" class="ident">e</label>.<a href="#line-75" class="ident">Detail</a>
	<span class="keyword">case</span> <a href="#line-67" class="ident">CANotAuthorizedForExtKeyUsage</a>:
		<span class="keyword">return</span> <span class="lit-string">"x509: a root or intermediate certificate is not authorized for an extended key usage: "</span> + <label for="r0" class="ident">e</label>.<a href="#line-75" class="ident">Detail</a>
	<span class="keyword">case</span> <a href="#line-39" class="ident">TooManyIntermediates</a>:
		<span class="keyword">return</span> <span class="lit-string">"x509: too many intermediates for path length constraint"</span>
	<span class="keyword">case</span> <a href="#line-42" class="ident">IncompatibleUsage</a>:
		<span class="keyword">return</span> <span class="lit-string">"x509: certificate specifies an incompatible key usage"</span>
	<span class="keyword">case</span> <a href="#line-45" class="ident">NameMismatch</a>:
		<span class="keyword">return</span> <span class="lit-string">"x509: issuer name does not match subject from issuing certificate"</span>
	<span class="keyword">case</span> <a href="#line-54" class="ident">NameConstraintsWithoutSANs</a>:
		<span class="keyword">return</span> <span class="lit-string">"x509: issuer has name constraints but leaf doesn't have a SAN extension"</span>
	<span class="keyword">case</span> <a href="#line-58" class="ident">UnconstrainedName</a>:
		<span class="keyword">return</span> <span class="lit-string">"x509: issuer has name constraints but leaf contains unknown or unconstrained name: "</span> + <label for="r0" class="ident">e</label>.<a href="#line-75" class="ident">Detail</a>
	}
	<span class="keyword">return</span> <span class="lit-string">"x509: unknown error"</span>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> HostnameError results when the set of authorized names doesn't match the</span><span class="comment"> requested name.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../pkg/crypto/x509.html#name-HostnameError" class="ident">HostnameError</a> <span class="keyword">struct</span> {
	<a href="../../../use/crypto/x509..HostnameError.Certificate.html" class="ident">Certificate</a> *<a href="x509.go.html#line-629" class="ident">Certificate</a>
	<a href="../../../use/crypto/x509..HostnameError.Host.html" class="ident">Host</a>        <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>
}

<span class="keyword">func</span> (<label for="r2" class="ident">h</label> <a href="#line-104" class="ident">HostnameError</a>) <label for="r3" class="ident"><a href="../../../use/crypto/x509..HostnameError.Error.html" class="ident">Error</a></label>() <a href="../../../pkg/builtin.html#name-string" class="ident">string</a> {
	<label for="r4" class="ident">c</label> := <label for="r2" class="ident">h</label>.<a href="#line-105" class="ident">Certificate</a>

	<span class="keyword">if</span> !<label for="r4" class="ident">c</label>.<a href="x509.go.html#line-757" class="ident">hasSANExtension</a>() &amp;&amp; <a href="#line-982" class="ident">matchHostnames</a>(<label for="r4" class="ident">c</label>.<a href="x509.go.html#line-645" class="ident">Subject</a>.<a href="pkix/pkix.go.html#line-127" class="ident">CommonName</a>, <label for="r2" class="ident">h</label>.<a href="#line-106" class="ident">Host</a>) {
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> This would have validated, if it weren't for the validHostname check on Common Name.</span></div>
<div class="code"><pre><code>			<span class="keyword">return</span> <span class="lit-string">"x509: Common Name is not a valid hostname: "</span> + <label for="r4" class="ident">c</label>.<a href="x509.go.html#line-645" class="ident">Subject</a>.<a href="pkix/pkix.go.html#line-127" class="ident">CommonName</a>
		}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> This would have validated if x509ignoreCN=0 were set.</span></div>
<div class="code"><pre><code>			<span class="keyword">return</span> <span class="lit-string">"x509: certificate relies on legacy Common Name field, "</span> +
				<span class="lit-string">"use SANs or temporarily enable Common Name matching with GODEBUG=x509ignoreCN=0"</span>
		}
	}

	<span class="keyword">var</span> <label for="r5" class="ident">valid</label> <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Trying to validate an IP</span></div>
<div class="code"><pre><code>		<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r4" class="ident">c</label>.<a href="x509.go.html#line-710" class="ident">IPAddresses</a>) == <span class="lit-number">0</span> {
			<span class="keyword">return</span> <span class="lit-string">"x509: cannot validate certificate for "</span> + <label for="r2" class="ident">h</label>.<a href="#line-106" class="ident">Host</a> + <span class="lit-string">" because it doesn't contain any IP SANs"</span>
		}
		<span class="keyword">for</span> <label for="r7" class="ident">_</label>, <label for="r8" class="ident">san</label> := <span class="keyword">range</span> <label for="r4" class="ident">c</label>.<a href="x509.go.html#line-710" class="ident">IPAddresses</a> {
			<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r5" class="ident">valid</label>) &gt; <span class="lit-number">0</span> {
				<label for="r5" class="ident">valid</label> += <span class="lit-string">", "</span>
			}
			<label for="r5" class="ident">valid</label> += <label for="r8" class="ident">san</label>.<a href="../../net/ip.go.html#line-291" class="ident">String</a>()
		}
	} <span class="keyword">else</span> {
		<span class="keyword">if</span> <label for="r4" class="ident">c</label>.<a href="#line-971" class="ident">commonNameAsHostname</a>() {
			<label for="r5" class="ident">valid</label> = <label for="r4" class="ident">c</label>.<a href="x509.go.html#line-645" class="ident">Subject</a>.<a href="pkix/pkix.go.html#line-127" class="ident">CommonName</a>
		} <span class="keyword">else</span> {
			<label for="r5" class="ident">valid</label> = <a href="../../../pkg/strings.html" class="ident i8">strings</a>.<a href="../../strings/strings.go.html#line-421" class="ident">Join</a>(<label for="r4" class="ident">c</label>.<a href="x509.go.html#line-708" class="ident">DNSNames</a>, <span class="lit-string">", "</span>)
		}
	}

	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r5" class="ident">valid</label>) == <span class="lit-number">0</span> {
		<span class="keyword">return</span> <span class="lit-string">"x509: certificate is not valid for any names, but wanted to match "</span> + <label for="r2" class="ident">h</label>.<a href="#line-106" class="ident">Host</a>
	}
	<span class="keyword">return</span> <span class="lit-string">"x509: certificate is valid for "</span> + <label for="r5" class="ident">valid</label> + <span class="lit-string">", not "</span> + <label for="r2" class="ident">h</label>.<a href="#line-106" class="ident">Host</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> UnknownAuthorityError results when the certificate issuer is unknown</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../pkg/crypto/x509.html#name-UnknownAuthorityError" class="ident">UnknownAuthorityError</a> <span class="keyword">struct</span> {
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> hintErr contains an error that may be helpful in determining why an</span><span class="comment">	 authority wasn't found.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> hintCert contains a possible authority certificate that was rejected</span><span class="comment">	 because of the error in hintErr.</span></div>
<div class="code"><pre><code>	<a href="../../../use/crypto/x509..UnknownAuthorityError.hintCert*e462c.html" class="ident">hintCert</a> *<a href="x509.go.html#line-629" class="ident">Certificate</a>
}

<span class="keyword">func</span> (<label for="r9" class="ident">e</label> <a href="#line-151" class="ident">UnknownAuthorityError</a>) <label for="r10" class="ident"><a href="../../../use/crypto/x509..UnknownAuthorityError.Error.html" class="ident">Error</a></label>() <a href="../../../pkg/builtin.html#name-string" class="ident">string</a> {
	<label for="r11" class="ident">s</label> := <span class="lit-string">"x509: certificate signed by unknown authority"</span>
	<span class="keyword">if</span> <label for="r9" class="ident">e</label>.<a href="#line-155" class="ident">hintErr</a> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
		<label for="r12" class="ident">certName</label> := <label for="r9" class="ident">e</label>.<a href="#line-158" class="ident">hintCert</a>.<a href="x509.go.html#line-645" class="ident">Subject</a>.<a href="pkix/pkix.go.html#line-127" class="ident">CommonName</a>
		<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r12" class="ident">certName</label>) == <span class="lit-number">0</span> {
			<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r9" class="ident">e</label>.<a href="#line-158" class="ident">hintCert</a>.<a href="x509.go.html#line-645" class="ident">Subject</a>.<a href="pkix/pkix.go.html#line-124" class="ident">Organization</a>) &gt; <span class="lit-number">0</span> {
				<label for="r12" class="ident">certName</label> = <label for="r9" class="ident">e</label>.<a href="#line-158" class="ident">hintCert</a>.<a href="x509.go.html#line-645" class="ident">Subject</a>.<a href="pkix/pkix.go.html#line-124" class="ident">Organization</a>[<span class="lit-number">0</span>]
			} <span class="keyword">else</span> {
				<label for="r12" class="ident">certName</label> = <span class="lit-string">"serial:"</span> + <label for="r9" class="ident">e</label>.<a href="#line-158" class="ident">hintCert</a>.<a href="x509.go.html#line-643" class="ident">SerialNumber</a>.<a href="../../math/big/intconv.go.html#line-39" class="ident">String</a>()
			}
		}
		<label for="r11" class="ident">s</label> += <a href="../../../pkg/fmt.html" class="ident i2">fmt</a>.<a href="../../fmt/print.go.html#line-217" class="ident">Sprintf</a>(<span class="lit-string">" (possibly because of %q while trying to verify candidate authority certificate %q)"</span>, <label for="r9" class="ident">e</label>.<a href="#line-155" class="ident">hintErr</a>, <label for="r12" class="ident">certName</label>)
	}
	<span class="keyword">return</span> <label for="r11" class="ident">s</label>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> SystemRootsError results when we fail to load the system root certificates.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../pkg/crypto/x509.html#name-SystemRootsError" class="ident">SystemRootsError</a> <span class="keyword">struct</span> {
	<a href="../../../use/crypto/x509..SystemRootsError.Err.html" class="ident">Err</a> <a href="../../../pkg/builtin.html#name-error" class="ident">error</a>
}

<span class="keyword">func</span> (<label for="r13" class="ident">se</label> <a href="#line-178" class="ident">SystemRootsError</a>) <label for="r14" class="ident"><a href="../../../use/crypto/x509..SystemRootsError.Error.html" class="ident">Error</a></label>() <a href="../../../pkg/builtin.html#name-string" class="ident">string</a> {
	<label for="r15" class="ident">msg</label> := <span class="lit-string">"x509: failed to load system roots and no roots provided"</span>
	<span class="keyword">if</span> <label for="r13" class="ident">se</label>.<a href="#line-179" class="ident">Err</a> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
		<span class="keyword">return</span> <label for="r15" class="ident">msg</label> + <span class="lit-string">"; "</span> + <label for="r13" class="ident">se</label>.<a href="#line-179" class="ident">Err</a>.Error()
	}
	<span class="keyword">return</span> <label for="r15" class="ident">msg</label>
}

<span class="keyword">func</span> (<label for="r16" class="ident">se</label> <a href="#line-178" class="ident">SystemRootsError</a>) <label for="r17" class="ident"><a href="../../../use/crypto/x509..SystemRootsError.Unwrap.html" class="ident">Unwrap</a></label>() <a href="../../../pkg/builtin.html#name-error" class="ident">error</a> { <span class="keyword">return</span> <label for="r16" class="ident">se</label>.<a href="#line-179" class="ident">Err</a> }
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> errNotParsed is returned when a certificate without ASN.1 contents is</span><span class="comment"> verified. Platform-specific verification needs the ASN.1 contents.</span></div>
<div class="code"><pre><code><span class="keyword">var</span> <a href="../../../pkg/crypto/x509.html#name-errNotParsed" class="ident">errNotParsed</a> = <a href="../../../pkg/errors.html" class="ident i1">errors</a>.<a href="../../errors/errors.go.html#line-58" class="ident">New</a>(<span class="lit-string">"x509: missing ASN.1 contents; use ParseCertificate"</span>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> VerifyOptions contains parameters for Certificate.Verify.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> DNSName, if set, is checked against the leaf certificate with</span><span class="comment">	 Certificate.VerifyHostname or the platform verifier.</span></div>
<div class="code"><pre><code>	<a href="../../../use/crypto/x509..VerifyOptions.DNSName.html" class="ident">DNSName</a> <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Intermediates is an optional pool of certificates that are not trust</span><span class="comment">	 anchors, but can be used to form a chain from the leaf certificate to a</span><span class="comment">	 root certificate.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Roots is the set of trusted root certificates the leaf certificate needs</span><span class="comment">	 to chain up to. If nil, the system roots or the platform verifier are used.</span></div>
<div class="code"><pre><code>	<a href="../../../use/crypto/x509..VerifyOptions.Roots.html" class="ident">Roots</a> *<a href="cert_pool.go.html#line-19" class="ident">CertPool</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> CurrentTime is used to check the validity of all certificates in the</span><span class="comment">	 chain. If zero, the current time is used.</span></div>
<div class="code"><pre><code>	<a href="../../../use/crypto/x509..VerifyOptions.CurrentTime.html" class="ident">CurrentTime</a> <a href="../../../pkg/time.html" class="ident i9">time</a>.<a href="../../time/time.go.html#line-127" class="ident">Time</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> KeyUsages specifies which Extended Key Usage values are acceptable. A</span><span class="comment">	 chain is accepted if it allows any of the listed values. An empty list</span><span class="comment">	 means ExtKeyUsageServerAuth. To accept any key usage, include ExtKeyUsageAny.</span></div>
<div class="code"><pre><code>	<a href="../../../use/crypto/x509..VerifyOptions.KeyUsages.html" class="ident">KeyUsages</a> []<a href="x509.go.html#line-570" class="ident">ExtKeyUsage</a>
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> MaxConstraintComparisions is the maximum number of comparisons to</span><span class="comment">	 perform when checking a given certificate's name constraints. If</span><span class="comment">	 zero, a sensible default is used. This limit prevents pathological</span><span class="comment">	 certificates from consuming excessive amounts of CPU time when</span><span class="comment">	 validating. It does not apply to the platform verifier.</span></div>
<div class="code"><pre><code>	<a href="../../../use/crypto/x509..VerifyOptions.MaxConstraintComparisions.html" class="ident">MaxConstraintComparisions</a> <a href="../../../pkg/builtin.html#name-int" class="ident">int</a>
}

<span class="keyword">const</span> (
	<a href="../../../pkg/crypto/x509.html#name-leafCertificate" class="ident">leafCertificate</a> = <a href="../../../pkg/builtin.html#name-iota" class="ident">iota</a>
	<a href="../../../pkg/crypto/x509.html#name-intermediateCertificate" class="ident">intermediateCertificate</a>
	<a href="../../../pkg/crypto/x509.html#name-rootCertificate" class="ident">rootCertificate</a>
)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> rfc2821Mailbox represents a “mailbox” (which is an email address to most</span><span class="comment"> people) by breaking it into the “local” (i.e. before the '@') and “domain”</span><span class="comment"> parts.</span></div>
<div class="code"><pre><code><span class="keyword">type</span> <a href="../../../pkg/crypto/x509.html#name-rfc2821Mailbox" class="ident">rfc2821Mailbox</a> <span class="keyword">struct</span> {
	<a href="../../../use/crypto/x509..rfc2821Mailbox*1cdc3.local*25bf8.html" class="ident">local</a>, <a href="../../../use/crypto/x509..rfc2821Mailbox*1cdc3.domain*f2ff8.html" class="ident">domain</a> <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> parseRFC2821Mailbox parses an email address into local and domain parts,</span><span class="comment"> based on the ABNF for a “Mailbox” from RFC 2821. According to RFC 5280,</span><span class="comment"> Section 4.2.1.6 that's correct for an rfc822Name from a certificate: “The</span><span class="comment"> format of an rfc822Name is a "Mailbox" as defined in RFC 2821, Section 4.1.2”.</span></div>
<div class="code"><pre><code><span class="keyword">func</span> <label for="r18" class="ident"><a href="../../../pkg/crypto/x509.html#name-parseRFC2821Mailbox" class="ident">parseRFC2821Mailbox</a></label>(<label for="r19" class="ident">in</label> <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>) (<label for="r20" class="ident">mailbox</label> <a href="#line-236" class="ident">rfc2821Mailbox</a>, <label for="r21" class="ident">ok</label> <a href="../../../pkg/builtin.html#name-bool" class="ident">bool</a>) {
	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r19" class="ident">in</label>) == <span class="lit-number">0</span> {
		<span class="keyword">return</span> <label for="r20" class="ident">mailbox</label>, <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
	}

	<label for="r22" class="ident">localPartBytes</label> := <a href="../../../pkg/builtin.html#name-make" class="ident">make</a>([]<a href="../../../pkg/builtin.html#name-byte" class="ident">byte</a>, <span class="lit-number">0</span>, <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r19" class="ident">in</label>)/<span class="lit-number">2</span>)

</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Quoted-string = DQUOTE *qcontent DQUOTE</span><span class="comment">		 non-whitespace-control = %d1-8 / %d11 / %d12 / %d14-31 / %d127</span><span class="comment">		 qcontent = qtext / quoted-pair</span><span class="comment">		 qtext = non-whitespace-control /</span><span class="comment">		         %d33 / %d35-91 / %d93-126</span><span class="comment">		 quoted-pair = ("\" text) / obs-qp</span><span class="comment">		 text = %d1-9 / %d11 / %d12 / %d14-127 / obs-text</span><span class="comment">		</span><span class="comment">		 (Names beginning with “obs-” are the obsolete syntax from RFC 2822,</span><span class="comment">		 Section 4. Since it has been 16 years, we no longer accept that.)</span></div>
<div class="code"><pre><code>		<label for="r19" class="ident">in</label> = <label for="r19" class="ident">in</label>[<span class="lit-number">1</span>:]
	<label for="r23" class="ident">QuotedString</label>:
		<span class="keyword">for</span> {
			<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r19" class="ident">in</label>) == <span class="lit-number">0</span> {
				<span class="keyword">return</span> <label for="r20" class="ident">mailbox</label>, <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
			}
			<label for="r24" class="ident">c</label> := <label for="r19" class="ident">in</label>[<span class="lit-number">0</span>]
			<label for="r19" class="ident">in</label> = <label for="r19" class="ident">in</label>[<span class="lit-number">1</span>:]

			<span class="keyword">switch</span> {
			<span class="keyword">case</span> <label for="r24" class="ident">c</label> == <span class="lit-number">'"'</span>:
				<span class="keyword">break</span> <label for="r23" class="ident">QuotedString</label>

</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> quoted-pair</span></div>
<div class="code"><pre><code>				<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r19" class="ident">in</label>) == <span class="lit-number">0</span> {
					<span class="keyword">return</span> <label for="r20" class="ident">mailbox</label>, <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
				}
				<span class="keyword">if</span> <label for="r19" class="ident">in</label>[<span class="lit-number">0</span>] == <span class="lit-number">11</span> ||
					<label for="r19" class="ident">in</label>[<span class="lit-number">0</span>] == <span class="lit-number">12</span> ||
					(<span class="lit-number">1</span> &lt;= <label for="r19" class="ident">in</label>[<span class="lit-number">0</span>] &amp;&amp; <label for="r19" class="ident">in</label>[<span class="lit-number">0</span>] &lt;= <span class="lit-number">9</span>) ||
					(<span class="lit-number">14</span> &lt;= <label for="r19" class="ident">in</label>[<span class="lit-number">0</span>] &amp;&amp; <label for="r19" class="ident">in</label>[<span class="lit-number">0</span>] &lt;= <span class="lit-number">127</span>) {
					<label for="r22" class="ident">localPartBytes</label> = <a href="../../../pkg/builtin.html#name-append" class="ident">append</a>(<label for="r22" class="ident">localPartBytes</label>, <label for="r19" class="ident">in</label>[<span class="lit-number">0</span>])
					<label for="r19" class="ident">in</label> = <label for="r19" class="ident">in</label>[<span class="lit-number">1</span>:]
				} <span class="keyword">else</span> {
					<span class="keyword">return</span> <label for="r20" class="ident">mailbox</label>, <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
				}

			<span class="keyword">case</span> <label for="r24" class="ident">c</label> == <span class="lit-number">11</span> ||
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Space (char 32) is not allowed based on the</span><span class="comment">				 BNF, but RFC 3696 gives an example that</span><span class="comment">				 assumes that it is. Several “verified”</span><span class="comment">				 errata continue to argue about this point.</span><span class="comment">				 We choose to accept it.</span></div>
<div class="code"><pre><code>				<label for="r24" class="ident">c</label> == <span class="lit-number">32</span> ||
				<label for="r24" class="ident">c</label> == <span class="lit-number">33</span> ||
				<label for="r24" class="ident">c</label> == <span class="lit-number">127</span> ||
				(<span class="lit-number">1</span> &lt;= <label for="r24" class="ident">c</label> &amp;&amp; <label for="r24" class="ident">c</label> &lt;= <span class="lit-number">8</span>) ||
				(<span class="lit-number">14</span> &lt;= <label for="r24" class="ident">c</label> &amp;&amp; <label for="r24" class="ident">c</label> &lt;= <span class="lit-number">31</span>) ||
				(<span class="lit-number">35</span> &lt;= <label for="r24" class="ident">c</label> &amp;&amp; <label for="r24" class="ident">c</label> &lt;= <span class="lit-number">91</span>) ||
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> qtext</span></div>
<div class="code"><pre><code>				<label for="r22" class="ident">localPartBytes</label> = <a href="../../../pkg/builtin.html#name-append" class="ident">append</a>(<label for="r22" class="ident">localPartBytes</label>, <label for="r24" class="ident">c</label>)

			<span class="keyword">default</span>:
				<span class="keyword">return</span> <label for="r20" class="ident">mailbox</label>, <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
			}
		}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Atom ("." Atom)*</span></div>
<div class="code"><pre><code>	<label for="r25" class="ident">NextChar</label>:
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> atext from RFC 2822, Section 3.2.4</span></div>
<div class="code"><pre><code>			<label for="r26" class="ident">c</label> := <label for="r19" class="ident">in</label>[<span class="lit-number">0</span>]

			<span class="keyword">switch</span> {
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Examples given in RFC 3696 suggest that</span><span class="comment">				 escaped characters can appear outside of a</span><span class="comment">				 quoted string. Several “verified” errata</span><span class="comment">				 continue to argue the point. We choose to</span><span class="comment">				 accept it.</span></div>
<div class="code"><pre><code>				<label for="r19" class="ident">in</label> = <label for="r19" class="ident">in</label>[<span class="lit-number">1</span>:]
				<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r19" class="ident">in</label>) == <span class="lit-number">0</span> {
					<span class="keyword">return</span> <label for="r20" class="ident">mailbox</label>, <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
				}
				<span class="keyword">fallthrough</span>

			<span class="keyword">case</span> (<span class="lit-number">'0'</span> &lt;= <label for="r26" class="ident">c</label> &amp;&amp; <label for="r26" class="ident">c</label> &lt;= <span class="lit-number">'9'</span>) ||
				(<span class="lit-number">'a'</span> &lt;= <label for="r26" class="ident">c</label> &amp;&amp; <label for="r26" class="ident">c</label> &lt;= <span class="lit-number">'z'</span>) ||
				(<span class="lit-number">'A'</span> &lt;= <label for="r26" class="ident">c</label> &amp;&amp; <label for="r26" class="ident">c</label> &lt;= <span class="lit-number">'Z'</span>) ||
				<label for="r26" class="ident">c</label> == <span class="lit-number">'!'</span> || <label for="r26" class="ident">c</label> == <span class="lit-number">'#'</span> || <label for="r26" class="ident">c</label> == <span class="lit-number">'$'</span> || <label for="r26" class="ident">c</label> == <span class="lit-number">'%'</span> ||
				<label for="r26" class="ident">c</label> == <span class="lit-number">'&amp;'</span> || <label for="r26" class="ident">c</label> == <span class="lit-number">'\''</span> || <label for="r26" class="ident">c</label> == <span class="lit-number">'*'</span> || <label for="r26" class="ident">c</label> == <span class="lit-number">'+'</span> ||
				<label for="r26" class="ident">c</label> == <span class="lit-number">'-'</span> || <label for="r26" class="ident">c</label> == <span class="lit-number">'/'</span> || <label for="r26" class="ident">c</label> == <span class="lit-number">'='</span> || <label for="r26" class="ident">c</label> == <span class="lit-number">'?'</span> ||
				<label for="r26" class="ident">c</label> == <span class="lit-number">'^'</span> || <label for="r26" class="ident">c</label> == <span class="lit-number">'_'</span> || <label for="r26" class="ident">c</label> == <span class="lit-number">'`'</span> || <label for="r26" class="ident">c</label> == <span class="lit-number">'{'</span> ||
				<label for="r26" class="ident">c</label> == <span class="lit-number">'|'</span> || <label for="r26" class="ident">c</label> == <span class="lit-number">'}'</span> || <label for="r26" class="ident">c</label> == <span class="lit-number">'~'</span> || <label for="r26" class="ident">c</label> == <span class="lit-number">'.'</span>:
				<label for="r22" class="ident">localPartBytes</label> = <a href="../../../pkg/builtin.html#name-append" class="ident">append</a>(<label for="r22" class="ident">localPartBytes</label>, <label for="r19" class="ident">in</label>[<span class="lit-number">0</span>])
				<label for="r19" class="ident">in</label> = <label for="r19" class="ident">in</label>[<span class="lit-number">1</span>:]

			<span class="keyword">default</span>:
				<span class="keyword">break</span> <label for="r25" class="ident">NextChar</label>
			}
		}

		<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r22" class="ident">localPartBytes</label>) == <span class="lit-number">0</span> {
			<span class="keyword">return</span> <label for="r20" class="ident">mailbox</label>, <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
		}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> From RFC 3696, Section 3:</span><span class="comment">		 “period (".") may also appear, but may not be used to start</span><span class="comment">		 or end the local part, nor may two or more consecutive</span><span class="comment">		 periods appear.”</span></div>
<div class="code"><pre><code>		<label for="r27" class="ident">twoDots</label> := []<a href="../../../pkg/builtin.html#name-byte" class="ident">byte</a>{<span class="lit-number">'.'</span>, <span class="lit-number">'.'</span>}
		<span class="keyword">if</span> <label for="r22" class="ident">localPartBytes</label>[<span class="lit-number">0</span>] == <span class="lit-number">'.'</span> ||
			<label for="r22" class="ident">localPartBytes</label>[<a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r22" class="ident">localPartBytes</label>)-<span class="lit-number">1</span>] == <span class="lit-number">'.'</span> ||
			<a href="../../../pkg/bytes.html" class="ident i0">bytes</a>.<a href="../../bytes/bytes.go.html#line-75" class="ident">Contains</a>(<label for="r22" class="ident">localPartBytes</label>, <label for="r27" class="ident">twoDots</label>) {
			<span class="keyword">return</span> <label for="r20" class="ident">mailbox</label>, <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
		}
	}

	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r19" class="ident">in</label>) == <span class="lit-number">0</span> || <label for="r19" class="ident">in</label>[<span class="lit-number">0</span>] != <span class="lit-number">'@'</span> {
		<span class="keyword">return</span> <label for="r20" class="ident">mailbox</label>, <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
	}
	<label for="r19" class="ident">in</label> = <label for="r19" class="ident">in</label>[<span class="lit-number">1</span>:]
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> The RFC species a format for domains, but that's known to be</span><span class="comment">	 violated in practice so we accept that anything after an '@' is the</span><span class="comment">	 domain part.</span></div>
<div class="code"><pre><code>	<span class="keyword">if</span> <label for="r28" class="ident">_</label>, <label for="r29" class="ident">ok</label> := <a href="#line-382" class="ident">domainToReverseLabels</a>(<label for="r19" class="ident">in</label>); !<label for="r29" class="ident">ok</label> {
		<span class="keyword">return</span> <label for="r20" class="ident">mailbox</label>, <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
	}

	<label for="r20" class="ident">mailbox</label>.<a href="#line-237" class="ident">local</a> = <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>(<label for="r22" class="ident">localPartBytes</label>)
	<label for="r20" class="ident">mailbox</label>.<a href="#line-237" class="ident">domain</a> = <label for="r19" class="ident">in</label>
	<span class="keyword">return</span> <label for="r20" class="ident">mailbox</label>, <a href="../../../pkg/builtin.html#name-true" class="ident">true</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> domainToReverseLabels converts a textual domain name like foo.example.com to</span><span class="comment"> the list of labels in reverse order, e.g. ["com", "example", "foo"].</span></div>
<div class="code"><pre><code><span class="keyword">func</span> <label for="r30" class="ident"><a href="../../../pkg/crypto/x509.html#name-domainToReverseLabels" class="ident">domainToReverseLabels</a></label>(<label for="r31" class="ident">domain</label> <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>) (<label for="r32" class="ident">reverseLabels</label> []<a href="../../../pkg/builtin.html#name-string" class="ident">string</a>, <label for="r33" class="ident">ok</label> <a href="../../../pkg/builtin.html#name-bool" class="ident">bool</a>) {
	<span class="keyword">for</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r31" class="ident">domain</label>) &gt; <span class="lit-number">0</span> {
		<span class="keyword">if</span> <label for="r34" class="ident">i</label> := <a href="../../../pkg/strings.html" class="ident i8">strings</a>.<a href="../../strings/strings.go.html#line-225" class="ident">LastIndexByte</a>(<label for="r31" class="ident">domain</label>, <span class="lit-number">'.'</span>); <label for="r34" class="ident">i</label> == -<span class="lit-number">1</span> {
			<label for="r32" class="ident">reverseLabels</label> = <a href="../../../pkg/builtin.html#name-append" class="ident">append</a>(<label for="r32" class="ident">reverseLabels</label>, <label for="r31" class="ident">domain</label>)
			<label for="r31" class="ident">domain</label> = <span class="lit-string">""</span>
		} <span class="keyword">else</span> {
			<label for="r32" class="ident">reverseLabels</label> = <a href="../../../pkg/builtin.html#name-append" class="ident">append</a>(<label for="r32" class="ident">reverseLabels</label>, <label for="r31" class="ident">domain</label>[<label for="r34" class="ident">i</label>+<span class="lit-number">1</span>:])
			<label for="r31" class="ident">domain</label> = <label for="r31" class="ident">domain</label>[:<label for="r34" class="ident">i</label>]
		}
	}

</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> An empty label at the end indicates an absolute value.</span></div>
<div class="code"><pre><code>		<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>, <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
	}

	<span class="keyword">for</span> <label for="r35" class="ident">_</label>, <label for="r36" class="ident">label</label> := <span class="keyword">range</span> <label for="r32" class="ident">reverseLabels</label> {
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Empty labels are otherwise invalid.</span></div>
<div class="code"><pre><code>			<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>, <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
		}

		<span class="keyword">for</span> <label for="r37" class="ident">_</label>, <label for="r38" class="ident">c</label> := <span class="keyword">range</span> <label for="r36" class="ident">label</label> {
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Invalid character.</span></div>
<div class="code"><pre><code>				<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>, <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
			}
		}
	}

	<span class="keyword">return</span> <label for="r32" class="ident">reverseLabels</label>, <a href="../../../pkg/builtin.html#name-true" class="ident">true</a>
}

</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> If the constraint contains an @, then it specifies an exact mailbox</span><span class="comment">	 name.</span></div>
<div class="code"><pre><code>	<span class="keyword">if</span> <a href="../../../pkg/strings.html" class="ident i8">strings</a>.<a href="../../strings/strings.go.html#line-61" class="ident">Contains</a>(<label for="r41" class="ident">constraint</label>, <span class="lit-string">"@"</span>) {
		<label for="r42" class="ident">constraintMailbox</label>, <label for="r43" class="ident">ok</label> := <a href="#line-244" class="ident">parseRFC2821Mailbox</a>(<label for="r41" class="ident">constraint</label>)
		<span class="keyword">if</span> !<label for="r43" class="ident">ok</label> {
			<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>, <a href="../../../pkg/fmt.html" class="ident i2">fmt</a>.<a href="../../fmt/errors.go.html#line-17" class="ident">Errorf</a>(<span class="lit-string">"x509: internal error: cannot parse constraint %q"</span>, <label for="r41" class="ident">constraint</label>)
		}
		<span class="keyword">return</span> <label for="r40" class="ident">mailbox</label>.<a href="#line-237" class="ident">local</a> == <label for="r42" class="ident">constraintMailbox</label>.<a href="#line-237" class="ident">local</a> &amp;&amp; <a href="../../../pkg/strings.html" class="ident i8">strings</a>.<a href="../../strings/strings.go.html#line-970" class="ident">EqualFold</a>(<label for="r40" class="ident">mailbox</label>.<a href="#line-237" class="ident">domain</a>, <label for="r42" class="ident">constraintMailbox</label>.<a href="#line-237" class="ident">domain</a>), <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>
	}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Otherwise the constraint is like a DNS constraint of the domain part</span><span class="comment">	 of the mailbox.</span></div>
<div class="code"><pre><code>	<span class="keyword">return</span> <a href="#line-475" class="ident">matchDomainConstraint</a>(<label for="r40" class="ident">mailbox</label>.<a href="#line-237" class="ident">domain</a>, <label for="r41" class="ident">constraint</label>)
}

</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> From RFC 5280, Section 4.2.1.10:</span><span class="comment">	 “a uniformResourceIdentifier that does not include an authority</span><span class="comment">	 component with a host name specified as a fully qualified domain</span><span class="comment">	 name (e.g., if the URI either does not include an authority</span><span class="comment">	 component or includes an authority component in which the host name</span><span class="comment">	 is specified as an IP address), then the application MUST reject the</span><span class="comment">	 certificate.”</span></div>
<div class="code"><pre><code>
	<label for="r47" class="ident">host</label> := <label for="r45" class="ident">uri</label>.<a href="../../net/url/url.go.html#line-362" class="ident">Host</a>
	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r47" class="ident">host</label>) == <span class="lit-number">0</span> {
		<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>, <a href="../../../pkg/fmt.html" class="ident i2">fmt</a>.<a href="../../fmt/errors.go.html#line-17" class="ident">Errorf</a>(<span class="lit-string">"URI with empty host (%q) cannot be matched against constraints"</span>, <label for="r45" class="ident">uri</label>.<a href="../../net/url/url.go.html#line-811" class="ident">String</a>())
	}

	<span class="keyword">if</span> <a href="../../../pkg/strings.html" class="ident i8">strings</a>.<a href="../../strings/strings.go.html#line-61" class="ident">Contains</a>(<label for="r47" class="ident">host</label>, <span class="lit-string">":"</span>) &amp;&amp; !<a href="../../../pkg/strings.html" class="ident i8">strings</a>.<a href="../../strings/strings.go.html#line-449" class="ident">HasSuffix</a>(<label for="r47" class="ident">host</label>, <span class="lit-string">"]"</span>) {
		<span class="keyword">var</span> <label for="r48" class="ident">err</label> <a href="../../../pkg/builtin.html#name-error" class="ident">error</a>
		<label for="r47" class="ident">host</label>, _, <label for="r48" class="ident">err</label> = <a href="../../../pkg/net.html" class="ident i3">net</a>.<a href="../../net/ipsock.go.html#line-156" class="ident">SplitHostPort</a>(<label for="r45" class="ident">uri</label>.<a href="../../net/url/url.go.html#line-362" class="ident">Host</a>)
		<span class="keyword">if</span> <label for="r48" class="ident">err</label> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
			<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>, <label for="r48" class="ident">err</label>
		}
	}

	<span class="keyword">if</span> <a href="../../../pkg/strings.html" class="ident i8">strings</a>.<a href="../../strings/strings.go.html#line-444" class="ident">HasPrefix</a>(<label for="r47" class="ident">host</label>, <span class="lit-string">"["</span>) &amp;&amp; <a href="../../../pkg/strings.html" class="ident i8">strings</a>.<a href="../../strings/strings.go.html#line-449" class="ident">HasSuffix</a>(<label for="r47" class="ident">host</label>, <span class="lit-string">"]"</span>) ||
		<a href="../../../pkg/net.html" class="ident i3">net</a>.<a href="../../net/ip.go.html#line-678" class="ident">ParseIP</a>(<label for="r47" class="ident">host</label>) != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
		<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>, <a href="../../../pkg/fmt.html" class="ident i2">fmt</a>.<a href="../../fmt/errors.go.html#line-17" class="ident">Errorf</a>(<span class="lit-string">"URI with IP (%q) cannot be matched against constraints"</span>, <label for="r45" class="ident">uri</label>.<a href="../../net/url/url.go.html#line-811" class="ident">String</a>())
	}

	<span class="keyword">return</span> <a href="#line-475" class="ident">matchDomainConstraint</a>(<label for="r47" class="ident">host</label>, <label for="r46" class="ident">constraint</label>)
}

<span class="keyword">func</span> <label for="r49" class="ident"><a href="../../../pkg/crypto/x509.html#name-matchIPConstraint" class="ident">matchIPConstraint</a></label>(<label for="r50" class="ident">ip</label> <a href="../../../pkg/net.html" class="ident i3">net</a>.<a href="../../net/ip.go.html#line-32" class="ident">IP</a>, <label for="r51" class="ident">constraint</label> *<a href="../../../pkg/net.html" class="ident i3">net</a>.<a href="../../net/ip.go.html#line-41" class="ident">IPNet</a>) (<a href="../../../pkg/builtin.html#name-bool" class="ident">bool</a>, <a href="../../../pkg/builtin.html#name-error" class="ident">error</a>) {
	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r50" class="ident">ip</label>) != <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r51" class="ident">constraint</label>.<a href="../../net/ip.go.html#line-42" class="ident">IP</a>) {
		<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>, <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>
	}

	<span class="keyword">for</span> <label for="r52" class="ident">i</label> := <span class="keyword">range</span> <label for="r50" class="ident">ip</label> {
		<span class="keyword">if</span> <label for="r53" class="ident">mask</label> := <label for="r51" class="ident">constraint</label>.<a href="../../net/ip.go.html#line-43" class="ident">Mask</a>[<label for="r52" class="ident">i</label>]; <label for="r50" class="ident">ip</label>[<label for="r52" class="ident">i</label>]&amp;<label for="r53" class="ident">mask</label> != <label for="r51" class="ident">constraint</label>.<a href="../../net/ip.go.html#line-42" class="ident">IP</a>[<label for="r52" class="ident">i</label>]&amp;<label for="r53" class="ident">mask</label> {
			<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>, <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>
		}
	}

	<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-true" class="ident">true</a>, <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>
}

</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> The meaning of zero length constraints is not specified, but this</span><span class="comment">	 code follows NSS and accepts them as matching everything.</span></div>
<div class="code"><pre><code>	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r56" class="ident">constraint</label>) == <span class="lit-number">0</span> {
		<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-true" class="ident">true</a>, <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>
	}

	<label for="r57" class="ident">domainLabels</label>, <label for="r58" class="ident">ok</label> := <a href="#line-382" class="ident">domainToReverseLabels</a>(<label for="r55" class="ident">domain</label>)
	<span class="keyword">if</span> !<label for="r58" class="ident">ok</label> {
		<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>, <a href="../../../pkg/fmt.html" class="ident i2">fmt</a>.<a href="../../fmt/errors.go.html#line-17" class="ident">Errorf</a>(<span class="lit-string">"x509: internal error: cannot parse domain %q"</span>, <label for="r55" class="ident">domain</label>)
	}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> RFC 5280 says that a leading period in a domain name means that at</span><span class="comment">	 least one label must be prepended, but only for URI and email</span><span class="comment">	 constraints, not DNS constraints. The code also supports that</span><span class="comment">	 behaviour for DNS constraints.</span></div>
<div class="code"><pre><code>
	<label for="r59" class="ident">mustHaveSubdomains</label> := <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
	<span class="keyword">if</span> <label for="r56" class="ident">constraint</label>[<span class="lit-number">0</span>] == <span class="lit-number">'.'</span> {
		<label for="r59" class="ident">mustHaveSubdomains</label> = <a href="../../../pkg/builtin.html#name-true" class="ident">true</a>
		<label for="r56" class="ident">constraint</label> = <label for="r56" class="ident">constraint</label>[<span class="lit-number">1</span>:]
	}

	<label for="r60" class="ident">constraintLabels</label>, <label for="r58" class="ident">ok</label> := <a href="#line-382" class="ident">domainToReverseLabels</a>(<label for="r56" class="ident">constraint</label>)
	<span class="keyword">if</span> !<label for="r58" class="ident">ok</label> {
		<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>, <a href="../../../pkg/fmt.html" class="ident i2">fmt</a>.<a href="../../fmt/errors.go.html#line-17" class="ident">Errorf</a>(<span class="lit-string">"x509: internal error: cannot parse domain %q"</span>, <label for="r56" class="ident">constraint</label>)
	}

	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r57" class="ident">domainLabels</label>) &lt; <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r60" class="ident">constraintLabels</label>) ||
		(<label for="r59" class="ident">mustHaveSubdomains</label> &amp;&amp; <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r57" class="ident">domainLabels</label>) == <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r60" class="ident">constraintLabels</label>)) {
		<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>, <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>
	}

	<span class="keyword">for</span> <label for="r61" class="ident">i</label>, <label for="r62" class="ident">constraintLabel</label> := <span class="keyword">range</span> <label for="r60" class="ident">constraintLabels</label> {
		<span class="keyword">if</span> !<a href="../../../pkg/strings.html" class="ident i8">strings</a>.<a href="../../strings/strings.go.html#line-970" class="ident">EqualFold</a>(<label for="r62" class="ident">constraintLabel</label>, <label for="r57" class="ident">domainLabels</label>[<label for="r61" class="ident">i</label>]) {
			<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>, <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>
		}
	}

	<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-true" class="ident">true</a>, <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> checkNameConstraints checks that c permits a child certificate to claim the</span><span class="comment"> given name, of type nameType. The argument parsedName contains the parsed</span><span class="comment"> form of name, suitable for passing to the match function. The total number</span><span class="comment"> of comparisons is tracked in the given count and should not exceed the given</span><span class="comment"> limit.</span></div>
<div class="code"><pre><code><span class="keyword">func</span> (<label for="r63" class="ident">c</label> *<a href="x509.go.html#line-629" class="ident">Certificate</a>) <label for="r64" class="ident"><a href="../../../use/crypto/x509..Certificate.checkNameConstraints*da171.html" class="ident">checkNameConstraints</a></label>(<label for="r65" class="ident">count</label> *<a href="../../../pkg/builtin.html#name-int" class="ident">int</a>,
	<label for="r66" class="ident">maxConstraintComparisons</label> <a href="../../../pkg/builtin.html#name-int" class="ident">int</a>,
	<label for="r67" class="ident">nameType</label> <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>,
	<label for="r68" class="ident">name</label> <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>,
	<label for="r69" class="ident">parsedName</label> <span class="keyword">interface</span>{},
	<label for="r70" class="ident">match</label> <span class="keyword">func</span>(<label for="r71" class="ident">parsedName</label>, <label for="r72" class="ident">constraint</label> <span class="keyword">interface</span>{}) (<label for="r73" class="ident">match</label> <a href="../../../pkg/builtin.html#name-bool" class="ident">bool</a>, <label for="r74" class="ident">err</label> <a href="../../../pkg/builtin.html#name-error" class="ident">error</a>),
	<label for="r75" class="ident">permitted</label>, <label for="r76" class="ident">excluded</label> <span class="keyword">interface</span>{}) <a href="../../../pkg/builtin.html#name-error" class="ident">error</a> {

	<label for="r77" class="ident">excludedValue</label> := <a href="../../../pkg/reflect.html" class="ident i6">reflect</a>.<a href="../../reflect/value.go.html#line-2351" class="ident">ValueOf</a>(<label for="r76" class="ident">excluded</label>)

	*<label for="r65" class="ident">count</label> += <label for="r77" class="ident">excludedValue</label>.<a href="../../reflect/value.go.html#line-1146" class="ident">Len</a>()
	<span class="keyword">if</span> *<label for="r65" class="ident">count</label> &gt; <label for="r66" class="ident">maxConstraintComparisons</label> {
		<span class="keyword">return</span> <a href="#line-72" class="ident">CertificateInvalidError</a>{<label for="r63" class="ident">c</label>, <a href="#line-64" class="ident">TooManyConstraints</a>, <span class="lit-string">""</span>}
	}

	<span class="keyword">for</span> <label for="r78" class="ident">i</label> := <span class="lit-number">0</span>; <label for="r78" class="ident">i</label> &lt; <label for="r77" class="ident">excludedValue</label>.<a href="../../reflect/value.go.html#line-1146" class="ident">Len</a>(); <label for="r78" class="ident">i</label>++ {
		<label for="r79" class="ident">constraint</label> := <label for="r77" class="ident">excludedValue</label>.<a href="../../reflect/value.go.html#line-938" class="ident">Index</a>(<label for="r78" class="ident">i</label>).<a href="../../reflect/value.go.html#line-1015" class="ident">Interface</a>()
		<label for="r80" class="ident">match</label>, <label for="r81" class="ident">err</label> := <label for="r70" class="ident">match</label>(<label for="r69" class="ident">parsedName</label>, <label for="r79" class="ident">constraint</label>)
		<span class="keyword">if</span> <label for="r81" class="ident">err</label> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
			<span class="keyword">return</span> <a href="#line-72" class="ident">CertificateInvalidError</a>{<label for="r63" class="ident">c</label>, <a href="#line-36" class="ident">CANotAuthorizedForThisName</a>, <label for="r81" class="ident">err</label>.Error()}
		}

		<span class="keyword">if</span> <label for="r80" class="ident">match</label> {
			<span class="keyword">return</span> <a href="#line-72" class="ident">CertificateInvalidError</a>{<label for="r63" class="ident">c</label>, <a href="#line-36" class="ident">CANotAuthorizedForThisName</a>, <a href="../../../pkg/fmt.html" class="ident i2">fmt</a>.<a href="../../fmt/print.go.html#line-217" class="ident">Sprintf</a>(<span class="lit-string">"%s %q is excluded by constraint %q"</span>, <label for="r67" class="ident">nameType</label>, <label for="r68" class="ident">name</label>, <label for="r79" class="ident">constraint</label>)}
		}
	}

	<label for="r82" class="ident">permittedValue</label> := <a href="../../../pkg/reflect.html" class="ident i6">reflect</a>.<a href="../../reflect/value.go.html#line-2351" class="ident">ValueOf</a>(<label for="r75" class="ident">permitted</label>)

	*<label for="r65" class="ident">count</label> += <label for="r82" class="ident">permittedValue</label>.<a href="../../reflect/value.go.html#line-1146" class="ident">Len</a>()
	<span class="keyword">if</span> *<label for="r65" class="ident">count</label> &gt; <label for="r66" class="ident">maxConstraintComparisons</label> {
		<span class="keyword">return</span> <a href="#line-72" class="ident">CertificateInvalidError</a>{<label for="r63" class="ident">c</label>, <a href="#line-64" class="ident">TooManyConstraints</a>, <span class="lit-string">""</span>}
	}

	<label for="r83" class="ident">ok</label> := <a href="../../../pkg/builtin.html#name-true" class="ident">true</a>
	<span class="keyword">for</span> <label for="r84" class="ident">i</label> := <span class="lit-number">0</span>; <label for="r84" class="ident">i</label> &lt; <label for="r82" class="ident">permittedValue</label>.<a href="../../reflect/value.go.html#line-1146" class="ident">Len</a>(); <label for="r84" class="ident">i</label>++ {
		<label for="r85" class="ident">constraint</label> := <label for="r82" class="ident">permittedValue</label>.<a href="../../reflect/value.go.html#line-938" class="ident">Index</a>(<label for="r84" class="ident">i</label>).<a href="../../reflect/value.go.html#line-1015" class="ident">Interface</a>()

		<span class="keyword">var</span> <label for="r86" class="ident">err</label> <a href="../../../pkg/builtin.html#name-error" class="ident">error</a>
		<span class="keyword">if</span> <label for="r83" class="ident">ok</label>, <label for="r86" class="ident">err</label> = <label for="r70" class="ident">match</label>(<label for="r69" class="ident">parsedName</label>, <label for="r85" class="ident">constraint</label>); <label for="r86" class="ident">err</label> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
			<span class="keyword">return</span> <a href="#line-72" class="ident">CertificateInvalidError</a>{<label for="r63" class="ident">c</label>, <a href="#line-36" class="ident">CANotAuthorizedForThisName</a>, <label for="r86" class="ident">err</label>.Error()}
		}

		<span class="keyword">if</span> <label for="r83" class="ident">ok</label> {
			<span class="keyword">break</span>
		}
	}

	<span class="keyword">if</span> !<label for="r83" class="ident">ok</label> {
		<span class="keyword">return</span> <a href="#line-72" class="ident">CertificateInvalidError</a>{<label for="r63" class="ident">c</label>, <a href="#line-36" class="ident">CANotAuthorizedForThisName</a>, <a href="../../../pkg/fmt.html" class="ident i2">fmt</a>.<a href="../../fmt/print.go.html#line-217" class="ident">Sprintf</a>(<span class="lit-string">"%s %q is not permitted by any constraint"</span>, <label for="r67" class="ident">nameType</label>, <label for="r68" class="ident">name</label>)}
	}

	<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> isValid performs validity checks on c given that it is a candidate to append</span><span class="comment"> to the chain in currentChain.</span></div>
<div class="code"><pre><code><span class="keyword">func</span> (<label for="r87" class="ident">c</label> *<a href="x509.go.html#line-629" class="ident">Certificate</a>) <label for="r88" class="ident"><a href="../../../use/crypto/x509..Certificate.isValid*5339b.html" class="ident">isValid</a></label>(<label for="r89" class="ident">certType</label> <a href="../../../pkg/builtin.html#name-int" class="ident">int</a>, <label for="r90" class="ident">currentChain</label> []*<a href="x509.go.html#line-629" class="ident">Certificate</a>, <label for="r91" class="ident">opts</label> *<a href="#line-197" class="ident">VerifyOptions</a>) <a href="../../../pkg/builtin.html#name-error" class="ident">error</a> {
	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r87" class="ident">c</label>.<a href="x509.go.html#line-669" class="ident">UnhandledCriticalExtensions</a>) &gt; <span class="lit-number">0</span> {
		<span class="keyword">return</span> <a href="x509.go.html#line-875" class="ident">UnhandledCriticalExtension</a>{}
	}

	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r90" class="ident">currentChain</label>) &gt; <span class="lit-number">0</span> {
		<label for="r92" class="ident">child</label> := <label for="r90" class="ident">currentChain</label>[<a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r90" class="ident">currentChain</label>)-<span class="lit-number">1</span>]
		<span class="keyword">if</span> !<a href="../../../pkg/bytes.html" class="ident i0">bytes</a>.<a href="../../bytes/bytes.go.html#line-18" class="ident">Equal</a>(<label for="r92" class="ident">child</label>.<a href="x509.go.html#line-634" class="ident">RawIssuer</a>, <label for="r87" class="ident">c</label>.<a href="x509.go.html#line-633" class="ident">RawSubject</a>) {
			<span class="keyword">return</span> <a href="#line-72" class="ident">CertificateInvalidError</a>{<label for="r87" class="ident">c</label>, <a href="#line-45" class="ident">NameMismatch</a>, <span class="lit-string">""</span>}
		}
	}

	<label for="r93" class="ident">now</label> := <label for="r91" class="ident">opts</label>.<a href="#line-212" class="ident">CurrentTime</a>
	<span class="keyword">if</span> <label for="r93" class="ident">now</label>.<a href="../../time/time.go.html#line-426" class="ident">IsZero</a>() {
		<label for="r93" class="ident">now</label> = <a href="../../../pkg/time.html" class="ident i9">time</a>.<a href="../../time/time.go.html#line-1066" class="ident">Now</a>()
	}
	<span class="keyword">if</span> <label for="r93" class="ident">now</label>.<a href="../../time/time.go.html#line-251" class="ident">Before</a>(<label for="r87" class="ident">c</label>.<a href="x509.go.html#line-646" class="ident">NotBefore</a>) {
		<span class="keyword">return</span> <a href="#line-72" class="ident">CertificateInvalidError</a>{
			<a href="#line-73" class="ident">Cert</a>:   <label for="r87" class="ident">c</label>,
			<a href="#line-74" class="ident">Reason</a>: <a href="#line-32" class="ident">Expired</a>,
			<a href="#line-75" class="ident">Detail</a>: <a href="../../../pkg/fmt.html" class="ident i2">fmt</a>.<a href="../../fmt/print.go.html#line-217" class="ident">Sprintf</a>(<span class="lit-string">"current time %s is before %s"</span>, <label for="r93" class="ident">now</label>.<a href="../../time/format.go.html#line-495" class="ident">Format</a>(<a href="../../../pkg/time.html" class="ident i9">time</a>.<a href="../../time/format.go.html#line-82" class="ident">RFC3339</a>), <label for="r87" class="ident">c</label>.<a href="x509.go.html#line-646" class="ident">NotBefore</a>.<a href="../../time/format.go.html#line-495" class="ident">Format</a>(<a href="../../../pkg/time.html" class="ident i9">time</a>.<a href="../../time/format.go.html#line-82" class="ident">RFC3339</a>)),
		}
	} <span class="keyword">else</span> <span class="keyword">if</span> <label for="r93" class="ident">now</label>.<a href="../../time/time.go.html#line-241" class="ident">After</a>(<label for="r87" class="ident">c</label>.<a href="x509.go.html#line-646" class="ident">NotAfter</a>) {
		<span class="keyword">return</span> <a href="#line-72" class="ident">CertificateInvalidError</a>{
			<a href="#line-73" class="ident">Cert</a>:   <label for="r87" class="ident">c</label>,
			<a href="#line-74" class="ident">Reason</a>: <a href="#line-32" class="ident">Expired</a>,
			<a href="#line-75" class="ident">Detail</a>: <a href="../../../pkg/fmt.html" class="ident i2">fmt</a>.<a href="../../fmt/print.go.html#line-217" class="ident">Sprintf</a>(<span class="lit-string">"current time %s is after %s"</span>, <label for="r93" class="ident">now</label>.<a href="../../time/format.go.html#line-495" class="ident">Format</a>(<a href="../../../pkg/time.html" class="ident i9">time</a>.<a href="../../time/format.go.html#line-82" class="ident">RFC3339</a>), <label for="r87" class="ident">c</label>.<a href="x509.go.html#line-646" class="ident">NotAfter</a>.<a href="../../time/format.go.html#line-495" class="ident">Format</a>(<a href="../../../pkg/time.html" class="ident i9">time</a>.<a href="../../time/format.go.html#line-82" class="ident">RFC3339</a>)),
		}
	}

	<label for="r94" class="ident">maxConstraintComparisons</label> := <label for="r91" class="ident">opts</label>.<a href="#line-224" class="ident">MaxConstraintComparisions</a>
	<span class="keyword">if</span> <label for="r94" class="ident">maxConstraintComparisons</label> == <span class="lit-number">0</span> {
		<label for="r94" class="ident">maxConstraintComparisons</label> = <span class="lit-number">250000</span>
	}
	<label for="r95" class="ident">comparisonCount</label> := <span class="lit-number">0</span>

	<span class="keyword">var</span> <label for="r96" class="ident">leaf</label> *<a href="x509.go.html#line-629" class="ident">Certificate</a>
	<span class="keyword">if</span> <label for="r89" class="ident">certType</label> == <a href="#line-229" class="ident">intermediateCertificate</a> || <label for="r89" class="ident">certType</label> == <a href="#line-230" class="ident">rootCertificate</a> {
		<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r90" class="ident">currentChain</label>) == <span class="lit-number">0</span> {
			<span class="keyword">return</span> <a href="../../../pkg/errors.html" class="ident i1">errors</a>.<a href="../../errors/errors.go.html#line-58" class="ident">New</a>(<span class="lit-string">"x509: internal error: empty chain when appending CA cert"</span>)
		}
		<label for="r96" class="ident">leaf</label> = <label for="r90" class="ident">currentChain</label>[<span class="lit-number">0</span>]
	}

	<label for="r97" class="ident">checkNameConstraints</label> := (<label for="r89" class="ident">certType</label> == <a href="#line-229" class="ident">intermediateCertificate</a> || <label for="r89" class="ident">certType</label> == <a href="#line-230" class="ident">rootCertificate</a>) &amp;&amp; <label for="r87" class="ident">c</label>.<a href="x509.go.html#line-793" class="ident">hasNameConstraints</a>()
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> This is the deprecated, legacy case of depending on the commonName as</span><span class="comment">		 a hostname. We don't enforce name constraints against the CN, but</span><span class="comment">		 VerifyHostname will look for hostnames in there if there are no SANs.</span><span class="comment">		 In order to ensure VerifyHostname will not accept an unchecked name,</span><span class="comment">		 return an error here.</span></div>
<div class="code"><pre><code>		<span class="keyword">return</span> <a href="#line-72" class="ident">CertificateInvalidError</a>{<label for="r87" class="ident">c</label>, <a href="#line-54" class="ident">NameConstraintsWithoutSANs</a>, <span class="lit-string">""</span>}
	} <span class="keyword">else</span> <span class="keyword">if</span> <label for="r97" class="ident">checkNameConstraints</label> &amp;&amp; <label for="r96" class="ident">leaf</label>.<a href="x509.go.html#line-757" class="ident">hasSANExtension</a>() {
		<label for="r98" class="ident">err</label> := <a href="x509.go.html#line-1019" class="ident">forEachSAN</a>(<label for="r96" class="ident">leaf</label>.<a href="x509.go.html#line-797" class="ident">getSANExtension</a>(), <span class="keyword">func</span>(<label for="r99" class="ident">tag</label> <a href="../../../pkg/builtin.html#name-int" class="ident">int</a>, <label for="r100" class="ident">data</label> []<a href="../../../pkg/builtin.html#name-byte" class="ident">byte</a>) <a href="../../../pkg/builtin.html#name-error" class="ident">error</a> {
			<span class="keyword">switch</span> <label for="r99" class="ident">tag</label> {
			<span class="keyword">case</span> <a href="x509.go.html#line-893" class="ident">nameTypeEmail</a>:
				<label for="r101" class="ident">name</label> := <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>(<label for="r100" class="ident">data</label>)
				<label for="r102" class="ident">mailbox</label>, <label for="r103" class="ident">ok</label> := <a href="#line-244" class="ident">parseRFC2821Mailbox</a>(<label for="r101" class="ident">name</label>)
				<span class="keyword">if</span> !<label for="r103" class="ident">ok</label> {
					<span class="keyword">return</span> <a href="../../../pkg/fmt.html" class="ident i2">fmt</a>.<a href="../../fmt/errors.go.html#line-17" class="ident">Errorf</a>(<span class="lit-string">"x509: cannot parse rfc822Name %q"</span>, <label for="r102" class="ident">mailbox</label>)
				}

				<span class="keyword">if</span> <label for="r104" class="ident">err</label> := <label for="r87" class="ident">c</label>.<a href="#line-522" class="ident">checkNameConstraints</a>(&amp;<label for="r95" class="ident">comparisonCount</label>, <label for="r94" class="ident">maxConstraintComparisons</label>, <span class="lit-string">"email address"</span>, <label for="r101" class="ident">name</label>, <label for="r102" class="ident">mailbox</label>,
					<span class="keyword">func</span>(<label for="r105" class="ident">parsedName</label>, <label for="r106" class="ident">constraint</label> <span class="keyword">interface</span>{}) (<a href="../../../pkg/builtin.html#name-bool" class="ident">bool</a>, <a href="../../../pkg/builtin.html#name-error" class="ident">error</a>) {
						<span class="keyword">return</span> <a href="#line-415" class="ident">matchEmailConstraint</a>(<label for="r105" class="ident">parsedName</label>.(<a href="#line-236" class="ident">rfc2821Mailbox</a>), <label for="r106" class="ident">constraint</label>.(<a href="../../../pkg/builtin.html#name-string" class="ident">string</a>))
					}, <label for="r87" class="ident">c</label>.<a href="x509.go.html#line-719" class="ident">PermittedEmailAddresses</a>, <label for="r87" class="ident">c</label>.<a href="x509.go.html#line-720" class="ident">ExcludedEmailAddresses</a>); <label for="r104" class="ident">err</label> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
					<span class="keyword">return</span> <label for="r104" class="ident">err</label>
				}

			<span class="keyword">case</span> <a href="x509.go.html#line-894" class="ident">nameTypeDNS</a>:
				<label for="r107" class="ident">name</label> := <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>(<label for="r100" class="ident">data</label>)
				<span class="keyword">if</span> <label for="r108" class="ident">_</label>, <label for="r109" class="ident">ok</label> := <a href="#line-382" class="ident">domainToReverseLabels</a>(<label for="r107" class="ident">name</label>); !<label for="r109" class="ident">ok</label> {
					<span class="keyword">return</span> <a href="../../../pkg/fmt.html" class="ident i2">fmt</a>.<a href="../../fmt/errors.go.html#line-17" class="ident">Errorf</a>(<span class="lit-string">"x509: cannot parse dnsName %q"</span>, <label for="r107" class="ident">name</label>)
				}

				<span class="keyword">if</span> <label for="r110" class="ident">err</label> := <label for="r87" class="ident">c</label>.<a href="#line-522" class="ident">checkNameConstraints</a>(&amp;<label for="r95" class="ident">comparisonCount</label>, <label for="r94" class="ident">maxConstraintComparisons</label>, <span class="lit-string">"DNS name"</span>, <label for="r107" class="ident">name</label>, <label for="r107" class="ident">name</label>,
					<span class="keyword">func</span>(<label for="r111" class="ident">parsedName</label>, <label for="r112" class="ident">constraint</label> <span class="keyword">interface</span>{}) (<a href="../../../pkg/builtin.html#name-bool" class="ident">bool</a>, <a href="../../../pkg/builtin.html#name-error" class="ident">error</a>) {
						<span class="keyword">return</span> <a href="#line-475" class="ident">matchDomainConstraint</a>(<label for="r111" class="ident">parsedName</label>.(<a href="../../../pkg/builtin.html#name-string" class="ident">string</a>), <label for="r112" class="ident">constraint</label>.(<a href="../../../pkg/builtin.html#name-string" class="ident">string</a>))
					}, <label for="r87" class="ident">c</label>.<a href="x509.go.html#line-715" class="ident">PermittedDNSDomains</a>, <label for="r87" class="ident">c</label>.<a href="x509.go.html#line-716" class="ident">ExcludedDNSDomains</a>); <label for="r110" class="ident">err</label> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
					<span class="keyword">return</span> <label for="r110" class="ident">err</label>
				}

			<span class="keyword">case</span> <a href="x509.go.html#line-895" class="ident">nameTypeURI</a>:
				<label for="r113" class="ident">name</label> := <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>(<label for="r100" class="ident">data</label>)
				<label for="r114" class="ident">uri</label>, <label for="r115" class="ident">err</label> := <a href="../../../pkg/net/url.html" class="ident i4">url</a>.<a href="../../net/url/url.go.html#line-475" class="ident">Parse</a>(<label for="r113" class="ident">name</label>)
				<span class="keyword">if</span> <label for="r115" class="ident">err</label> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
					<span class="keyword">return</span> <a href="../../../pkg/fmt.html" class="ident i2">fmt</a>.<a href="../../fmt/errors.go.html#line-17" class="ident">Errorf</a>(<span class="lit-string">"x509: internal error: URI SAN %q failed to parse"</span>, <label for="r113" class="ident">name</label>)
				}

				<span class="keyword">if</span> <label for="r116" class="ident">err</label> := <label for="r87" class="ident">c</label>.<a href="#line-522" class="ident">checkNameConstraints</a>(&amp;<label for="r95" class="ident">comparisonCount</label>, <label for="r94" class="ident">maxConstraintComparisons</label>, <span class="lit-string">"URI"</span>, <label for="r113" class="ident">name</label>, <label for="r114" class="ident">uri</label>,
					<span class="keyword">func</span>(<label for="r117" class="ident">parsedName</label>, <label for="r118" class="ident">constraint</label> <span class="keyword">interface</span>{}) (<a href="../../../pkg/builtin.html#name-bool" class="ident">bool</a>, <a href="../../../pkg/builtin.html#name-error" class="ident">error</a>) {
						<span class="keyword">return</span> <a href="#line-431" class="ident">matchURIConstraint</a>(<label for="r117" class="ident">parsedName</label>.(*<a href="../../../pkg/net/url.html" class="ident i4">url</a>.<a href="../../net/url/url.go.html#line-358" class="ident">URL</a>), <label for="r118" class="ident">constraint</label>.(<a href="../../../pkg/builtin.html#name-string" class="ident">string</a>))
					}, <label for="r87" class="ident">c</label>.<a href="x509.go.html#line-721" class="ident">PermittedURIDomains</a>, <label for="r87" class="ident">c</label>.<a href="x509.go.html#line-722" class="ident">ExcludedURIDomains</a>); <label for="r116" class="ident">err</label> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
					<span class="keyword">return</span> <label for="r116" class="ident">err</label>
				}

			<span class="keyword">case</span> <a href="x509.go.html#line-896" class="ident">nameTypeIP</a>:
				<label for="r119" class="ident">ip</label> := <a href="../../../pkg/net.html" class="ident i3">net</a>.<a href="../../net/ip.go.html#line-32" class="ident">IP</a>(<label for="r100" class="ident">data</label>)
				<span class="keyword">if</span> <label for="r120" class="ident">l</label> := <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r119" class="ident">ip</label>); <label for="r120" class="ident">l</label> != <a href="../../../pkg/net.html" class="ident i3">net</a>.<a href="../../net/ip.go.html#line-19" class="ident">IPv4len</a> &amp;&amp; <label for="r120" class="ident">l</label> != <a href="../../../pkg/net.html" class="ident i3">net</a>.<a href="../../net/ip.go.html#line-20" class="ident">IPv6len</a> {
					<span class="keyword">return</span> <a href="../../../pkg/fmt.html" class="ident i2">fmt</a>.<a href="../../fmt/errors.go.html#line-17" class="ident">Errorf</a>(<span class="lit-string">"x509: internal error: IP SAN %x failed to parse"</span>, <label for="r100" class="ident">data</label>)
				}

				<span class="keyword">if</span> <label for="r121" class="ident">err</label> := <label for="r87" class="ident">c</label>.<a href="#line-522" class="ident">checkNameConstraints</a>(&amp;<label for="r95" class="ident">comparisonCount</label>, <label for="r94" class="ident">maxConstraintComparisons</label>, <span class="lit-string">"IP address"</span>, <label for="r119" class="ident">ip</label>.<a href="../../net/ip.go.html#line-291" class="ident">String</a>(), <label for="r119" class="ident">ip</label>,
					<span class="keyword">func</span>(<label for="r122" class="ident">parsedName</label>, <label for="r123" class="ident">constraint</label> <span class="keyword">interface</span>{}) (<a href="../../../pkg/builtin.html#name-bool" class="ident">bool</a>, <a href="../../../pkg/builtin.html#name-error" class="ident">error</a>) {
						<span class="keyword">return</span> <a href="#line-461" class="ident">matchIPConstraint</a>(<label for="r122" class="ident">parsedName</label>.(<a href="../../../pkg/net.html" class="ident i3">net</a>.<a href="../../net/ip.go.html#line-32" class="ident">IP</a>), <label for="r123" class="ident">constraint</label>.(*<a href="../../../pkg/net.html" class="ident i3">net</a>.<a href="../../net/ip.go.html#line-41" class="ident">IPNet</a>))
					}, <label for="r87" class="ident">c</label>.<a href="x509.go.html#line-717" class="ident">PermittedIPRanges</a>, <label for="r87" class="ident">c</label>.<a href="x509.go.html#line-718" class="ident">ExcludedIPRanges</a>); <label for="r121" class="ident">err</label> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
					<span class="keyword">return</span> <label for="r121" class="ident">err</label>
				}

</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Unknown SAN types are ignored.</span></div>
<div class="code"><pre><code>			}

			<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>
		})

		<span class="keyword">if</span> <label for="r98" class="ident">err</label> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
			<span class="keyword">return</span> <label for="r98" class="ident">err</label>
		}
	}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> KeyUsage status flags are ignored. From Engineering Security, Peter</span><span class="comment">	 Gutmann: A European government CA marked its signing certificates as</span><span class="comment">	 being valid for encryption only, but no-one noticed. Another</span><span class="comment">	 European CA marked its signature keys as not being valid for</span><span class="comment">	 signatures. A different CA marked its own trusted root certificate</span><span class="comment">	 as being invalid for certificate signing. Another national CA</span><span class="comment">	 distributed a certificate to be used to encrypt data for the</span><span class="comment">	 country’s tax authority that was marked as only being usable for</span><span class="comment">	 digital signatures but not for encryption. Yet another CA reversed</span><span class="comment">	 the order of the bit flags in the keyUsage due to confusion over</span><span class="comment">	 encoding endianness, essentially setting a random keyUsage in</span><span class="comment">	 certificates that it issued. Another CA created a self-invalidating</span><span class="comment">	 certificate by adding a certificate policy statement stipulating</span><span class="comment">	 that the certificate had to be used strictly as specified in the</span><span class="comment">	 keyUsage, and a keyUsage containing a flag indicating that the RSA</span><span class="comment">	 encryption key could only be used for Diffie-Hellman key agreement.</span></div>
<div class="code"><pre><code>
	<span class="keyword">if</span> <label for="r89" class="ident">certType</label> == <a href="#line-229" class="ident">intermediateCertificate</a> &amp;&amp; (!<label for="r87" class="ident">c</label>.<a href="x509.go.html#line-676" class="ident">BasicConstraintsValid</a> || !<label for="r87" class="ident">c</label>.<a href="x509.go.html#line-677" class="ident">IsCA</a>) {
		<span class="keyword">return</span> <a href="#line-72" class="ident">CertificateInvalidError</a>{<label for="r87" class="ident">c</label>, <a href="#line-29" class="ident">NotAuthorizedToSign</a>, <span class="lit-string">""</span>}
	}

	<span class="keyword">if</span> <label for="r87" class="ident">c</label>.<a href="x509.go.html#line-676" class="ident">BasicConstraintsValid</a> &amp;&amp; <label for="r87" class="ident">c</label>.<a href="x509.go.html#line-691" class="ident">MaxPathLen</a> &gt;= <span class="lit-number">0</span> {
		<label for="r124" class="ident">numIntermediates</label> := <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r90" class="ident">currentChain</label>) - <span class="lit-number">1</span>
		<span class="keyword">if</span> <label for="r124" class="ident">numIntermediates</label> &gt; <label for="r87" class="ident">c</label>.<a href="x509.go.html#line-691" class="ident">MaxPathLen</a> {
			<span class="keyword">return</span> <a href="#line-72" class="ident">CertificateInvalidError</a>{<label for="r87" class="ident">c</label>, <a href="#line-39" class="ident">TooManyIntermediates</a>, <span class="lit-string">""</span>}
		}
	}

	<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Verify attempts to verify c by building one or more chains from c to a</span><span class="comment"> certificate in opts.Roots, using certificates in opts.Intermediates if</span><span class="comment"> needed. If successful, it returns one or more chains where the first</span><span class="comment"> element of the chain is c and the last element is from opts.Roots.</span><span class="comment"></span><span class="comment"> If opts.Roots is nil, the platform verifier might be used, and</span><span class="comment"> verification details might differ from what is described below. If system</span><span class="comment"> roots are unavailable the returned error will be of type SystemRootsError.</span><span class="comment"></span><span class="comment"> Name constraints in the intermediates will be applied to all names claimed</span><span class="comment"> in the chain, not just opts.DNSName. Thus it is invalid for a leaf to claim</span><span class="comment"> example.com if an intermediate doesn't permit it, even if example.com is not</span><span class="comment"> the name being validated. Note that DirectoryName constraints are not</span><span class="comment"> supported.</span><span class="comment"></span><span class="comment"> Name constraint validation follows the rules from RFC 5280, with the</span><span class="comment"> addition that DNS name constraints may use the leading period format</span><span class="comment"> defined for emails and URIs. When a constraint has a leading period</span><span class="comment"> it indicates that at least one additional label must be prepended to</span><span class="comment"> the constrained name to be considered valid.</span><span class="comment"></span><span class="comment"> Extended Key Usage values are enforced nested down a chain, so an intermediate</span><span class="comment"> or root that enumerates EKUs prevents a leaf from asserting an EKU not in that</span><span class="comment"> list. (While this is not specified, it is common practice in order to limit</span><span class="comment"> the types of certificates a CA can issue.)</span><span class="comment"></span><span class="comment"> WARNING: this function doesn't do any revocation checking.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Platform-specific verification needs the ASN.1 contents so</span><span class="comment">	 this makes the behavior consistent across platforms.</span></div>
<div class="code"><pre><code>	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r125" class="ident">c</label>.<a href="x509.go.html#line-630" class="ident">Raw</a>) == <span class="lit-number">0</span> {
		<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>, <a href="#line-194" class="ident">errNotParsed</a>
	}
	<span class="keyword">for</span> <label for="r130" class="ident">i</label> := <span class="lit-number">0</span>; <label for="r130" class="ident">i</label> &lt; <label for="r127" class="ident">opts</label>.<a href="#line-205" class="ident">Intermediates</a>.<a href="cert_pool.go.html#line-64" class="ident">len</a>(); <label for="r130" class="ident">i</label>++ {
		<label for="r131" class="ident">c</label>, <label for="r132" class="ident">err</label> := <label for="r127" class="ident">opts</label>.<a href="#line-205" class="ident">Intermediates</a>.<a href="cert_pool.go.html#line-72" class="ident">cert</a>(<label for="r130" class="ident">i</label>)
		<span class="keyword">if</span> <label for="r132" class="ident">err</label> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
			<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>, <a href="../../../pkg/fmt.html" class="ident i2">fmt</a>.<a href="../../fmt/errors.go.html#line-17" class="ident">Errorf</a>(<span class="lit-string">"crypto/x509: error fetching intermediate: %w"</span>, <label for="r132" class="ident">err</label>)
		}
		<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r131" class="ident">c</label>.<a href="x509.go.html#line-630" class="ident">Raw</a>) == <span class="lit-number">0</span> {
			<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>, <a href="#line-194" class="ident">errNotParsed</a>
		}
	}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Use Windows's own verification and chain building.</span></div>
<div class="code"><pre><code>	<span class="keyword">if</span> <label for="r127" class="ident">opts</label>.<a href="#line-208" class="ident">Roots</a> == <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> &amp;&amp; <a href="../../../pkg/runtime.html" class="ident i7">runtime</a>.<a href="../../runtime/extern.go.html#line-253" class="ident">GOOS</a> == <span class="lit-string">"windows"</span> {
		<span class="keyword">return</span> <label for="r125" class="ident">c</label>.<a href="root_darwin.go.html#line-19" class="ident">systemVerify</a>(&amp;<label for="r127" class="ident">opts</label>)
	}

	<span class="keyword">if</span> <label for="r127" class="ident">opts</label>.<a href="#line-208" class="ident">Roots</a> == <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
		<label for="r127" class="ident">opts</label>.<a href="#line-208" class="ident">Roots</a> = <a href="root.go.html#line-21" class="ident">systemRootsPool</a>()
		<span class="keyword">if</span> <label for="r127" class="ident">opts</label>.<a href="#line-208" class="ident">Roots</a> == <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
			<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>, <a href="#line-178" class="ident">SystemRootsError</a>{<a href="root.go.html#line-18" class="ident">systemRootsErr</a>}
		}
	}

	<label for="r129" class="ident">err</label> = <label for="r125" class="ident">c</label>.<a href="#line-579" class="ident">isValid</a>(<a href="#line-228" class="ident">leafCertificate</a>, <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>, &amp;<label for="r127" class="ident">opts</label>)
	<span class="keyword">if</span> <label for="r129" class="ident">err</label> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
		<span class="keyword">return</span>
	}

	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r127" class="ident">opts</label>.<a href="#line-200" class="ident">DNSName</a>) &gt; <span class="lit-number">0</span> {
		<label for="r129" class="ident">err</label> = <label for="r125" class="ident">c</label>.<a href="#line-1053" class="ident">VerifyHostname</a>(<label for="r127" class="ident">opts</label>.<a href="#line-200" class="ident">DNSName</a>)
		<span class="keyword">if</span> <label for="r129" class="ident">err</label> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
			<span class="keyword">return</span>
		}
	}

	<span class="keyword">var</span> <label for="r133" class="ident">candidateChains</label> [][]*<a href="x509.go.html#line-629" class="ident">Certificate</a>
	<span class="keyword">if</span> <label for="r127" class="ident">opts</label>.<a href="#line-208" class="ident">Roots</a>.<a href="cert_pool.go.html#line-160" class="ident">contains</a>(<label for="r125" class="ident">c</label>) {
		<label for="r133" class="ident">candidateChains</label> = <a href="../../../pkg/builtin.html#name-append" class="ident">append</a>(<label for="r133" class="ident">candidateChains</label>, []*<a href="x509.go.html#line-629" class="ident">Certificate</a>{<label for="r125" class="ident">c</label>})
	} <span class="keyword">else</span> {
		<span class="keyword">if</span> <label for="r133" class="ident">candidateChains</label>, <label for="r129" class="ident">err</label> = <label for="r125" class="ident">c</label>.<a href="#line-845" class="ident">buildChains</a>(<a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>, []*<a href="x509.go.html#line-629" class="ident">Certificate</a>{<label for="r125" class="ident">c</label>}, <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>, &amp;<label for="r127" class="ident">opts</label>); <label for="r129" class="ident">err</label> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
			<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>, <label for="r129" class="ident">err</label>
		}
	}

	<label for="r134" class="ident">keyUsages</label> := <label for="r127" class="ident">opts</label>.<a href="#line-217" class="ident">KeyUsages</a>
	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r134" class="ident">keyUsages</label>) == <span class="lit-number">0</span> {
		<label for="r134" class="ident">keyUsages</label> = []<a href="x509.go.html#line-570" class="ident">ExtKeyUsage</a>{<a href="x509.go.html#line-574" class="ident">ExtKeyUsageServerAuth</a>}
	}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> If any key usage is acceptable then we're done.</span></div>
<div class="code"><pre><code>	<span class="keyword">for</span> <label for="r135" class="ident">_</label>, <label for="r136" class="ident">usage</label> := <span class="keyword">range</span> <label for="r134" class="ident">keyUsages</label> {
		<span class="keyword">if</span> <label for="r136" class="ident">usage</label> == <a href="x509.go.html#line-573" class="ident">ExtKeyUsageAny</a> {
			<span class="keyword">return</span> <label for="r133" class="ident">candidateChains</label>, <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>
		}
	}

	<span class="keyword">for</span> <label for="r137" class="ident">_</label>, <label for="r138" class="ident">candidate</label> := <span class="keyword">range</span> <label for="r133" class="ident">candidateChains</label> {
		<span class="keyword">if</span> <a href="#line-1098" class="ident">checkChainForKeyUsage</a>(<label for="r138" class="ident">candidate</label>, <label for="r134" class="ident">keyUsages</label>) {
			<label for="r128" class="ident">chains</label> = <a href="../../../pkg/builtin.html#name-append" class="ident">append</a>(<label for="r128" class="ident">chains</label>, <label for="r138" class="ident">candidate</label>)
		}
	}

	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r128" class="ident">chains</label>) == <span class="lit-number">0</span> {
		<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>, <a href="#line-72" class="ident">CertificateInvalidError</a>{<label for="r125" class="ident">c</label>, <a href="#line-42" class="ident">IncompatibleUsage</a>, <span class="lit-string">""</span>}
	}

	<span class="keyword">return</span> <label for="r128" class="ident">chains</label>, <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>
}

<span class="keyword">func</span> <label for="r139" class="ident"><a href="../../../pkg/crypto/x509.html#name-appendToFreshChain" class="ident">appendToFreshChain</a></label>(<label for="r140" class="ident">chain</label> []*<a href="x509.go.html#line-629" class="ident">Certificate</a>, <label for="r141" class="ident">cert</label> *<a href="x509.go.html#line-629" class="ident">Certificate</a>) []*<a href="x509.go.html#line-629" class="ident">Certificate</a> {
	<label for="r142" class="ident">n</label> := <a href="../../../pkg/builtin.html#name-make" class="ident">make</a>([]*<a href="x509.go.html#line-629" class="ident">Certificate</a>, <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r140" class="ident">chain</label>)+<span class="lit-number">1</span>)
	<a href="../../../pkg/builtin.html#name-copy" class="ident">copy</a>(<label for="r142" class="ident">n</label>, <label for="r140" class="ident">chain</label>)
	<label for="r142" class="ident">n</label>[<a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r140" class="ident">chain</label>)] = <label for="r141" class="ident">cert</label>
	<span class="keyword">return</span> <label for="r142" class="ident">n</label>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> maxChainSignatureChecks is the maximum number of CheckSignatureFrom calls</span><span class="comment"> that an invocation of buildChains will (tranistively) make. Most chains are</span><span class="comment"> less than 15 certificates long, so this leaves space for multiple chains and</span><span class="comment"> for failed checks due to different intermediates having the same Subject.</span></div>
<div class="code"><pre><code><span class="keyword">const</span> <a href="../../../pkg/crypto/x509.html#name-maxChainSignatureChecks" class="ident">maxChainSignatureChecks</a> = <span class="lit-number">100</span>

<span class="keyword">func</span> (<label for="r143" class="ident">c</label> *<a href="x509.go.html#line-629" class="ident">Certificate</a>) <label for="r144" class="ident"><a href="../../../use/crypto/x509..Certificate.buildChains*bda2f.html" class="ident">buildChains</a></label>(<label for="r145" class="ident">cache</label> <span class="keyword">map</span>[*<a href="x509.go.html#line-629" class="ident">Certificate</a>][][]*<a href="x509.go.html#line-629" class="ident">Certificate</a>, <label for="r146" class="ident">currentChain</label> []*<a href="x509.go.html#line-629" class="ident">Certificate</a>, <label for="r147" class="ident">sigChecks</label> *<a href="../../../pkg/builtin.html#name-int" class="ident">int</a>, <label for="r148" class="ident">opts</label> *<a href="#line-197" class="ident">VerifyOptions</a>) (<label for="r149" class="ident">chains</label> [][]*<a href="x509.go.html#line-629" class="ident">Certificate</a>, <label for="r150" class="ident">err</label> <a href="../../../pkg/builtin.html#name-error" class="ident">error</a>) {
	<span class="keyword">var</span> (
		<label for="r151" class="ident">hintErr</label>  <a href="../../../pkg/builtin.html#name-error" class="ident">error</a>
		<label for="r152" class="ident">hintCert</label> *<a href="x509.go.html#line-629" class="ident">Certificate</a>
	)

	<label for="r153" class="ident">considerCandidate</label> := <span class="keyword">func</span>(<label for="r154" class="ident">certType</label> <a href="../../../pkg/builtin.html#name-int" class="ident">int</a>, <label for="r155" class="ident">candidate</label> *<a href="x509.go.html#line-629" class="ident">Certificate</a>) {
		<span class="keyword">for</span> <label for="r156" class="ident">_</label>, <label for="r157" class="ident">cert</label> := <span class="keyword">range</span> <label for="r146" class="ident">currentChain</label> {
			<span class="keyword">if</span> <label for="r157" class="ident">cert</label>.<a href="x509.go.html#line-750" class="ident">Equal</a>(<label for="r155" class="ident">candidate</label>) {
				<span class="keyword">return</span>
			}
		}

		<span class="keyword">if</span> <label for="r147" class="ident">sigChecks</label> == <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
			<label for="r147" class="ident">sigChecks</label> = <a href="../../../pkg/builtin.html#name-new" class="ident">new</a>(<a href="../../../pkg/builtin.html#name-int" class="ident">int</a>)
		}
		*<label for="r147" class="ident">sigChecks</label>++
		<span class="keyword">if</span> *<label for="r147" class="ident">sigChecks</label> &gt; <a href="#line-843" class="ident">maxChainSignatureChecks</a> {
			<label for="r150" class="ident">err</label> = <a href="../../../pkg/errors.html" class="ident i1">errors</a>.<a href="../../errors/errors.go.html#line-58" class="ident">New</a>(<span class="lit-string">"x509: signature check attempts limit reached while verifying certificate chain"</span>)
			<span class="keyword">return</span>
		}

		<span class="keyword">if</span> <label for="r158" class="ident">err</label> := <label for="r143" class="ident">c</label>.<a href="x509.go.html#line-763" class="ident">CheckSignatureFrom</a>(<label for="r155" class="ident">candidate</label>); <label for="r158" class="ident">err</label> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
			<span class="keyword">if</span> <label for="r151" class="ident">hintErr</label> == <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
				<label for="r151" class="ident">hintErr</label> = <label for="r158" class="ident">err</label>
				<label for="r152" class="ident">hintCert</label> = <label for="r155" class="ident">candidate</label>
			}
			<span class="keyword">return</span>
		}

		<label for="r150" class="ident">err</label> = <label for="r155" class="ident">candidate</label>.<a href="#line-579" class="ident">isValid</a>(<label for="r154" class="ident">certType</label>, <label for="r146" class="ident">currentChain</label>, <label for="r148" class="ident">opts</label>)
		<span class="keyword">if</span> <label for="r150" class="ident">err</label> != <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
			<span class="keyword">return</span>
		}

		<span class="keyword">switch</span> <label for="r154" class="ident">certType</label> {
		<span class="keyword">case</span> <a href="#line-230" class="ident">rootCertificate</a>:
			<label for="r149" class="ident">chains</label> = <a href="../../../pkg/builtin.html#name-append" class="ident">append</a>(<label for="r149" class="ident">chains</label>, <a href="#line-832" class="ident">appendToFreshChain</a>(<label for="r146" class="ident">currentChain</label>, <label for="r155" class="ident">candidate</label>))
		<span class="keyword">case</span> <a href="#line-229" class="ident">intermediateCertificate</a>:
			<span class="keyword">if</span> <label for="r145" class="ident">cache</label> == <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
				<label for="r145" class="ident">cache</label> = <a href="../../../pkg/builtin.html#name-make" class="ident">make</a>(<span class="keyword">map</span>[*<a href="x509.go.html#line-629" class="ident">Certificate</a>][][]*<a href="x509.go.html#line-629" class="ident">Certificate</a>)
			}
			<label for="r159" class="ident">childChains</label>, <label for="r160" class="ident">ok</label> := <label for="r145" class="ident">cache</label>[<label for="r155" class="ident">candidate</label>]
			<span class="keyword">if</span> !<label for="r160" class="ident">ok</label> {
				<label for="r159" class="ident">childChains</label>, <label for="r150" class="ident">err</label> = <label for="r155" class="ident">candidate</label>.<label for="r144" class="ident">buildChains</label>(<label for="r145" class="ident">cache</label>, <a href="#line-832" class="ident">appendToFreshChain</a>(<label for="r146" class="ident">currentChain</label>, <label for="r155" class="ident">candidate</label>), <label for="r147" class="ident">sigChecks</label>, <label for="r148" class="ident">opts</label>)
				<label for="r145" class="ident">cache</label>[<label for="r155" class="ident">candidate</label>] = <label for="r159" class="ident">childChains</label>
			}
			<label for="r149" class="ident">chains</label> = <a href="../../../pkg/builtin.html#name-append" class="ident">append</a>(<label for="r149" class="ident">chains</label>, <label for="r159" class="ident">childChains</label>...)
		}
	}

	<span class="keyword">for</span> <label for="r161" class="ident">_</label>, <label for="r162" class="ident">root</label> := <span class="keyword">range</span> <label for="r148" class="ident">opts</label>.<a href="#line-208" class="ident">Roots</a>.<a href="cert_pool.go.html#line-120" class="ident">findPotentialParents</a>(<label for="r143" class="ident">c</label>) {
		<label for="r153" class="ident">considerCandidate</label>(<a href="#line-230" class="ident">rootCertificate</a>, <label for="r162" class="ident">root</label>)
	}
	<span class="keyword">for</span> <label for="r163" class="ident">_</label>, <label for="r164" class="ident">intermediate</label> := <span class="keyword">range</span> <label for="r148" class="ident">opts</label>.<a href="#line-205" class="ident">Intermediates</a>.<a href="cert_pool.go.html#line-120" class="ident">findPotentialParents</a>(<label for="r143" class="ident">c</label>) {
		<label for="r153" class="ident">considerCandidate</label>(<a href="#line-229" class="ident">intermediateCertificate</a>, <label for="r164" class="ident">intermediate</label>)
	}

	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r149" class="ident">chains</label>) &gt; <span class="lit-number">0</span> {
		<label for="r150" class="ident">err</label> = <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>
	}
	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r149" class="ident">chains</label>) == <span class="lit-number">0</span> &amp;&amp; <label for="r150" class="ident">err</label> == <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a> {
		<label for="r150" class="ident">err</label> = <a href="#line-151" class="ident">UnknownAuthorityError</a>{<label for="r143" class="ident">c</label>, <label for="r151" class="ident">hintErr</label>, <label for="r152" class="ident">hintCert</label>}
	}

	<span class="keyword">return</span>
}

<span class="keyword">func</span> <label for="r165" class="ident"><a href="../../../pkg/crypto/x509.html#name-validHostnamePattern" class="ident">validHostnamePattern</a></label>(<label for="r166" class="ident">host</label> <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>) <a href="../../../pkg/builtin.html#name-bool" class="ident">bool</a> { <span class="keyword">return</span> <a href="#line-919" class="ident">validHostname</a>(<label for="r166" class="ident">host</label>, <a href="../../../pkg/builtin.html#name-true" class="ident">true</a>) }
<span class="keyword">func</span> <label for="r167" class="ident"><a href="../../../pkg/crypto/x509.html#name-validHostnameInput" class="ident">validHostnameInput</a></label>(<label for="r168" class="ident">host</label> <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>) <a href="../../../pkg/builtin.html#name-bool" class="ident">bool</a>   { <span class="keyword">return</span> <a href="#line-919" class="ident">validHostname</a>(<label for="r168" class="ident">host</label>, <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>) }
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> validHostname reports whether host is a valid hostname that can be matched or</span><span class="comment"> matched against according to RFC 6125 2.2, with some leniency to accommodate</span><span class="comment"> legacy values.</span></div>
<div class="code"><pre><code><span class="keyword">func</span> <label for="r169" class="ident"><a href="../../../pkg/crypto/x509.html#name-validHostname" class="ident">validHostname</a></label>(<label for="r170" class="ident">host</label> <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>, <label for="r171" class="ident">isPattern</label> <a href="../../../pkg/builtin.html#name-bool" class="ident">bool</a>) <a href="../../../pkg/builtin.html#name-bool" class="ident">bool</a> {
	<span class="keyword">if</span> !<label for="r171" class="ident">isPattern</label> {
		<label for="r170" class="ident">host</label> = <a href="../../../pkg/strings.html" class="ident i8">strings</a>.<a href="../../strings/strings.go.html#line-911" class="ident">TrimSuffix</a>(<label for="r170" class="ident">host</label>, <span class="lit-string">"."</span>)
	}
	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r170" class="ident">host</label>) == <span class="lit-number">0</span> {
		<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
	}

	<span class="keyword">for</span> <label for="r172" class="ident">i</label>, <label for="r173" class="ident">part</label> := <span class="keyword">range</span> <a href="../../../pkg/strings.html" class="ident i8">strings</a>.<a href="../../strings/strings.go.html#line-299" class="ident">Split</a>(<label for="r170" class="ident">host</label>, <span class="lit-string">"."</span>) {
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Empty label.</span></div>
<div class="code"><pre><code>			<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
		}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Only allow full left-most wildcards, as those are the only ones</span><span class="comment">			 we match, and matching literal '*' characters is probably never</span><span class="comment">			 the expected behavior.</span></div>
<div class="code"><pre><code>			<span class="keyword">continue</span>
		}
		<span class="keyword">for</span> <label for="r174" class="ident">j</label>, <label for="r175" class="ident">c</label> := <span class="keyword">range</span> <label for="r173" class="ident">part</label> {
			<span class="keyword">if</span> <span class="lit-number">'a'</span> &lt;= <label for="r175" class="ident">c</label> &amp;&amp; <label for="r175" class="ident">c</label> &lt;= <span class="lit-number">'z'</span> {
				<span class="keyword">continue</span>
			}
			<span class="keyword">if</span> <span class="lit-number">'0'</span> &lt;= <label for="r175" class="ident">c</label> &amp;&amp; <label for="r175" class="ident">c</label> &lt;= <span class="lit-number">'9'</span> {
				<span class="keyword">continue</span>
			}
			<span class="keyword">if</span> <span class="lit-number">'A'</span> &lt;= <label for="r175" class="ident">c</label> &amp;&amp; <label for="r175" class="ident">c</label> &lt;= <span class="lit-number">'Z'</span> {
				<span class="keyword">continue</span>
			}
			<span class="keyword">if</span> <label for="r175" class="ident">c</label> == <span class="lit-number">'-'</span> &amp;&amp; <label for="r174" class="ident">j</label> != <span class="lit-number">0</span> {
				<span class="keyword">continue</span>
			}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Not a valid character in hostnames, but commonly</span><span class="comment">				 found in deployments outside the WebPKI.</span></div>
<div class="code"><pre><code>				<span class="keyword">continue</span>
			}
			<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
		}
	}

	<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-true" class="ident">true</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> commonNameAsHostname reports whether the Common Name field should be</span><span class="comment"> considered the hostname that the certificate is valid for. This is a legacy</span><span class="comment"> behavior, disabled by default or if the Subject Alt Name extension is present.</span><span class="comment"></span><span class="comment"> It applies the strict validHostname check to the Common Name field, so that</span><span class="comment"> certificates without SANs can still be validated against CAs with name</span><span class="comment"> constraints if there is no risk the CN would be matched as a hostname.</span><span class="comment"> See NameConstraintsWithoutSANs and issue 24151.</span></div>
<div class="code"><pre><code><span class="keyword">func</span> (<label for="r176" class="ident">c</label> *<a href="x509.go.html#line-629" class="ident">Certificate</a>) <label for="r177" class="ident"><a href="../../../use/crypto/x509..Certificate.commonNameAsHostname*32a88.html" class="ident">commonNameAsHostname</a></label>() <a href="../../../pkg/builtin.html#name-bool" class="ident">bool</a> {
	<span class="keyword">return</span> !<a href="#line-22" class="ident">ignoreCN</a> &amp;&amp; !<label for="r176" class="ident">c</label>.<a href="x509.go.html#line-757" class="ident">hasSANExtension</a>() &amp;&amp; <a href="#line-913" class="ident">validHostnamePattern</a>(<label for="r176" class="ident">c</label>.<a href="x509.go.html#line-645" class="ident">Subject</a>.<a href="pkix/pkix.go.html#line-127" class="ident">CommonName</a>)
}

<span class="keyword">func</span> <label for="r178" class="ident"><a href="../../../pkg/crypto/x509.html#name-matchExactly" class="ident">matchExactly</a></label>(<label for="r179" class="ident">hostA</label>, <label for="r180" class="ident">hostB</label> <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>) <a href="../../../pkg/builtin.html#name-bool" class="ident">bool</a> {
	<span class="keyword">if</span> <label for="r179" class="ident">hostA</label> == <span class="lit-string">""</span> || <label for="r179" class="ident">hostA</label> == <span class="lit-string">"."</span> || <label for="r180" class="ident">hostB</label> == <span class="lit-string">""</span> || <label for="r180" class="ident">hostB</label> == <span class="lit-string">"."</span> {
		<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
	}
	<span class="keyword">return</span> <a href="#line-1012" class="ident">toLowerCaseASCII</a>(<label for="r179" class="ident">hostA</label>) == <a href="#line-1012" class="ident">toLowerCaseASCII</a>(<label for="r180" class="ident">hostB</label>)
}

<span class="keyword">func</span> <label for="r181" class="ident"><a href="../../../pkg/crypto/x509.html#name-matchHostnames" class="ident">matchHostnames</a></label>(<label for="r182" class="ident">pattern</label>, <label for="r183" class="ident">host</label> <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>) <a href="../../../pkg/builtin.html#name-bool" class="ident">bool</a> {
	<label for="r182" class="ident">pattern</label> = <a href="#line-1012" class="ident">toLowerCaseASCII</a>(<label for="r182" class="ident">pattern</label>)
	<label for="r183" class="ident">host</label> = <a href="#line-1012" class="ident">toLowerCaseASCII</a>(<a href="../../../pkg/strings.html" class="ident i8">strings</a>.<a href="../../strings/strings.go.html#line-911" class="ident">TrimSuffix</a>(<label for="r183" class="ident">host</label>, <span class="lit-string">"."</span>))

	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r182" class="ident">pattern</label>) == <span class="lit-number">0</span> || <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r183" class="ident">host</label>) == <span class="lit-number">0</span> {
		<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
	}

	<label for="r184" class="ident">patternParts</label> := <a href="../../../pkg/strings.html" class="ident i8">strings</a>.<a href="../../strings/strings.go.html#line-299" class="ident">Split</a>(<label for="r182" class="ident">pattern</label>, <span class="lit-string">"."</span>)
	<label for="r185" class="ident">hostParts</label> := <a href="../../../pkg/strings.html" class="ident i8">strings</a>.<a href="../../strings/strings.go.html#line-299" class="ident">Split</a>(<label for="r183" class="ident">host</label>, <span class="lit-string">"."</span>)

	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r184" class="ident">patternParts</label>) != <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r185" class="ident">hostParts</label>) {
		<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
	}

	<span class="keyword">for</span> <label for="r186" class="ident">i</label>, <label for="r187" class="ident">patternPart</label> := <span class="keyword">range</span> <label for="r184" class="ident">patternParts</label> {
		<span class="keyword">if</span> <label for="r186" class="ident">i</label> == <span class="lit-number">0</span> &amp;&amp; <label for="r187" class="ident">patternPart</label> == <span class="lit-string">"*"</span> {
			<span class="keyword">continue</span>
		}
		<span class="keyword">if</span> <label for="r187" class="ident">patternPart</label> != <label for="r185" class="ident">hostParts</label>[<label for="r186" class="ident">i</label>] {
			<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
		}
	}

	<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-true" class="ident">true</a>
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> toLowerCaseASCII returns a lower-case version of in. See RFC 6125 6.4.1. We use</span><span class="comment"> an explicitly ASCII function to avoid any sharp corners resulting from</span><span class="comment"> performing Unicode operations on DNS labels.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> If the string is already lower-case then there's nothing to do.</span></div>
<div class="code"><pre><code>	<label for="r190" class="ident">isAlreadyLowerCase</label> := <a href="../../../pkg/builtin.html#name-true" class="ident">true</a>
	<span class="keyword">for</span> <label for="r191" class="ident">_</label>, <label for="r192" class="ident">c</label> := <span class="keyword">range</span> <label for="r189" class="ident">in</label> {
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> If we get a UTF-8 error then there might be</span><span class="comment">			 upper-case ASCII bytes in the invalid sequence.</span></div>
<div class="code"><pre><code>			<label for="r190" class="ident">isAlreadyLowerCase</label> = <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
			<span class="keyword">break</span>
		}
		<span class="keyword">if</span> <span class="lit-number">'A'</span> &lt;= <label for="r192" class="ident">c</label> &amp;&amp; <label for="r192" class="ident">c</label> &lt;= <span class="lit-number">'Z'</span> {
			<label for="r190" class="ident">isAlreadyLowerCase</label> = <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
			<span class="keyword">break</span>
		}
	}

	<span class="keyword">if</span> <label for="r190" class="ident">isAlreadyLowerCase</label> {
		<span class="keyword">return</span> <label for="r189" class="ident">in</label>
	}

	<label for="r193" class="ident">out</label> := []<a href="../../../pkg/builtin.html#name-byte" class="ident">byte</a>(<label for="r189" class="ident">in</label>)
	<span class="keyword">for</span> <label for="r194" class="ident">i</label>, <label for="r195" class="ident">c</label> := <span class="keyword">range</span> <label for="r193" class="ident">out</label> {
		<span class="keyword">if</span> <span class="lit-number">'A'</span> &lt;= <label for="r195" class="ident">c</label> &amp;&amp; <label for="r195" class="ident">c</label> &lt;= <span class="lit-number">'Z'</span> {
			<label for="r193" class="ident">out</label>[<label for="r194" class="ident">i</label>] += <span class="lit-number">'a'</span> - <span class="lit-number">'A'</span>
		}
	}
	<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-string" class="ident">string</a>(<label for="r193" class="ident">out</label>)
}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> VerifyHostname returns nil if c is a valid certificate for the named host.</span><span class="comment"> Otherwise it returns an error describing the mismatch.</span><span class="comment"></span><span class="comment"> IP addresses can be optionally enclosed in square brackets and are checked</span><span class="comment"> against the IPAddresses field. Other names are checked case insensitively</span><span class="comment"> against the DNSNames field. If the names are valid hostnames, the certificate</span><span class="comment"> fields can have a wildcard as the left-most label.</span><span class="comment"></span><span class="comment"> The legacy Common Name field is ignored unless it's a valid hostname, the</span><span class="comment"> certificate doesn't have any Subject Alternative Names, and the GODEBUG</span><span class="comment"> environment variable is set to "x509ignoreCN=0". Support for Common Name is</span><span class="comment"> deprecated will be entirely removed in the future.</span></div>
<div class="code"><pre><code></code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> IP addresses may be written in [ ].</span></div>
<div class="code"><pre><code>	<label for="r199" class="ident">candidateIP</label> := <label for="r198" class="ident">h</label>
	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r198" class="ident">h</label>) &gt;= <span class="lit-number">3</span> &amp;&amp; <label for="r198" class="ident">h</label>[<span class="lit-number">0</span>] == <span class="lit-number">'['</span> &amp;&amp; <label for="r198" class="ident">h</label>[<a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r198" class="ident">h</label>)-<span class="lit-number">1</span>] == <span class="lit-number">']'</span> {
		<label for="r199" class="ident">candidateIP</label> = <label for="r198" class="ident">h</label>[<span class="lit-number">1</span> : <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r198" class="ident">h</label>)-<span class="lit-number">1</span>]
	}
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> We only match IP addresses against IP SANs.</span><span class="comment">		 See RFC 6125, Appendix B.2.</span></div>
<div class="code"><pre><code>		<span class="keyword">for</span> <label for="r201" class="ident">_</label>, <label for="r202" class="ident">candidate</label> := <span class="keyword">range</span> <label for="r196" class="ident">c</label>.<a href="x509.go.html#line-710" class="ident">IPAddresses</a> {
			<span class="keyword">if</span> <label for="r200" class="ident">ip</label>.<a href="../../net/ip.go.html#line-410" class="ident">Equal</a>(<label for="r202" class="ident">candidate</label>) {
				<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>
			}
		}
		<span class="keyword">return</span> <a href="#line-104" class="ident">HostnameError</a>{<label for="r196" class="ident">c</label>, <label for="r199" class="ident">candidateIP</label>}
	}

	<label for="r203" class="ident">names</label> := <label for="r196" class="ident">c</label>.<a href="x509.go.html#line-708" class="ident">DNSNames</a>
	<span class="keyword">if</span> <label for="r196" class="ident">c</label>.<a href="#line-971" class="ident">commonNameAsHostname</a>() {
		<label for="r203" class="ident">names</label> = []<a href="../../../pkg/builtin.html#name-string" class="ident">string</a>{<label for="r196" class="ident">c</label>.<a href="x509.go.html#line-645" class="ident">Subject</a>.<a href="pkix/pkix.go.html#line-127" class="ident">CommonName</a>}
	}

	<label for="r204" class="ident">candidateName</label> := <a href="#line-1012" class="ident">toLowerCaseASCII</a>(<label for="r198" class="ident">h</label>) <span class="comment">// Save allocations inside the loop.</span>
	<label for="r205" class="ident">validCandidateName</label> := <a href="#line-914" class="ident">validHostnameInput</a>(<label for="r204" class="ident">candidateName</label>)

</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> Ideally, we'd only match valid hostnames according to RFC 6125 like</span><span class="comment">		 browsers (more or less) do, but in practice Go is used in a wider</span><span class="comment">		 array of contexts and can't even assume DNS resolution. Instead,</span><span class="comment">		 always allow perfect matches, and only apply wildcard and trailing</span><span class="comment">		 dot processing to valid hostnames.</span></div>
<div class="code"><pre><code>		<span class="keyword">if</span> <label for="r205" class="ident">validCandidateName</label> &amp;&amp; <a href="#line-913" class="ident">validHostnamePattern</a>(<label for="r207" class="ident">match</label>) {
			<span class="keyword">if</span> <a href="#line-982" class="ident">matchHostnames</a>(<label for="r207" class="ident">match</label>, <label for="r204" class="ident">candidateName</label>) {
				<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>
			}
		} <span class="keyword">else</span> {
			<span class="keyword">if</span> <a href="#line-975" class="ident">matchExactly</a>(<label for="r207" class="ident">match</label>, <label for="r204" class="ident">candidateName</label>) {
				<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-nil" class="ident">nil</a>
			}
		}
	}

	<span class="keyword">return</span> <a href="#line-104" class="ident">HostnameError</a>{<label for="r196" class="ident">c</label>, <label for="r198" class="ident">h</label>}
}

<span class="keyword">func</span> <label for="r208" class="ident"><a href="../../../pkg/crypto/x509.html#name-checkChainForKeyUsage" class="ident">checkChainForKeyUsage</a></label>(<label for="r209" class="ident">chain</label> []*<a href="x509.go.html#line-629" class="ident">Certificate</a>, <label for="r210" class="ident">keyUsages</label> []<a href="x509.go.html#line-570" class="ident">ExtKeyUsage</a>) <a href="../../../pkg/builtin.html#name-bool" class="ident">bool</a> {
	<label for="r211" class="ident">usages</label> := <a href="../../../pkg/builtin.html#name-make" class="ident">make</a>([]<a href="x509.go.html#line-570" class="ident">ExtKeyUsage</a>, <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r210" class="ident">keyUsages</label>))
	<a href="../../../pkg/builtin.html#name-copy" class="ident">copy</a>(<label for="r211" class="ident">usages</label>, <label for="r210" class="ident">keyUsages</label>)

	<span class="keyword">if</span> <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r209" class="ident">chain</label>) == <span class="lit-number">0</span> {
		<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
	}

	<label for="r212" class="ident">usagesRemaining</label> := <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r211" class="ident">usages</label>)
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> We walk down the list and cross out any usages that aren't supported</span><span class="comment">	 by each certificate. If we cross out all the usages, then the chain</span><span class="comment">	 is unacceptable.</span></div>
<div class="code"><pre><code>
<label for="r213" class="ident">NextCert</label>:
	<span class="keyword">for</span> <label for="r214" class="ident">i</label> := <a href="../../../pkg/builtin.html#name-len" class="ident">len</a>(<label for="r209" class="ident">chain</label>) - <span class="lit-number">1</span>; <label for="r214" class="ident">i</label> &gt;= <span class="lit-number">0</span>; <label for="r214" class="ident">i</label>-- {
		<label for="r215" class="ident">cert</label> := <label for="r209" class="ident">chain</label>[<label for="r214" class="ident">i</label>]
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> The certificate doesn't have any extended key usage specified.</span></div>
<div class="code"><pre><code>			<span class="keyword">continue</span>
		}

		<span class="keyword">for</span> <label for="r216" class="ident">_</label>, <label for="r217" class="ident">usage</label> := <span class="keyword">range</span> <label for="r215" class="ident">cert</label>.<a href="x509.go.html#line-671" class="ident">ExtKeyUsage</a> {
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> The certificate is explicitly good for any usage.</span></div>
<div class="code"><pre><code>				<span class="keyword">continue</span> <label for="r213" class="ident">NextCert</label>
			}
		}

		<span class="keyword">const</span> <label for="r218" class="ident">invalidUsage</label> <a href="x509.go.html#line-570" class="ident">ExtKeyUsage</a> = -<span class="lit-number">1</span>

	<label for="r219" class="ident">NextRequestedUsage</label>:
		<span class="keyword">for</span> <label for="r220" class="ident">i</label>, <label for="r221" class="ident">requestedUsage</label> := <span class="keyword">range</span> <label for="r211" class="ident">usages</label> {
			<span class="keyword">if</span> <label for="r221" class="ident">requestedUsage</label> == <label for="r218" class="ident">invalidUsage</label> {
				<span class="keyword">continue</span>
			}

			<span class="keyword">for</span> <label for="r222" class="ident">_</label>, <label for="r223" class="ident">usage</label> := <span class="keyword">range</span> <label for="r215" class="ident">cert</label>.<a href="x509.go.html#line-671" class="ident">ExtKeyUsage</a> {
				<span class="keyword">if</span> <label for="r221" class="ident">requestedUsage</label> == <label for="r223" class="ident">usage</label> {
					<span class="keyword">continue</span> <label for="r219" class="ident">NextRequestedUsage</label>
				} <span class="keyword">else</span> <span class="keyword">if</span> <label for="r221" class="ident">requestedUsage</label> == <a href="x509.go.html#line-574" class="ident">ExtKeyUsageServerAuth</a> &amp;&amp;
					(<label for="r223" class="ident">usage</label> == <a href="x509.go.html#line-584" class="ident">ExtKeyUsageNetscapeServerGatedCrypto</a> ||
</code></pre></div></div>
<div class="section">
<div class="doc">
<span class="comment"> In order to support COMODO</span><span class="comment">					 certificate chains, we have to</span><span class="comment">					 accept Netscape or Microsoft SGC</span><span class="comment">					 usages as equal to ServerAuth.</span></div>
<div class="code"><pre><code>					<span class="keyword">continue</span> <label for="r219" class="ident">NextRequestedUsage</label>
				}
			}

			<label for="r211" class="ident">usages</label>[<label for="r220" class="ident">i</label>] = <label for="r218" class="ident">invalidUsage</label>
			<label for="r212" class="ident">usagesRemaining</label>--
			<span class="keyword">if</span> <label for="r212" class="ident">usagesRemaining</label> == <span class="lit-number">0</span> {
				<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-false" class="ident">false</a>
			}
		}
	}

	<span class="keyword">return</span> <a href="../../../pkg/builtin.html#name-true" class="ident">true</a>
</code></pre></div></div>

</div><pre id="footer">
<table><tr><td><img src="../../../png/go101-twitter.png"></td>
<td>The pages are generated with <a href="https://go101.org/article/tool-golds.html"><b>Golds</b></a> <i>v0.3.2-preview</i>. (GOOS=darwin GOARCH=amd64)
<b>Golds</b> is a <a href="https://go101.org">Go 101</a> project developed by <a href="https://tapirgames.com">Tapir Liu</a>.
PR and bug reports are welcome and can be submitted to <a href="https://github.com/go101/golds">the issue list</a>.
Please follow <a href="https://twitter.com/go100and1">@Go100and1</a> (reachable from the left QR code) to get the latest news of <b>Golds</b>.</td></tr></table></pre>