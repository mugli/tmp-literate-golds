<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Package: github.com/jackc/pgconn/stmtcache</title>
<link href="../../../../css/light-v0.3.2-preview.css" rel="stylesheet">
<script src="../../../../jvs/golds-v0.3.2-preview.js"></script>
<body onload="onPageLoad()"><div>

<pre id="package-details"><code><span style="font-size:xx-large;">package <b>stmtcache</b></span>

<span class="title">Import Path</span>
	<a href="../../../../index.html#pkg-github.com/jackc/pgconn/stmtcache">github.com/jackc/pgconn/stmtcache</a><i> (on <a href="https://pkg.go.dev/github.com/jackc/pgconn/stmtcache" target="_blank">go.dev</a>)</i>

<span class="title">Dependency Relation</span>
	imports <a href="../../../../dep/github.com/jackc/pgconn/stmtcache.html">5 packages</a>, and imported by <a href="../../../../dep/github.com/jackc/pgconn/stmtcache.html#imported-by">one package</a>

<div id="files"><span class="title">Involved Source Files</span>

	<span class="nodocs">      <a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html">lru.go</a></span>
	<input type='checkbox' checked class="fold" id="file-1-fold-content"><label for="file-1-fold-content">   <a href="../../../../src/github.com/jackc/pgconn/stmtcache/stmtcache.go.html#doc">dâžœ</a> <a href="../../../../src/github.com/jackc/pgconn/stmtcache/stmtcache.go.html">stmtcache.go</a></label><span id='file-1-fold-content-items' class="fold-items">
		Package stmtcache is a cache that can be used to implement lazy prepared statements.</span></div>
<div id="exported-types"><span class="title">Package-Level Type Names<span class="title-stat"><i> (total 2, both are exported)</i></span></span>

<div id="exported-types-buttons" class="js-on">	/* sort exporteds by: <label id="sort-types-by-alphabet" class="button">alphabet</label> | <label id="sort-types-by-popularity" class="button">popularity</label> */</div><div class="anchor type-res" id="name-Cache" data-popularity="650">	<input type='checkbox' class="fold" id="Cache-fold-content"><label for="Cache-fold-content"> <a href="../../../../use/github.com/jackc/pgconn/stmtcache..Cache.html">type</a> <a href="../../../../src/github.com/jackc/pgconn/stmtcache/stmtcache.go.html#line-16">Cache</a> <b><i>(interface)</i></b></label><span id='Cache-fold-content-docs' class="fold-docs">
		Cache prepares and caches prepared statement descriptions.

		<input type='checkbox' class="fold" id="Cache-fold-methods"><label for="Cache-fold-methods">Methods (<i>total 6, all are exported</i>)</label><span id='Cache-fold-methods-items' class="fold-items"><span>
			<input type='checkbox' class="fold" id="Cache-fold-method-Cap"><label for="Cache-fold-method-Cap">( T) <a href="../../../../src/github.com/jackc/pgconn/stmtcache/stmtcache.go.html#line-33">Cap</a>() <a href="../../../builtin.html#name-int">int</a></label><span id='Cache-fold-method-Cap-docs' class="fold-docs">
				Cap returns the maximum number of cached prepared statement descriptions.
</span></span><span>
			<input type='checkbox' class="fold" id="Cache-fold-method-Clear"><label for="Cache-fold-method-Clear">( T) <a href="../../../../src/github.com/jackc/pgconn/stmtcache/stmtcache.go.html#line-21">Clear</a>(ctx <a href="../../../context.html">context</a>.<a href="../../../context.html#name-Context">Context</a>) <a href="../../../builtin.html#name-error">error</a></label><span id='Cache-fold-method-Clear-docs' class="fold-docs">
				Clear removes all entries in the cache. Any prepared statements will be deallocated from the PostgreSQL session.
</span></span><span>
			<input type='checkbox' class="fold" id="Cache-fold-method-Get"><label for="Cache-fold-method-Get">( T) <a href="../../../../src/github.com/jackc/pgconn/stmtcache/stmtcache.go.html#line-18">Get</a>(ctx <a href="../../../context.html">context</a>.<a href="../../../context.html#name-Context">Context</a>, sql <a href="../../../builtin.html#name-string">string</a>) (*<a href="../pgconn.html">pgconn</a>.<a href="../pgconn.html#name-StatementDescription">StatementDescription</a>, <a href="../../../builtin.html#name-error">error</a>)</label><span id='Cache-fold-method-Get-docs' class="fold-docs">
				Get returns the prepared statement description for sql preparing or describing the sql on the server as needed.
</span></span><span>
			<input type='checkbox' class="fold" id="Cache-fold-method-Len"><label for="Cache-fold-method-Len">( T) <a href="../../../../src/github.com/jackc/pgconn/stmtcache/stmtcache.go.html#line-30">Len</a>() <a href="../../../builtin.html#name-int">int</a></label><span id='Cache-fold-method-Len-docs' class="fold-docs">
				Len returns the number of cached prepared statement descriptions.
</span></span><span>
			<input type='checkbox' class="fold" id="Cache-fold-method-Mode"><label for="Cache-fold-method-Mode">( T) <a href="../../../../src/github.com/jackc/pgconn/stmtcache/stmtcache.go.html#line-36">Mode</a>() <a href="../../../builtin.html#name-int">int</a></label><span id='Cache-fold-method-Mode-docs' class="fold-docs">
				Mode returns the mode of the cache (ModePrepare or ModeDescribe)
</span></span><span>
			<input type='checkbox' class="fold" id="Cache-fold-method-StatementErrored"><label for="Cache-fold-method-StatementErrored">( T) <a href="../../../../src/github.com/jackc/pgconn/stmtcache/stmtcache.go.html#line-27">StatementErrored</a>(sql <a href="../../../builtin.html#name-string">string</a>, err <a href="../../../builtin.html#name-error">error</a>)</label><span id='Cache-fold-method-StatementErrored-docs' class="fold-docs">
				StatementErrored informs the cache that the given statement resulted in an error when it
				was last used against the database. In some cases, this will cause the cache to maer that
				statement as bad. The bad statement will instead be flushed during the next call to Get
				that occurs outside of a failed transaction.
</span></span></span>
		<input type='checkbox' class="fold" id="Cache-fold-impledby"><label for="Cache-fold-impledby">Implemented By (<i>at least one exported</i>)</label><span id='Cache-fold-impledby-items' class="fold-items"><span>
			*<a href="#name-LRU">LRU</a></span></span>
		<input type='checkbox' class="fold" id="Cache-fold-impls"><label for="Cache-fold-impls">Implements (<i>at least one unexported</i>)</label><span id='Cache-fold-impls-items' class="fold-items">
			<input type='checkbox' class="showhide" id="Cache-showhide-impls"><i><label for="Cache-showhide-impls" class="show-inline">/* at least one unexported ... */</label><label for="Cache-showhide-impls" class="hide-inline">/* at least one unexported: */</label></i><span class="hidden"><i>
			 T : github.com/aws/aws-sdk-go/aws/corehandlers.<a href="../../aws/aws-sdk-go/aws/corehandlers.html#name-lener">lener</a></i></span></span>
		<input type='checkbox' class="fold" id="Cache-fold-results"><label for="Cache-fold-results">As Outputs Of (<i>at least 2, both are exported</i>)</label><span id='Cache-fold-results-items' class="fold-items"><span>
			func <a href="#name-New">New</a>(conn *<a href="../pgconn.html">pgconn</a>.<a href="../pgconn.html#name-PgConn">PgConn</a>, mode <a href="../../../builtin.html#name-int">int</a>, cap <a href="../../../builtin.html#name-int">int</a>) <b>Cache</b></span><span>
			func github.com/jackc/pgx/v4.(*<a href="../pgx/v4.html#name-Conn">Conn</a>).<a href="../../../../src/github.com/jackc/pgx/v4/conn.go.html#line-397">StatementCache</a>() <b>Cache</b></span></span>

</span></div><div class="anchor type-res" id="name-LRU" data-popularity="625">	<input type='checkbox' class="fold" id="LRU-fold-content"><label for="LRU-fold-content"> <a href="../../../../use/github.com/jackc/pgconn/stmtcache..LRU.html">type</a> <a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-15">LRU</a> <i>(struct)</i></label><span id='LRU-fold-content-docs' class="fold-docs">
		LRU implements Cache with a Least Recently Used (LRU) cache.

		<input type='checkbox' class="fold" id="LRU-fold-fields"><label for="LRU-fold-fields">Fields (<i>total 8, none are exported</i>)</label><span id='LRU-fold-fields-items' class="fold-items">
			<input type='checkbox' class="showhide" id="LRU-showhide-fields"><i><label for="LRU-showhide-fields" class="show-inline">/* 8 unexporteds ... */</label><label for="LRU-showhide-fields" class="hide-inline">/* 8 unexporteds: */</label></i><span class="hidden"><i>
			<span class="nodocs"><a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-18">cap</a> <i><a href="../../../builtin.html#name-int">int</a></i></span></i></span><span class="hidden"><i>
			<span class="nodocs"><a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-16">conn</a> <i>*<a href="../pgconn.html">pgconn</a>.<a href="../pgconn.html#name-PgConn">PgConn</a></i></span></i></span><span class="hidden"><i>
			<span class="nodocs"><a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-21">l</a> <i>*<a href="../../../container/list.html">list</a>.<a href="../../../container/list.html#name-List">List</a></i></span></i></span><span class="hidden"><i>
			<span class="nodocs"><a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-20">m</a> <i>map[<a href="../../../builtin.html#name-string">string</a>]*<a href="../../../container/list.html">list</a>.<a href="../../../container/list.html#name-Element">Element</a></i></span></i></span><span class="hidden"><i>
			<span class="nodocs"><a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-17">mode</a> <i><a href="../../../builtin.html#name-int">int</a></i></span></i></span><span class="hidden"><i>
			<span class="nodocs"><a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-19">prepareCount</a> <i><a href="../../../builtin.html#name-int">int</a></i></span></i></span><span class="hidden"><i>
			<span class="nodocs"><a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-22">psNamePrefix</a> <i><a href="../../../builtin.html#name-string">string</a></i></span></i></span><span class="hidden"><i>
			<span class="nodocs"><a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-23">stmtsToClear</a> <i>[]<a href="../../../builtin.html#name-string">string</a></i></span></i></span></span>
		<input type='checkbox' class="fold" id="LRU-fold-methods"><label for="LRU-fold-methods">Methods (<i>total 9, in which 6 are exported</i>)</label><span id='LRU-fold-methods-items' class="fold-items"><span>
			<input type='checkbox' class="fold" id="LRU-fold-method-Cap"><label for="LRU-fold-method-Cap">(*T) <a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-129">Cap</a>() <a href="../../../builtin.html#name-int">int</a></label><span id='LRU-fold-method-Cap-docs' class="fold-docs">
				Cap returns the maximum number of cached prepared statement descriptions.
</span></span><span>
			<input type='checkbox' class="fold" id="LRU-fold-method-Clear"><label for="LRU-fold-method-Clear">(*T) <a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-80">Clear</a>(ctx <a href="../../../context.html">context</a>.<a href="../../../context.html#name-Context">Context</a>) <a href="../../../builtin.html#name-error">error</a></label><span id='LRU-fold-method-Clear-docs' class="fold-docs">
				Clear removes all entries in the cache. Any prepared statements will be deallocated from the PostgreSQL session.
</span></span><span>
			<input type='checkbox' class="fold" id="LRU-fold-method-Get"><label for="LRU-fold-method-Get">(*T) <a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-44">Get</a>(ctx <a href="../../../context.html">context</a>.<a href="../../../context.html#name-Context">Context</a>, sql <a href="../../../builtin.html#name-string">string</a>) (*<a href="../pgconn.html">pgconn</a>.<a href="../pgconn.html#name-StatementDescription">StatementDescription</a>, <a href="../../../builtin.html#name-error">error</a>)</label><span id='LRU-fold-method-Get-docs' class="fold-docs">
				Get returns the prepared statement description for sql preparing or describing the sql on the server as needed.
</span></span><span>
			<input type='checkbox' class="fold" id="LRU-fold-method-Len"><label for="LRU-fold-method-Len">(*T) <a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-124">Len</a>() <a href="../../../builtin.html#name-int">int</a></label><span id='LRU-fold-method-Len-docs' class="fold-docs">
				Len returns the number of cached prepared statement descriptions.
</span></span><span>
			<input type='checkbox' class="fold" id="LRU-fold-method-Mode"><label for="LRU-fold-method-Mode">(*T) <a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-134">Mode</a>() <a href="../../../builtin.html#name-int">int</a></label><span id='LRU-fold-method-Mode-docs' class="fold-docs">
				Mode returns the mode of the cache (ModePrepare or ModeDescribe)
</span></span><span>
			<span class="nodocs">(*T) <a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-91">StatementErrored</a>(sql <a href="../../../builtin.html#name-string">string</a>, err <a href="../../../builtin.html#name-error">error</a>)</span></span>
			<input type='checkbox' class="showhide" id="LRU-showhide-methods"><i><label for="LRU-showhide-methods" class="show-inline">/* 3 unexporteds ... */</label><label for="LRU-showhide-methods" class="hide-inline">/* 3 unexporteds: */</label></i><span class="hidden"><i>
			<span class="nodocs">(*T) <a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-105">clearStmt</a>(ctx <a href="../../../context.html">context</a>.<a href="../../../context.html#name-Context">Context</a>, sql <a href="../../../builtin.html#name-string">string</a>) <a href="../../../builtin.html#name-error">error</a></span></i></span><span class="hidden"><i>
			<span class="nodocs">(*T) <a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-138">prepare</a>(ctx <a href="../../../context.html">context</a>.<a href="../../../context.html#name-Context">Context</a>, sql <a href="../../../builtin.html#name-string">string</a>) (*<a href="../pgconn.html">pgconn</a>.<a href="../pgconn.html#name-StatementDescription">StatementDescription</a>, <a href="../../../builtin.html#name-error">error</a>)</span></i></span><span class="hidden"><i>
			<span class="nodocs">(*T) <a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-148">removeOldest</a>(ctx <a href="../../../context.html">context</a>.<a href="../../../context.html#name-Context">Context</a>) <a href="../../../builtin.html#name-error">error</a></span></i></span></span>
		<input type='checkbox' class="fold" id="LRU-fold-impls"><label for="LRU-fold-impls">Implements (<i>at least 2, in which 1 are exported</i>)</label><span id='LRU-fold-impls-items' class="fold-items"><span>
			*T : <a href="#name-Cache">Cache</a></span>
			<input type='checkbox' class="showhide" id="LRU-showhide-impls"><i><label for="LRU-showhide-impls" class="show-inline">/* at least one unexported ... */</label><label for="LRU-showhide-impls" class="hide-inline">/* at least one unexported: */</label></i><span class="hidden"><i>
			*T : github.com/aws/aws-sdk-go/aws/corehandlers.<a href="../../aws/aws-sdk-go/aws/corehandlers.html#name-lener">lener</a></i></span></span>
		<input type='checkbox' class="fold" id="LRU-fold-results"><label for="LRU-fold-results">As Outputs Of (<i>at least one exported</i>)</label><span id='LRU-fold-results-items' class="fold-items"><span>
			func <a href="#name-NewLRU">NewLRU</a>(conn *<a href="../pgconn.html">pgconn</a>.<a href="../pgconn.html#name-PgConn">PgConn</a>, mode <a href="../../../builtin.html#name-int">int</a>, cap <a href="../../../builtin.html#name-int">int</a>) *<b>LRU</b></span></span>

</span></div></div>
<div id="exported-functions"><span class="title">Package-Level Functions<span class="title-stat"><i> (total 4, in which 2 are exported)</i></span></span>

<div class="anchor value-res" id="name-New">	<input type='checkbox' class="fold" id="New-fold-content"><label for="New-fold-content"> <a href="../../../../use/github.com/jackc/pgconn/stmtcache..New.html">func</a> <a href="../../../../src/github.com/jackc/pgconn/stmtcache/stmtcache.go.html#line-41">New</a>(conn *<a href="../pgconn.html">pgconn</a>.<a href="../pgconn.html#name-PgConn">PgConn</a>, mode <a href="../../../builtin.html#name-int">int</a>, cap <a href="../../../builtin.html#name-int">int</a>) <a href="#name-Cache">Cache</a></label><span id='New-fold-content-docs' class="fold-docs">
		New returns the preferred cache implementation for mode and cap. mode is either ModePrepare or ModeDescribe. cap is
		the maximum size of the cache.

</span></div><div class="anchor value-res" id="name-NewLRU">	<input type='checkbox' class="fold" id="NewLRU-fold-content"><label for="NewLRU-fold-content"> <a href="../../../../use/github.com/jackc/pgconn/stmtcache..NewLRU.html">func</a> <a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-27">NewLRU</a>(conn *<a href="../pgconn.html">pgconn</a>.<a href="../pgconn.html#name-PgConn">PgConn</a>, mode <a href="../../../builtin.html#name-int">int</a>, cap <a href="../../../builtin.html#name-int">int</a>) *<a href="#name-LRU">LRU</a></label><span id='NewLRU-fold-content-docs' class="fold-docs">
		NewLRU creates a new LRU. mode is either ModePrepare or ModeDescribe. cap is the maximum size of the cache.

</span></div>	<input type='checkbox' class="showhide" id="unexported-functions-showhide"><i><label for="unexported-functions-showhide" class="show-inline">/* 2 unexporteds ... */</label><label for="unexported-functions-showhide" class="hide-inline">/* 2 unexporteds: */</label></i><div class="anchor value-res hidden" id="name-mustBeValidCap"><i>	<span class="nodocs"> <a href="../../../../use/github.com/jackc/pgconn/stmtcache..mustBeValidCap*dc699.html">func</a> <a href="../../../../src/github.com/jackc/pgconn/stmtcache/stmtcache.go.html#line-54">mustBeValidCap</a>(cap <a href="../../../builtin.html#name-int">int</a>)</span></i></div><div class="anchor value-res hidden" id="name-mustBeValidMode"><i>	<span class="nodocs"> <a href="../../../../use/github.com/jackc/pgconn/stmtcache..mustBeValidMode*4e9f3.html">func</a> <a href="../../../../src/github.com/jackc/pgconn/stmtcache/stmtcache.go.html#line-48">mustBeValidMode</a>(mode <a href="../../../builtin.html#name-int">int</a>)</span></i></div></div>
<div id="exported-variables"><span class="title">Package-Level Variables<span class="title-stat"><i> (only one, which is unexported)</i></span></span>

	<input type='checkbox' class="showhide" id="unexported-variables-showhide"><i><label for="unexported-variables-showhide" class="show-inline">/* one unexported ... */</label><label for="unexported-variables-showhide" class="hide-inline">/* one unexported: */</label></i><div class="anchor value-res hidden" id="name-lruCount"><i>	<span class="nodocs">  <a href="../../../../use/github.com/jackc/pgconn/stmtcache..lruCount*403c4.html">var</a> <a href="../../../../src/github.com/jackc/pgconn/stmtcache/lru.go.html#line-12">lruCount</a> <a href="../../../builtin.html#name-uint64">uint64</a></span></i></div></div>
<div id="exported-constants"><span class="title">Package-Level Constants<span class="title-stat"><i> (total 2, both are exported)</i></span></span>

<div class="anchor value-res" id="name-ModeDescribe">	<span class="nodocs"><a href="../../../../use/github.com/jackc/pgconn/stmtcache..ModeDescribe.html">const</a> <a href="../../../../src/github.com/jackc/pgconn/stmtcache/stmtcache.go.html#line-12">ModeDescribe</a> = 1 // Cache should prepare the anonymous prepared statement to only fetch the description of the statement.</span></div><div class="anchor value-res" id="name-ModePrepare">	<span class="nodocs"><a href="../../../../use/github.com/jackc/pgconn/stmtcache..ModePrepare.html">const</a> <a href="../../../../src/github.com/jackc/pgconn/stmtcache/stmtcache.go.html#line-11">ModePrepare</a> = 0 // Cache should prepare named statements.</span></div></div></code></pre><pre id="footer">
<table><tr><td><img src="../../../../png/go101-twitter.png"></td>
<td>The pages are generated with <a href="https://go101.org/article/tool-golds.html"><b>Golds</b></a> <i>v0.3.2-preview</i>. (GOOS=darwin GOARCH=amd64)
<b>Golds</b> is a <a href="https://go101.org">Go 101</a> project developed by <a href="https://tapirgames.com">Tapir Liu</a>.
PR and bug reports are welcome and can be submitted to <a href="https://github.com/go101/golds">the issue list</a>.
Please follow <a href="https://twitter.com/go100and1">@Go100and1</a> (reachable from the left QR code) to get the latest news of <b>Golds</b>.</td></tr></table></pre>